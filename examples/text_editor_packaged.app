{
  "app_metadata": {
    "id": "text_editor",
    "name": "Text Editor",
    "description": "A simple text editor for creating and editing text files in the virtual file system",
    "icon": "fas fa-edit",
    "keywords": [
      "text",
      "editor",
      "file",
      "edit",
      "write"
    ],
    "author": "Sypnex OS",
    "version": "1.0.0",
    "type": "user_app",
    "scripts": [
      "main.js"
    ],
    "settings": [
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save content every N seconds (0 = disabled)"
      },
      {
        "key": "FONT_SIZE",
        "name": "Font Size",
        "type": "number",
        "value": 14,
        "description": "Text editor font size in pixels"
      },
      {
        "key": "TAB_SIZE",
        "name": "Tab Size",
        "type": "number",
        "value": 4,
        "description": "Number of spaces for tab indentation"
      },
      {
        "key": "TERMINAL_ENABLED",
        "name": "Integrated Terminal",
        "type": "boolean",
        "value": false,
        "description": "Show integrated terminal by default"
      }
    ]
  },
  "files": {
    "text_editor.app": "ew0KICAgICJpZCI6ICJ0ZXh0X2VkaXRvciIsDQogICAgIm5hbWUiOiAiVGV4dCBFZGl0b3IiLA0KICAgICJkZXNjcmlwdGlvbiI6ICJBIHNpbXBsZSB0ZXh0IGVkaXRvciBmb3IgY3JlYXRpbmcgYW5kIGVkaXRpbmcgdGV4dCBmaWxlcyBpbiB0aGUgdmlydHVhbCBmaWxlIHN5c3RlbSIsDQogICAgImljb24iOiAiZmFzIGZhLWVkaXQiLA0KICAgICJrZXl3b3JkcyI6IFsidGV4dCIsICJlZGl0b3IiLCAiZmlsZSIsICJlZGl0IiwgIndyaXRlIl0sDQogICAgImF1dGhvciI6ICJTeXBuZXggT1MiLA0KICAgICJ2ZXJzaW9uIjogIjEuMC4wIiwNCiAgICAidHlwZSI6ICJ1c2VyX2FwcCIsDQogICAgInNjcmlwdHMiOiBbDQogICAgICAgICJtYWluLmpzIg0KICAgIF0sDQogICAgInNldHRpbmdzIjogWw0KICAgICAgICB7DQogICAgICAgICAgICAia2V5IjogIkFVVE9fU0FWRV9JTlRFUlZBTCIsDQogICAgICAgICAgICAibmFtZSI6ICJBdXRvIFNhdmUgSW50ZXJ2YWwgKHMpIiwNCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgICAidmFsdWUiOiAzMCwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBdXRvIHNhdmUgY29udGVudCBldmVyeSBOIHNlY29uZHMgKDAgPSBkaXNhYmxlZCkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJrZXkiOiAiRk9OVF9TSVpFIiwNCiAgICAgICAgICAgICJuYW1lIjogIkZvbnQgU2l6ZSIsDQogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICAgInZhbHVlIjogMTQsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVGV4dCBlZGl0b3IgZm9udCBzaXplIGluIHBpeGVscyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgImtleSI6ICJUQUJfU0laRSIsDQogICAgICAgICAgICAibmFtZSI6ICJUYWIgU2l6ZSIsDQogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICAgInZhbHVlIjogNCwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2Ygc3BhY2VzIGZvciB0YWIgaW5kZW50YXRpb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJrZXkiOiAiVEVSTUlOQUxfRU5BQkxFRCIsDQogICAgICAgICAgICAibmFtZSI6ICJJbnRlZ3JhdGVkIFRlcm1pbmFsIiwNCiAgICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iLA0KICAgICAgICAgICAgInZhbHVlIjogZmFsc2UsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiU2hvdyBpbnRlZ3JhdGVkIHRlcm1pbmFsIGJ5IGRlZmF1bHQiDQogICAgICAgIH0NCiAgICBdDQp9IA==",
    "text_editor.html": "PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciI+DQogICAgPGRpdiBjbGFzcz0iYXBwLWhlYWRlciI+DQogICAgICAgIDxoMj48aSBjbGFzcz0iZmFzIGZhLWVkaXQiPjwvaT4gVGV4dCBFZGl0b3IgLSA8c3BhbiBpZD0iY3VycmVudC1maWxlbmFtZSI+dW50aXRsZWQudHh0PC9zcGFuPjwvaDI+DQogICAgICAgIDxwPkNyZWF0ZSBhbmQgZWRpdCB0ZXh0IGZpbGVzIGluIHRoZSB2aXJ0dWFsIGZpbGUgc3lzdGVtPC9wPg0KICAgIDwvZGl2Pg0KDQogICAgPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtdG9vbGJhciI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJuZXctZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPiBOZXcNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJsb2FkLWZpbGUiIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNhdmUtZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2F2ZS1hcy1maWxlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZSBBcw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICANCg0KICAgICAgICAgICAgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ3b3JkLXdyYXAtdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRleHQtd2lkdGgiPjwvaT4gV29yZCBXcmFwDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ibGluZS1udW1iZXJzLXRvZ2dsZSIgY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1saXN0LW9sIj48L2k+IExpbmUgTnVtYmVycw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InN5bnRheC1oaWdobGlnaHRpbmctdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNvZGUiPjwvaT4gU3ludGF4IEhpZ2hsaWdodGluZw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InZhbGlkYXRpb24tdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNoZWNrLWNpcmNsZSI+PC9pPiBDb2RlIFZhbGlkYXRpb24NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ0ZXJtaW5hbC10b2dnbGUiIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtdGVybWluYWwiPjwvaT4gVGVybWluYWwNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8ZGl2IGNsYXNzPSJlZGl0b3ItY29udGFpbmVyIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImVkaXRvci13cmFwcGVyIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJsaW5lLW51bWJlcnMiIGNsYXNzPSJsaW5lLW51bWJlcnMiPjwvZGl2Pg0KICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0idGV4dC1lZGl0b3IiIGNsYXNzPSJhcHAtdGV4dGFyZWEiIHBsYWNlaG9sZGVyPSJTdGFydCB0eXBpbmcgeW91ciB0ZXh0IGhlcmUuLi4iPjwvdGV4dGFyZWE+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPCEtLSBJbnRlZ3JhdGVkIFRlcm1pbmFsIC0tPg0KICAgICAgICA8ZGl2IGlkPSJpbnRlZ3JhdGVkLXRlcm1pbmFsIiBjbGFzcz0iaW50ZWdyYXRlZC10ZXJtaW5hbCBoaWRkZW4iPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGVybWluYWwtaGVhZGVyIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idGVybWluYWwtdGl0bGUiPkludGVncmF0ZWQgVGVybWluYWw8L3NwYW4+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0idGVybWluYWwtcmVzaXplIiBjbGFzcz0idGVybWluYWwtcmVzaXplLWJ0biI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZ3JpcC1saW5lcyI+PC9pPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXJtaW5hbC1vdXRwdXQiIGlkPSJ0ZXJtaW5hbE91dHB1dCI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGVybWluYWwtbGluZSB0ZXJtaW5hbC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgSW50ZWdyYXRlZCBUZXJtaW5hbCAtIFR5cGUgY29tbWFuZHMgdG8gZXhlY3V0ZQ0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsLWxpbmUiPjwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXJtaW5hbC1pbnB1dC1jb250YWluZXIiPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsLWlucHV0LWxpbmUiPg0KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idGVybWluYWwtcHJvbXB0Ij4kPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9InRlcm1pbmFsLWlucHV0IiBpZD0idGVybWluYWxJbnB1dCIgcGxhY2Vob2xkZXI9IkVudGVyIGNvbW1hbmQuLi4iIGF1dG9jb21wbGV0ZT0ib2ZmIj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8ZGl2IGNsYXNzPSJlZGl0b3Itc3RhdHVzIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy1pdGVtIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdHVzLWxhYmVsIj5Nb2RpZmllZDo8L3NwYW4+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InN0YXR1cy12YWx1ZSIgaWQ9Im1vZGlmaWVkLXN0YXR1cyI+Tm88L3NwYW4+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy1pdGVtIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdHVzLWxhYmVsIj5FcnJvcnM6PC9zcGFuPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzdGF0dXMtdmFsdWUiIGlkPSJlcnJvci1jb3VudCI+MDwvc3Bhbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCjwvZGl2PiANCjxzdHlsZT4vKiA9PT09PSBTdHlsZTogc3R5bGUuY3NzID09PT09ICovDQovKiBUZXh0IEVkaXRvciBBcHAgU3R5bGVzICovDQoNCi8qIEFwcCBDb250YWluZXIgKi8NCi5hcHAtY29udGFpbmVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIG1pbi1oZWlnaHQ6IDA7DQp9DQoNCi5hcHAtY29udGVudCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGZsZXg6IDE7DQogICAgbWluLWhlaWdodDogMDsNCn0NCg0KLyogRWRpdG9yIENvbnRhaW5lciAqLw0KLmVkaXRvci1jb250YWluZXIgew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBtYXJnaW46IDE1cHggMDsNCiAgICBtaW4taGVpZ2h0OiAyMDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQp9DQoNCi5lZGl0b3Itd3JhcHBlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4OiAxOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBoZWlnaHQ6IDEwMCU7DQp9DQoNCi8qIExpbmUgTnVtYmVycyAqLw0KLmxpbmUtbnVtYmVycyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgcGFkZGluZzogMTBweCA4cHg7DQogICAgZm9udC1mYW1pbHk6ICdTRiBNb25vJywgTW9uYWNvLCAnQ2FzY2FkaWEgQ29kZScsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDE0cHg7IC8qIE1hdGNoIGVkaXRvciBmb250IHNpemUgKi8NCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC1hbGlnbjogcmlnaHQ7DQogICAgbWluLXdpZHRoOiA1MHB4Ow0KICAgIHVzZXItc2VsZWN0OiBub25lOw0KICAgIG92ZXJmbG93LXk6IGhpZGRlbjsNCiAgICBsaW5lLWhlaWdodDogMS42OyAvKiBNYXRjaCBlZGl0b3IgbGluZSBoZWlnaHQgKi8NCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLmxpbmUtbnVtYmVycy5oaWRkZW4gew0KICAgIGRpc3BsYXk6IG5vbmU7DQp9DQoNCi5saW5lLW51bWJlciB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgcGFkZGluZzogMCA0cHg7DQp9DQoNCi8qIFRleHQgRWRpdG9yICovDQojdGV4dC1lZGl0b3Igew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtZmFtaWx5OiAnU0YgTW9ubycsIE1vbmFjbywgJ0Nhc2NhZGlhIENvZGUnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjY7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIHJlc2l6ZTogbm9uZTsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KfQ0KDQojdGV4dC1lZGl0b3Iud29yZC13cmFwIHsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQojdGV4dC1lZGl0b3I6OnBsYWNlaG9sZGVyIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQp9DQoNCi8qIFN5bnRheCBIaWdobGlnaHRpbmcgRWRpdG9yICovDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KICAgIHBhZGRpbmc6IDEwcHggMTVweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvcjpmb2N1cyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQp9DQoNCi8qIFByaXNtLmpzIFRoZW1lIE92ZXJyaWRlcyBmb3IgYmV0dGVyIGludGVncmF0aW9uICovDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jb21tZW50LA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHJvbG9nLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZG9jdHlwZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNkYXRhIHsNCiAgICBjb2xvcjogIzZhNzM3ZDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHVuY3R1YXRpb24gew0KICAgIGNvbG9yOiAjZTFlNGU4Ow0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5wcm9wZXJ0eSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnRhZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmJvb2xlYW4sDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5udW1iZXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jb25zdGFudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnN5bWJvbCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmRlbGV0ZWQgew0KICAgIGNvbG9yOiAjNzliOGZmOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5zZWxlY3RvciwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0dHItbmFtZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnN0cmluZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNoYXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5idWlsdGluLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaW5zZXJ0ZWQgew0KICAgIGNvbG9yOiAjODVlODlkOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5vcGVyYXRvciwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmVudGl0eSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnVybCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLmxhbmd1YWdlLWNzcyAudG9rZW4uc3RyaW5nLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAuc3R5bGUgLnRva2VuLnN0cmluZyB7DQogICAgY29sb3I6ICNmOTc1ODM7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0cnVsZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0dHItdmFsdWUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5rZXl3b3JkIHsNCiAgICBjb2xvcjogI2Y5NzU4MzsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZnVuY3Rpb24sDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jbGFzcy1uYW1lIHsNCiAgICBjb2xvcjogI2IzOTJmMDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucmVnZXgsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pbXBvcnRhbnQsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi52YXJpYWJsZSB7DQogICAgY29sb3I6ICNmZmFiNzA7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmltcG9ydGFudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmJvbGQgew0KICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pdGFsaWMgew0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZW50aXR5IHsNCiAgICBjdXJzb3I6IGhlbHA7DQp9DQoNCi8qIEVkaXRvciBTdGF0dXMgQmFyICovDQouZWRpdG9yLXN0YXR1cyB7DQogICAgZGlzcGxheTogZmxleDsgLyogQ2hhbmdlZCBmcm9tIG5vbmUgdG8gZmxleCB0byBzaG93IHN0YXR1cyBiYXIgKi8NCiAgICBnYXA6IDIwcHg7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLnN0YXR1cy1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogNXB4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5zdGF0dXMtbGFiZWwgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQp9DQoNCi5zdGF0dXMtdmFsdWUgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi8qIEZpbGUgUGF0aCBEaXNwbGF5ICovDQouZmlsZS1wYXRoLWRpc3BsYXkgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgbWluLXdpZHRoOiAyMDBweDsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQp9DQoNCi8qIEludGVncmF0ZWQgVGVybWluYWwgU3R5bGVzICovDQouaW50ZWdyYXRlZC10ZXJtaW5hbCB7DQogICAgYmFja2dyb3VuZDogIzFlMWUxZTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweCA2cHggMCAwOyAvKiBSb3VuZGVkIHRvcCBjb3JuZXJzIG9ubHkgKi8NCiAgICBtYXJnaW46IDEwcHggMCAwIDA7IC8qIE5vIGJvdHRvbSBtYXJnaW4gdG8gc2l0IGZsdXNoICovDQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG1pbi1oZWlnaHQ6IDIwMHB4Ow0KICAgIG1heC1oZWlnaHQ6IDQwMHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5pbnRlZ3JhdGVkLXRlcm1pbmFsLmhpZGRlbiB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLnRlcm1pbmFsLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBiYWNrZ3JvdW5kOiAjMmQyZDJkOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjNDQ0Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogI2ZmZmZmZjsNCn0NCg0KLnRlcm1pbmFsLXRpdGxlIHsNCiAgICBmb250LXdlaWdodDogNTAwOw0KfQ0KDQoudGVybWluYWwtcmVzaXplLWJ0biB7DQogICAgYmFja2dyb3VuZDogbm9uZTsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6ICM4ODg7DQogICAgY3Vyc29yOiBucy1yZXNpemU7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCn0NCg0KLnRlcm1pbmFsLXJlc2l6ZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICM0NDQ7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi50ZXJtaW5hbC1vdXRwdXQgew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZC1jb2xvcjogIzFlMWUxZTsNCiAgICBjb2xvcjogI2ZmZmZmZjsNCiAgICBmb250LWZhbWlseTogJ0NvdXJpZXIgTmV3JywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWluLWhlaWdodDogMTAwcHg7DQogICAgbWF4LWhlaWdodDogMjAwcHg7DQp9DQoNCi50ZXJtaW5hbC1saW5lIHsNCiAgICBtYXJnaW46IDFweCAwOw0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgdXNlci1zZWxlY3Q6IHRleHQ7DQogICAgLXdlYmtpdC11c2VyLXNlbGVjdDogdGV4dDsNCiAgICAtbW96LXVzZXItc2VsZWN0OiB0ZXh0Ow0KICAgIC1tcy11c2VyLXNlbGVjdDogdGV4dDsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQoudGVybWluYWwtZXJyb3Igew0KICAgIGNvbG9yOiAjZmY2YjZiOw0KfQ0KDQoudGVybWluYWwtc3VjY2VzcyB7DQogICAgY29sb3I6ICM1MWNmNjY7DQp9DQoNCi50ZXJtaW5hbC1pbmZvIHsNCiAgICBjb2xvcjogIzc0YzBmYzsNCn0NCg0KLnRlcm1pbmFsLWlucHV0LWNvbnRhaW5lciB7DQogICAgYmFja2dyb3VuZDogIzFlMWUxZTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgIzQ0NDsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCn0NCg0KLnRlcm1pbmFsLWlucHV0LWxpbmUgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6ICNmZmZmZmY7DQogICAgZm9udC1mYW1pbHk6ICdDb3VyaWVyIE5ldycsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLnRlcm1pbmFsLXByb21wdCB7DQogICAgY29sb3I6ICMwMGZmMDA7DQogICAgbWFyZ2luLXJpZ2h0OiA4cHg7DQogICAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQoNCi50ZXJtaW5hbC1pbnB1dCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgZmxleDogMTsNCn0NCg0KLnRlcm1pbmFsLWlucHV0OjpwbGFjZWhvbGRlciB7DQogICAgY29sb3I6ICM2NjY7DQp9DQoNCi8qIFRlcm1pbmFsIHNlbGVjdGlvbiBzdHlsaW5nICovDQoudGVybWluYWwtb3V0cHV0OjpzZWxlY3Rpb24gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDY2Y2M7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi50ZXJtaW5hbC1vdXRwdXQ6Oi1tb3otc2VsZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA2NmNjOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KfQ0KDQoudGVybWluYWwtbGluZTo6c2VsZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA2NmNjOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KfQ0KDQoudGVybWluYWwtbGluZTo6LW1vei1zZWxlY3Rpb24gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDY2Y2M7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLXRvb2xiYXIgew0KICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgfQ0KICAgIA0KICAgIC5hcHAtYnRuLWdyb3VwIHsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgfQ0KICAgIA0KICAgIC5lZGl0b3Itc3RhdHVzIHsNCiAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgfQ0KICAgIA0KICAgIC5saW5lLW51bWJlcnMgew0KICAgICAgICBtaW4td2lkdGg6IDQwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTNweDsgLyogTWF0Y2ggZWRpdG9yIGZvbnQgc2l6ZSAqLw0KICAgIH0NCiAgICANCiAgICAjdGV4dC1lZGl0b3IsDQogICAgLmhpZ2hsaWdodGVkLWVkaXRvciB7DQogICAgICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICB9DQogICAgDQogICAgLmludGVncmF0ZWQtdGVybWluYWwgew0KICAgICAgICBtaW4taGVpZ2h0OiAxNTBweDsNCiAgICAgICAgbWF4LWhlaWdodDogMzAwcHg7DQogICAgfQ0KICAgIA0KICAgIC50ZXJtaW5hbC1vdXRwdXQgew0KICAgICAgICBmb250LXNpemU6IDExcHg7DQogICAgICAgIG1pbi1oZWlnaHQ6IDgwcHg7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4Ow0KICAgIH0NCiAgICANCiAgICAudGVybWluYWwtaW5wdXQgew0KICAgICAgICBmb250LXNpemU6IDExcHg7DQogICAgfQ0KfQ0KDQovKiBGb2N1cyBTdGF0ZXMgKi8NCiN0ZXh0LWVkaXRvcjpmb2N1cyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQp9DQoNCi8qIFNjcm9sbGJhciBTdHlsaW5nICovDQojdGV4dC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLA0KLmxpbmUtbnVtYmVyczo6LXdlYmtpdC1zY3JvbGxiYXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhciB7DQogICAgd2lkdGg6IDhweDsNCiAgICBoZWlnaHQ6IDhweDsNCn0NCg0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10cmFjaywNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCn0NCg0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiwNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQojdGV4dC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyLA0KLmxpbmUtbnVtYmVyczo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCn0NCg0KLyogQXBwIFRvb2xiYXIgKi8NCi5hcHAtdG9vbGJhciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLmFwcC1idG4tZ3JvdXAgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZ2FwOiAxMHB4Ow0KfQ0KDQovKiBBbmltYXRpb24gZm9yIHN0YXR1cyBjaGFuZ2VzICovDQouc3RhdHVzLXZhbHVlIHsNCiAgICB0cmFuc2l0aW9uOiBjb2xvciAwLjJzIGVhc2U7DQp9DQoNCi8qIE1vZGlmaWVkIHN0YXR1cyBpbmRpY2F0b3IgKi8NCi5zdGF0dXMtdmFsdWUubW9kaWZpZWQgew0KICAgIGNvbG9yOiAjZmY5ODAwOw0KICAgIGFuaW1hdGlvbjogcHVsc2UgMnMgaW5maW5pdGU7DQp9DQoNCkBrZXlmcmFtZXMgcHVsc2Ugew0KICAgIDAlIHsgb3BhY2l0eTogMTsgfQ0KICAgIDUwJSB7IG9wYWNpdHk6IDAuNzsgfQ0KICAgIDEwMCUgeyBvcGFjaXR5OiAxOyB9DQp9DQoNCi8qIENvZGUgVmFsaWRhdGlvbiBFcnJvciBTdHlsZXMgKi8NCi5saW5lLWVycm9yIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMTA3LCAxMDcsIDAuMikgIWltcG9ydGFudDsNCiAgICBjb2xvcjogI2ZmNmI2YiAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgI2ZmNmI2YiAhaW1wb3J0YW50Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLmxpbmUtZXJyb3I6OmJlZm9yZSB7DQogICAgY29udGVudDogIuKaoCI7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGxlZnQ6IDJweDsNCiAgICB0b3A6IDUwJTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7DQogICAgY29sb3I6ICNmZjZiNmI7DQogICAgZm9udC1zaXplOiAxMHB4Ow0KICAgIHotaW5kZXg6IDE7DQp9DQoNCi8qIEVycm9yIGNvdW50IGluIHN0YXR1cyBiYXIgKi8NCi5zdGF0dXMtdmFsdWUgew0KICAgIHRyYW5zaXRpb246IGNvbG9yIDAuM3MgZWFzZTsNCn0NCg0KLyogQWN0aXZlIHZhbGlkYXRpb24gdG9nZ2xlIGJ1dHRvbiAqLw0KLmFwcC1idG4uYWN0aXZlIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtcHJpbWFyeSk7DQogICAgY29sb3I6IHdoaXRlOw0KfSA8L3N0eWxlPg0KPHNjcmlwdD4vLyA9PT09PSBTY3JpcHQ6IG1haW4uanMgPT09PT0NCg0KDQovLyBUZXh0IEVkaXRvciBBcHANCmNvbnNvbGUubG9nKCdUZXh0IEVkaXRvciBhcHAgbG9hZGluZy4uLicpOw0KY29uc29sZS5sb2coJ0RvY3VtZW50IHJlYWR5IHN0YXRlOicsIGRvY3VtZW50LnJlYWR5U3RhdGUpOw0KY29uc29sZS5sb2coJ0RvY3VtZW50IGJvZHk6JywgZG9jdW1lbnQuYm9keSk7DQpjb25zb2xlLmxvZygnV2luZG93IHN5cG5leEFQSTonLCB0eXBlb2Ygd2luZG93LnN5cG5leEFQSSk7DQoNCi8vIEdsb2JhbCB2YXJpYWJsZXMNCmxldCB0ZXh0RWRpdG9yID0gew0KICAgIHRleHRhcmVhOiBudWxsLA0KICAgIGxpbmVOdW1iZXJzOiBudWxsLA0KICAgIGZpbGVQYXRoOiBudWxsLA0KICAgIG9yaWdpbmFsQ29udGVudDogJycsDQogICAgaXNNb2RpZmllZDogZmFsc2UsDQogICAgYXV0b1NhdmVJbnRlcnZhbDogbnVsbCwNCiAgICB3b3JkV3JhcEVuYWJsZWQ6IGZhbHNlLA0KICAgIGxpbmVOdW1iZXJzRW5hYmxlZDogdHJ1ZSwNCiAgICBzZXR0aW5nczoge30sDQogICAgLy8gU3ludGF4IGhpZ2hsaWdodGluZw0KICAgIHByaXNtTG9hZGVkOiBmYWxzZSwNCiAgICBzeW50YXhIaWdobGlnaHRpbmdFbmFibGVkOiBmYWxzZSwNCiAgICBoaWdobGlnaHRlZEVkaXRvcjogbnVsbCwNCiAgICBoaWdobGlnaHRDb250YWluZXI6IG51bGwsDQogICAgb3JpZ2luYWxUZXh0YXJlYVN0eWxlczogbnVsbCwNCiAgICBkZWJvdW5jZVRpbWVyOiBudWxsLA0KICAgIC8vIEN1cnNvciBwb3NpdGlvbiB0cmFja2luZw0KICAgIGN1cnNvclBvc2l0aW9uOiAwLA0KICAgIC8vIENvZGUgdmFsaWRhdGlvbg0KICAgIHB5b2RpZGVMb2FkZWQ6IGZhbHNlLA0KICAgIHZhbGlkYXRpb25FbmFibGVkOiB0cnVlLA0KICAgIHZhbGlkYXRpb25EZWJvdW5jZVRpbWVyOiBudWxsLA0KICAgIGN1cnJlbnRFcnJvcnM6IFtdLA0KICAgIGVycm9yTWFya2VyczogW10NCn07DQoNCi8vIERPTSBlbGVtZW50cw0KbGV0IG5ld0ZpbGVCdG4sIGxvYWRGaWxlQnRuLCBzYXZlRmlsZUJ0biwgc2F2ZUFzRmlsZUJ0bjsNCmxldCBjdXJyZW50RmlsZW5hbWVFbCwgd29yZFdyYXBUb2dnbGUsIGxpbmVOdW1iZXJzVG9nZ2xlLCBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUsIHZhbGlkYXRpb25Ub2dnbGU7DQpsZXQgbW9kaWZpZWRTdGF0dXNFbCwgZXJyb3JDb3VudEVsOw0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQpmdW5jdGlvbiBpbml0VGV4dEVkaXRvcigpIHsNCiAgICBjb25zb2xlLmxvZygnVGV4dCBFZGl0b3IgaW5pdGlhbGl6aW5nLi4uJyk7DQogICAgDQogICAgLy8gQ2hlY2sgaWYgU3lwbmV4QVBJIGlzIGF2YWlsYWJsZQ0KICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJID09PSAndW5kZWZpbmVkJyB8fCAhc3lwbmV4QVBJKSB7DQogICAgICAgIGNvbnNvbGUud2FybignU3lwbmV4QVBJIG5vdCBhdmFpbGFibGUgLSBydW5uaW5nIGluIHN0YW5kYWxvbmUgbW9kZScpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgY29uc29sZS5sb2coJ1N5cG5leEFQSSBhdmFpbGFibGU6Jywgc3lwbmV4QVBJKTsNCiAgICBjb25zb2xlLmxvZygnQXBwIElEOicsIHN5cG5leEFQSS5nZXRBcHBJZCgpKTsNCiAgICANCiAgICAvLyBUZXN0IGlmIGFwcCBjb250YWluZXIgZXhpc3RzDQogICAgY29uc3QgYXBwQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcC1jb250YWluZXInKTsNCiAgICBjb25zb2xlLmxvZygnQXBwIGNvbnRhaW5lciBmb3VuZDonLCAhIWFwcENvbnRhaW5lcik7DQogICAgaWYgKGFwcENvbnRhaW5lcikgew0KICAgICAgICBjb25zb2xlLmxvZygnQXBwIGNvbnRhaW5lciBjb250ZW50OicsIGFwcENvbnRhaW5lci5pbm5lckhUTUwuc3Vic3RyaW5nKDAsIDIwMCkgKyAnLi4uJyk7DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBET00gZWxlbWVudHMNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RleHQtZWRpdG9yJyk7DQogICAgdGV4dEVkaXRvci5saW5lTnVtYmVycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLW51bWJlcnMnKTsNCiAgICANCiAgICBuZXdGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ldy1maWxlJyk7DQogICAgbG9hZEZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZC1maWxlJyk7DQogICAgc2F2ZUZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZS1maWxlJyk7DQogICAgc2F2ZUFzRmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlLWFzLWZpbGUnKTsNCiAgICBjdXJyZW50RmlsZW5hbWVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50LWZpbGVuYW1lJyk7DQogICAgd29yZFdyYXBUb2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd29yZC13cmFwLXRvZ2dsZScpOw0KICAgIGxpbmVOdW1iZXJzVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmUtbnVtYmVycy10b2dnbGUnKTsNCiAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3ludGF4LWhpZ2hsaWdodGluZy10b2dnbGUnKTsNCiAgICB2YWxpZGF0aW9uVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZhbGlkYXRpb24tdG9nZ2xlJyk7DQogICAgDQogICAgbW9kaWZpZWRTdGF0dXNFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RpZmllZC1zdGF0dXMnKTsNCiAgICBlcnJvckNvdW50RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3ItY291bnQnKTsNCiAgICANCiAgICAvLyBDcml0aWNhbCBlbGVtZW50IGNoZWNrcw0KICAgIGlmICghdGV4dEVkaXRvci50ZXh0YXJlYSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdUZXh0IGVkaXRvciB0ZXh0YXJlYSBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBpZiAoIXRleHRFZGl0b3IubGluZU51bWJlcnMpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTGluZSBudW1iZXJzIGVsZW1lbnQgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc29sZS5sb2coJ0RPTSBlbGVtZW50cyBmb3VuZDonLCB7DQogICAgICAgIHRleHRhcmVhOiAhIXRleHRFZGl0b3IudGV4dGFyZWEsDQogICAgICAgIGxpbmVOdW1iZXJzOiAhIXRleHRFZGl0b3IubGluZU51bWJlcnMsDQogICAgICAgIG5ld0ZpbGVCdG46ICEhbmV3RmlsZUJ0biwNCiAgICAgICAgbG9hZEZpbGVCdG46ICEhbG9hZEZpbGVCdG4sDQogICAgICAgIHNhdmVGaWxlQnRuOiAhIXNhdmVGaWxlQnRuLA0KICAgICAgICBzYXZlQXNGaWxlQnRuOiAhIXNhdmVBc0ZpbGVCdG4sDQogICAgICAgIGN1cnJlbnRGaWxlbmFtZUVsOiAhIWN1cnJlbnRGaWxlbmFtZUVsLA0KICAgICAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGU6ICEhc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlLA0KICAgICAgICBtb2RpZmllZFN0YXR1c0VsOiAhIW1vZGlmaWVkU3RhdHVzRWwNCiAgICB9KTsNCiAgICANCiAgICAvLyBMb2FkIHNldHRpbmdzDQogICAgbG9hZFNldHRpbmdzKCk7DQogICAgDQogICAgLy8gTG9hZCB0ZXJtaW5hbCBzdGF0ZQ0KICAgIGxvYWRUZXJtaW5hbFN0YXRlKCk7DQogICAgDQogICAgLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQogICAgc2V0dXBFdmVudEhhbmRsZXJzKCk7DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBlZGl0b3Igc3RhdGUNCiAgICBpbml0aWFsaXplRWRpdG9yKCk7DQogICAgDQogICAgLy8gU2V0IGluaXRpYWwgYnV0dG9uIHN0YXRlcw0KICAgIGlmIChzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUpIHsNCiAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB9DQogICAgaWYgKHZhbGlkYXRpb25Ub2dnbGUpIHsNCiAgICAgICAgdmFsaWRhdGlvblRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKTsNCiAgICB9DQogICAgDQogICAgLy8gVGV4dCBFZGl0b3IgbG9hZGVkIHN1Y2Nlc3NmdWxseSAobm8gbm90aWZpY2F0aW9uIG5lZWRlZCkNCiAgICANCiAgICBjb25zb2xlLmxvZygnVGV4dCBFZGl0b3IgaW5pdGlhbGl6YXRpb24gY29tcGxldGUnKTsNCn0NCg0KLy8gTG9hZCBhcHAgc2V0dGluZ3MNCmFzeW5jIGZ1bmN0aW9uIGxvYWRTZXR0aW5ncygpIHsNCiAgICB0cnkgew0KICAgICAgICB0ZXh0RWRpdG9yLnNldHRpbmdzID0gew0KICAgICAgICAgICAgYXV0b1NhdmVJbnRlcnZhbDogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ0FVVE9fU0FWRV9JTlRFUlZBTCcsIDMwKSwNCiAgICAgICAgICAgIGZvbnRTaXplOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnRk9OVF9TSVpFJywgMTQpLA0KICAgICAgICAgICAgdGFiU2l6ZTogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ1RBQl9TSVpFJywgNCksDQogICAgICAgICAgICBzeW50YXhIaWdobGlnaHRpbmc6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdTWU5UQVhfSElHSExJR0hUSU5HJywgdHJ1ZSksDQogICAgICAgICAgICBjb2RlVmFsaWRhdGlvbjogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ0NPREVfVkFMSURBVElPTicsIHRydWUpDQogICAgICAgIH07DQogICAgICAgIA0KICAgIC8vIEFwcGx5IHNldHRpbmdzDQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zdHlsZS5mb250U2l6ZSA9IHRleHRFZGl0b3Iuc2V0dGluZ3MuZm9udFNpemUgKyAncHgnOw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc3R5bGUudGFiU2l6ZSA9IHRleHRFZGl0b3Iuc2V0dGluZ3MudGFiU2l6ZTsNCiAgICB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkID0gdGV4dEVkaXRvci5zZXR0aW5ncy5jb2RlVmFsaWRhdGlvbjsNCiAgICANCiAgICAvLyBEaXNhYmxlIGJyb3dzZXIgc3BlbGwgY2hlY2tpbmcgYW5kIGF1dG8tZmVhdHVyZXMgZm9yIGNvZGUgZWRpdGluZw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc2V0QXR0cmlidXRlKCdzcGVsbGNoZWNrJywgJ2ZhbHNlJyk7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsICdvZmYnKTsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnLCAnb2ZmJyk7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ2F1dG9jYXBpdGFsaXplJywgJ29mZicpOyAgICAgICAgY29uc29sZS5sb2coJ1NldHRpbmdzIGxvYWRlZDonLCB0ZXh0RWRpdG9yLnNldHRpbmdzKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBzZXR0aW5nczonLCBlcnJvcik7DQogICAgICAgIC8vIFVzZSBkZWZhdWx0cw0KICAgICAgICB0ZXh0RWRpdG9yLnNldHRpbmdzID0gew0KICAgICAgICAgICAgYXV0b1NhdmVJbnRlcnZhbDogMzAsDQogICAgICAgICAgICBmb250U2l6ZTogMTQsDQogICAgICAgICAgICB0YWJTaXplOiA0LA0KICAgICAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nOiB0cnVlLA0KICAgICAgICAgICAgY29kZVZhbGlkYXRpb246IHRydWUNCiAgICAgICAgfTsNCiAgICAgICAgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCA9IHRydWU7DQogICAgfQ0KfQ0KDQovLyBMb2FkIHRlcm1pbmFsIHN0YXRlDQphc3luYyBmdW5jdGlvbiBsb2FkVGVybWluYWxTdGF0ZSgpIHsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCB0ZXJtaW5hbEVuYWJsZWQgPSBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnVEVSTUlOQUxfRU5BQkxFRCcsIGZhbHNlKTsNCiAgICAgICAgaWYgKHRlcm1pbmFsRW5hYmxlZCAmJiBpbnRlZ3JhdGVkVGVybWluYWwpIHsNCiAgICAgICAgICAgIGludGVncmF0ZWRUZXJtaW5hbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsNCiAgICAgICAgICAgIGlmICh0ZXJtaW5hbFRvZ2dsZSkgew0KICAgICAgICAgICAgICAgIHRlcm1pbmFsVG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgdGVybWluYWwgc3RhdGU6JywgZXJyb3IpOw0KICAgIH0NCn0NCg0KLy8gQ2hlY2sgaWYgZmlsZSBpcyBzdXBwb3J0ZWQgZm9yIHN5bnRheCBoaWdobGlnaHRpbmcNCmZ1bmN0aW9uIGdldEZpbGVMYW5ndWFnZShmaWxlUGF0aCkgew0KICAgIGlmICghZmlsZVBhdGgpIHJldHVybiBudWxsOw0KICAgIA0KICAgIGNvbnN0IGV4dGVuc2lvbiA9IGZpbGVQYXRoLnRvTG93ZXJDYXNlKCkuc3Vic3RyaW5nKGZpbGVQYXRoLmxhc3RJbmRleE9mKCcuJykpOw0KICAgIA0KICAgIGNvbnN0IGxhbmd1YWdlTWFwID0gew0KICAgICAgICAnLnB5JzogJ3B5dGhvbicsDQogICAgICAgICcucHl3JzogJ3B5dGhvbicsIA0KICAgICAgICAnLnB5eCc6ICdweXRob24nLA0KICAgICAgICAnLnB5aSc6ICdweXRob24nLA0KICAgICAgICAnLnB5ZCc6ICdweXRob24nLA0KICAgICAgICAnLmpzJzogJ2phdmFzY3JpcHQnLA0KICAgICAgICAnLmpzb24nOiAnanNvbicsDQogICAgICAgICcuaHRtbCc6ICdodG1sJywNCiAgICAgICAgJy5odG0nOiAnaHRtbCcsDQogICAgICAgICcuY3NzJzogJ2NzcycNCiAgICB9Ow0KICAgIA0KICAgIHJldHVybiBsYW5ndWFnZU1hcFtleHRlbnNpb25dIHx8IG51bGw7DQp9DQoNCi8vIENoZWNrIGlmIGZpbGUgaXMgUHl0aG9uIChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSkNCmZ1bmN0aW9uIGlzUHl0aG9uRmlsZShmaWxlUGF0aCkgew0KICAgIHJldHVybiBnZXRGaWxlTGFuZ3VhZ2UoZmlsZVBhdGgpID09PSAncHl0aG9uJzsNCn0NCg0KLy8gTG9hZCBQcmlzbS5qcyBmb3Igc3ludGF4IGhpZ2hsaWdodGluZw0KYXN5bmMgZnVuY3Rpb24gbG9hZFByaXNtSlMoKSB7DQogICAgaWYgKHRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHJldHVybjsNCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zb2xlLmxvZygnTG9hZGluZyBQcmlzbS5qcyBmb3Igc3ludGF4IGhpZ2hsaWdodGluZy4uLicpOw0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBQcmlzbS5qcyBsaWJyYXJ5DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL3ByaXNtLm1pbi5qcycsIHsNCiAgICAgICAgICAgIGxvY2FsTmFtZTogJ1ByaXNtJw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgbGFuZ3VhZ2UgY29tcG9uZW50cw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLXB5dGhvbi5taW4uanMnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1qYXZhc2NyaXB0Lm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWpzb24ubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tbWFya3VwLm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWNzcy5taW4uanMnKTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgUHJpc20gQ1NTDQogICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7DQogICAgICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnOw0KICAgICAgICBsaW5rLmhyZWYgPSAnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL3RoZW1lcy9wcmlzbS10b21vcnJvdy5taW4uY3NzJzsNCiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rKTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBjdXN0b20gQ1NTIHRvIGZpeCBzdHlsaW5nIGlzc3Vlcw0KICAgICAgICBjb25zdCBjdXN0b21TdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7DQogICAgICAgIGN1c3RvbVN0eWxlLnRleHRDb250ZW50ID0gYA0KICAgICAgICAgICAgLmhpZ2hsaWdodGVkLWJhY2tkcm9wICogew0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbi1saW5lOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLXN0eWxlOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLWNvbG9yOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB0ZXh0LXVuZGVybGluZS1vZmZzZXQ6IDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC5oaWdobGlnaHRlZC1iYWNrZHJvcCAudG9rZW4uc3RyaW5nIHsNCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgYDsNCiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjdXN0b21TdHlsZSk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnByaXNtTG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgY29uc29sZS5sb2coJ+KchSBQcmlzbS5qcyB3aXRoIGFsbCBsYW5ndWFnZSBncmFtbWFycyBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIFByaXNtLmpzOicsIGVycm9yKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBsb2FkIHN5bnRheCBoaWdobGlnaHRpbmcnLCAnZXJyb3InKTsNCiAgICB9DQp9DQoNCi8vIExvYWQgUHlvZGlkZSBmb3IgUHl0aG9uIHN5bnRheCB2YWxpZGF0aW9uDQphc3luYyBmdW5jdGlvbiBsb2FkUHlvZGlkZSgpIHsNCiAgICBjb25zb2xlLmxvZygn8J+TpiBsb2FkUHlvZGlkZSBjYWxsZWQsIGN1cnJlbnQgc3RhdGU6JywgdGV4dEVkaXRvci5weW9kaWRlTG9hZGVkKTsNCiAgICANCiAgICBpZiAodGV4dEVkaXRvci5weW9kaWRlTG9hZGVkICYmIHdpbmRvdy5weW9kaWRlKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCfinIUgUHlvZGlkZSBhbHJlYWR5IGxvYWRlZCwgcmV0dXJuaW5nIGV4aXN0aW5nIGluc3RhbmNlJyk7DQogICAgICAgIHJldHVybiB3aW5kb3cucHlvZGlkZTsNCiAgICB9DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgY29uc29sZS5sb2coJ/CfmoAgU3RhcnRpbmcgUHlvZGlkZSBsb2FkaW5nIHByb2Nlc3MuLi4nKTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgUHlvZGlkZSBzY3JpcHQNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvcHlvZGlkZS92MC4yNC4xL2Z1bGwvcHlvZGlkZS5qcycsIHsNCiAgICAgICAgICAgIGxvY2FsTmFtZTogJ2xvYWRQeW9kaWRlJw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGNvbnNvbGUubG9nKCfwn5OaIFB5b2RpZGUgbGlicmFyeSBsb2FkZWQsIGluaXRpYWxpemluZyBpbnN0YW5jZS4uLicpOw0KICAgICAgICANCiAgICAgICAgLy8gSW5pdGlhbGl6ZSBQeW9kaWRlIC0gdXNlIHRoZSBnbG9iYWwgbG9hZFB5b2RpZGUgZnVuY3Rpb24NCiAgICAgICAgd2luZG93LnB5b2RpZGUgPSBhd2FpdCB3aW5kb3cubG9hZFB5b2RpZGUoew0KICAgICAgICAgICAgaW5kZXhVUkw6ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvcHlvZGlkZS92MC4yNC4xL2Z1bGwvIg0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGNvbnNvbGUubG9nKCfwn5CNIFB5b2RpZGUgaW5pdGlhbGl6ZWQsIGluc3RhbGxpbmcgUHl0aG9uIHZhbGlkYXRpb24gZnVuY3Rpb24uLi4nKTsNCiAgICAgICAgDQogICAgICAgIC8vIEluc3RhbGwgdmFsaWRhdGlvbiBmdW5jdGlvbg0KICAgICAgICB3aW5kb3cucHlvZGlkZS5ydW5QeXRob24oYA0KaW1wb3J0IGFzdA0KDQpkZWYgdmFsaWRhdGVfcHl0aG9uX3N5bnRheChjb2RlKToNCiAgICAiIiJWYWxpZGF0ZSBQeXRob24gc3ludGF4IGFuZCByZXR1cm4gZXJyb3JzIiIiDQogICAgdHJ5Og0KICAgICAgICAjIFRyeSB0byBwYXJzZSB0aGUgY29kZSBhcyBhbiBBU1QNCiAgICAgICAgYXN0LnBhcnNlKGNvZGUpDQogICAgICAgIHJldHVybiB7InZhbGlkIjogVHJ1ZSwgImVycm9ycyI6IFtdfQ0KICAgIGV4Y2VwdCBTeW50YXhFcnJvciBhcyBlOg0KICAgICAgICBlcnJvcl9pbmZvID0gew0KICAgICAgICAgICAgImxpbmUiOiBlLmxpbmVubyBvciAxLA0KICAgICAgICAgICAgImNvbHVtbiI6IGUub2Zmc2V0IG9yIDEsIA0KICAgICAgICAgICAgIm1lc3NhZ2UiOiBlLm1zZyBvciAiU3ludGF4IGVycm9yIiwNCiAgICAgICAgICAgICJ0eXBlIjogInN5bnRheCINCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4geyJ2YWxpZCI6IEZhbHNlLCAiZXJyb3JzIjogW2Vycm9yX2luZm9dfQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgZXJyb3JfaW5mbyA9IHsNCiAgICAgICAgICAgICJsaW5lIjogMSwNCiAgICAgICAgICAgICJjb2x1bW4iOiAxLA0KICAgICAgICAgICAgIm1lc3NhZ2UiOiBzdHIoZSksDQogICAgICAgICAgICAidHlwZSI6ICJnZW5lcmFsIg0KICAgICAgICB9DQogICAgICAgIHJldHVybiB7InZhbGlkIjogRmFsc2UsICJlcnJvcnMiOiBbZXJyb3JfaW5mb119DQogICAgICAgIGApOw0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci5weW9kaWRlTG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgY29uc29sZS5sb2coJ+KchSBQeW9kaWRlIGxvYWRlZCBhbmQgY29uZmlndXJlZCBzdWNjZXNzZnVsbHkhJyk7DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IG5vdGlmaWNhdGlvbg0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignUHl0aG9uIHZhbGlkYXRpb24gcmVhZHkhJywgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB3aW5kb3cucHlvZGlkZTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBsb2FkIFB5b2RpZGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIGxvYWQgUHl0aG9uIHZhbGlkYXRpb246ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgdGhyb3cgZXJyb3I7DQogICAgfQ0KfQ0KDQovLyBWYWxpZGF0ZSBQeXRob24gc3ludGF4IHVzaW5nIFB5b2RpZGUNCmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlUHl0aG9uU3ludGF4KGNvZGUpIHsNCiAgICBjb25zb2xlLmxvZygn8J+UrCB2YWxpZGF0ZVB5dGhvblN5bnRheCBjYWxsZWQnKTsNCiAgICBjb25zb2xlLmxvZygnVmFsaWRhdGlvbiBlbmFibGVkOicsIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpOw0KICAgIA0KICAgIGlmICghdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCkgew0KICAgICAgICBjb25zb2xlLmxvZygn4p2MIFZhbGlkYXRpb24gZGlzYWJsZWQgLSByZXR1cm5pbmcgdmFsaWQnKTsNCiAgICAgICAgcmV0dXJuIHsidmFsaWQiOiB0cnVlLCAiZXJyb3JzIjogW119Ow0KICAgIH0NCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zb2xlLmxvZygn8J+TpiBMb2FkaW5nIFB5b2RpZGUuLi4nKTsNCiAgICAgICAgY29uc3QgcHlvZGlkZSA9IGF3YWl0IGxvYWRQeW9kaWRlKCk7DQogICAgICAgIGNvbnNvbGUubG9nKCfinIUgUHlvZGlkZSBsb2FkZWQsIHZhbGlkYXRpbmcgY29kZS4uLicpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2FsbCB0aGUgUHl0aG9uIHZhbGlkYXRpb24gZnVuY3Rpb24NCiAgICAgICAgcHlvZGlkZS5nbG9iYWxzLnNldCgiY29kZV90b192YWxpZGF0ZSIsIGNvZGUpOw0KICAgICAgICBjb25zdCByZXN1bHQgPSBweW9kaWRlLnJ1blB5dGhvbigidmFsaWRhdGVfcHl0aG9uX3N5bnRheChjb2RlX3RvX3ZhbGlkYXRlKSIpOw0KICAgICAgICANCiAgICAgICAgY29uc3QganNSZXN1bHQgPSByZXN1bHQudG9Kcyh7ZGljdF9jb252ZXJ0ZXI6IE9iamVjdC5mcm9tRW50cmllc30pOw0KICAgICAgICBjb25zb2xlLmxvZygn8J+OryBQeXRob24gdmFsaWRhdGlvbiByZXN1bHQ6JywganNSZXN1bHQpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIGpzUmVzdWx0Ow0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgUHlvZGlkZSB2YWxpZGF0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgY29uc29sZS5sb2coJ/CflIQgRmFsbGluZyBiYWNrIHRvIGJhc2ljIHN5bnRheCB2YWxpZGF0aW9uLi4uJyk7DQogICAgICAgIA0KICAgICAgICAvLyBGYWxsYmFjayB0byBiYXNpYyBjbGllbnQtc2lkZSB2YWxpZGF0aW9uDQogICAgICAgIHJldHVybiB2YWxpZGF0ZVB5dGhvbkJhc2ljKGNvZGUpOw0KICAgIH0NCn0NCg0KLy8gQmFzaWMgUHl0aG9uIHN5bnRheCB2YWxpZGF0aW9uIChmYWxsYmFjaykNCmZ1bmN0aW9uIHZhbGlkYXRlUHl0aG9uQmFzaWMoY29kZSkgew0KICAgIGNvbnNvbGUubG9nKCfwn5SnIFVzaW5nIGJhc2ljIFB5dGhvbiB2YWxpZGF0aW9uIGZhbGxiYWNrJyk7DQogICAgY29uc3QgZXJyb3JzID0gW107DQogICAgY29uc3QgbGluZXMgPSBjb2RlLnNwbGl0KCdcbicpOw0KICAgIA0KICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7DQogICAgICAgIGNvbnN0IGxpbmVOdW0gPSBpbmRleCArIDE7DQogICAgICAgIGNvbnN0IHRyaW1tZWQgPSBsaW5lLnRyaW0oKTsNCiAgICAgICAgDQogICAgICAgIC8vIFNraXAgZW1wdHkgbGluZXMgYW5kIGNvbW1lbnRzDQogICAgICAgIGlmICghdHJpbW1lZCB8fCB0cmltbWVkLnN0YXJ0c1dpdGgoJyMnKSkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgZm9yIHVudGVybWluYXRlZCBzdHJpbmdzIChtb3JlIGFjY3VyYXRlKQ0KICAgICAgICBsZXQgaW5TdHJpbmcgPSBmYWxzZTsNCiAgICAgICAgbGV0IHN0cmluZ0NoYXIgPSBudWxsOw0KICAgICAgICBsZXQgZXNjYXBlZCA9IGZhbHNlOw0KICAgICAgICANCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltbWVkLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBjb25zdCBjaGFyID0gdHJpbW1lZFtpXTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGVzY2FwZWQpIHsNCiAgICAgICAgICAgICAgICBlc2NhcGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChjaGFyID09PSAnXFwnKSB7DQogICAgICAgICAgICAgICAgZXNjYXBlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICghaW5TdHJpbmcgJiYgKGNoYXIgPT09ICciJyB8fCBjaGFyID09PSAiJyIpKSB7DQogICAgICAgICAgICAgICAgaW5TdHJpbmcgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHN0cmluZ0NoYXIgPSBjaGFyOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChpblN0cmluZyAmJiBjaGFyID09PSBzdHJpbmdDaGFyKSB7DQogICAgICAgICAgICAgICAgaW5TdHJpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBzdHJpbmdDaGFyID0gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKGluU3RyaW5nKSB7DQogICAgICAgICAgICBlcnJvcnMucHVzaCh7DQogICAgICAgICAgICAgICAgbGluZTogbGluZU51bSwNCiAgICAgICAgICAgICAgICBjb2x1bW46IDEsDQogICAgICAgICAgICAgICAgbWVzc2FnZTogIlVudGVybWluYXRlZCBzdHJpbmcgbGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgdHlwZTogInN5bnRheCINCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBmb3IgbWlzc2luZyBjb2xvbnMgYWZ0ZXIgY29udHJvbCBzdHJ1Y3R1cmVzIChtb3JlIHByZWNpc2UpDQogICAgICAgIGNvbnN0IGNvbnRyb2xTdHJ1Y3R1cmVzID0gL14oaWZ8ZWxpZnxlbHNlfGZvcnx3aGlsZXxkZWZ8Y2xhc3N8dHJ5fGV4Y2VwdHxmaW5hbGx5fHdpdGh8YXN5bmNccytkZWYpXHMvOw0KICAgICAgICBpZiAoY29udHJvbFN0cnVjdHVyZXMudGVzdCh0cmltbWVkKSAmJiAhdHJpbW1lZC5lbmRzV2l0aCgnOicpICYmICF0cmltbWVkLmluY2x1ZGVzKCcjJykpIHsNCiAgICAgICAgICAgIGVycm9ycy5wdXNoKHsNCiAgICAgICAgICAgICAgICBsaW5lOiBsaW5lTnVtLA0KICAgICAgICAgICAgICAgIGNvbHVtbjogdHJpbW1lZC5sZW5ndGgsDQogICAgICAgICAgICAgICAgbWVzc2FnZTogIk1pc3NpbmcgY29sb24iLA0KICAgICAgICAgICAgICAgIHR5cGU6ICJzeW50YXgiDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgZm9yIGJhc2ljIGluZGVudGF0aW9uIGVycm9ycyAodmVyeSBiYXNpYykNCiAgICAgICAgaWYgKHRyaW1tZWQubWF0Y2goL14ocmV0dXJufGJyZWFrfGNvbnRpbnVlfHBhc3N8cmFpc2V8eWllbGQpXHMvKSAmJiBsaW5lICE9PSB0cmltbWVkKSB7DQogICAgICAgICAgICAvLyBUaGVzZSBrZXl3b3JkcyBzaG91bGQgdHlwaWNhbGx5IGJlIGF0IHByb3BlciBpbmRlbnRhdGlvbiBsZXZlbHMNCiAgICAgICAgICAgIC8vIEJ1dCB0aGlzIGlzIHRvbyBjb21wbGV4IGZvciBiYXNpYyB2YWxpZGF0aW9uLCBzbyBza2lwIGl0DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIE9ubHkgY2hlY2sgcGFyZW50aGVzZXMgb24gbGluZXMgdGhhdCBzZWVtIHRvIGhhdmUgZnVuY3Rpb24gY2FsbHMgb3IgZGVmaW5pdGlvbnMNCiAgICAgICAgaWYgKHRyaW1tZWQuaW5jbHVkZXMoJygnKSB8fCB0cmltbWVkLmluY2x1ZGVzKCcpJykpIHsNCiAgICAgICAgICAgIGNvbnN0IG9wZW5QYXJlbnMgPSAodHJpbW1lZC5tYXRjaCgvXCgvZykgfHwgW10pLmxlbmd0aDsNCiAgICAgICAgICAgIGNvbnN0IGNsb3NlUGFyZW5zID0gKHRyaW1tZWQubWF0Y2goL1wpL2cpIHx8IFtdKS5sZW5ndGg7DQogICAgICAgICAgICBpZiAob3BlblBhcmVucyAhPT0gY2xvc2VQYXJlbnMpIHsNCiAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIGxpbmU6IGxpbmVOdW0sDQogICAgICAgICAgICAgICAgICAgIGNvbHVtbjogMSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIlVubWF0Y2hlZCBwYXJlbnRoZXNlcyIsDQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzeW50YXgiDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhg8J+OryBCYXNpYyB2YWxpZGF0aW9uIGZvdW5kICR7ZXJyb3JzLmxlbmd0aH0gZXJyb3JzYCk7DQogICAgcmV0dXJuIHsNCiAgICAgICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsDQogICAgICAgIGVycm9yczogZXJyb3JzDQogICAgfTsNCn0NCg0KLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiB3aXRoIGRlYm91bmNpbmcNCmZ1bmN0aW9uIHNjaGVkdWxlVmFsaWRhdGlvbigpIHsNCiAgICBjb25zb2xlLmxvZygn8J+UjSBzY2hlZHVsZVZhbGlkYXRpb24gY2FsbGVkJyk7DQogICAgY29uc29sZS5sb2coJ0N1cnJlbnQgZmlsZSBwYXRoOicsIHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIGNvbnNvbGUubG9nKCdJcyBQeXRob24gZmlsZTonLCBpc1B5dGhvbkZpbGUodGV4dEVkaXRvci5maWxlUGF0aCkpOw0KICAgIGNvbnNvbGUubG9nKCdWYWxpZGF0aW9uIGVuYWJsZWQ6JywgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCk7DQogICAgDQogICAgLy8gQ2xlYXIgZXhpc3RpbmcgdGltZXINCiAgICBpZiAodGV4dEVkaXRvci52YWxpZGF0aW9uRGVib3VuY2VUaW1lcikgew0KICAgICAgICBjbGVhclRpbWVvdXQodGV4dEVkaXRvci52YWxpZGF0aW9uRGVib3VuY2VUaW1lcik7DQogICAgfQ0KICAgIA0KICAgIC8vIE9ubHkgdmFsaWRhdGUgUHl0aG9uIGZpbGVzDQogICAgaWYgKCFpc1B5dGhvbkZpbGUodGV4dEVkaXRvci5maWxlUGF0aCkgfHwgIXRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpIHsNCiAgICAgICAgY29uc29sZS5sb2coJ+KdjCBTa2lwcGluZyB2YWxpZGF0aW9uIC0gbm90IFB5dGhvbiBmaWxlIG9yIHZhbGlkYXRpb24gZGlzYWJsZWQnKTsNCiAgICAgICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICAgICAgdXBkYXRlRXJyb3JDb3VudCgwKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zb2xlLmxvZygn4pyFIFNjaGVkdWxpbmcgUHl0aG9uIHZhbGlkYXRpb24uLi4nKTsNCiAgICANCiAgICAvLyBEZWJvdW5jZSB2YWxpZGF0aW9uIHRvIGF2b2lkIHRvbyBmcmVxdWVudCBjYWxscyBhbmQgaW50ZXJmZXJlbmNlIHdpdGggdHlwaW5nDQogICAgdGV4dEVkaXRvci52YWxpZGF0aW9uRGVib3VuY2VUaW1lciA9IHNldFRpbWVvdXQoYXN5bmMgKCkgPT4gew0KICAgICAgICBjb25zdCBjb2RlID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCiAgICAgICAgY29uc29sZS5sb2coJ/CfkI0gQWJvdXQgdG8gdmFsaWRhdGUgUHl0aG9uIGNvZGU6JywgY29kZS5zdWJzdHJpbmcoMCwgMTAwKSArICcuLi4nKTsNCiAgICAgICAgDQogICAgICAgIC8vIERvbid0IHZhbGlkYXRlIGVtcHR5IGZpbGVzDQogICAgICAgIGlmICghY29kZS50cmltKCkpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5OdIEVtcHR5IGNvZGUgLSBjbGVhcmluZyBlcnJvcnMnKTsNCiAgICAgICAgICAgIGNsZWFyRXJyb3JNYXJrZXJzKCk7DQogICAgICAgICAgICB1cGRhdGVFcnJvckNvdW50KDApOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ/CfmoAgQ2FsbGluZyB2YWxpZGF0ZVB5dGhvblN5bnRheC4uLicpOw0KICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVQeXRob25TeW50YXgoY29kZSk7DQogICAgICAgICAgICBjb25zb2xlLmxvZygn8J+TiiBWYWxpZGF0aW9uIHJlc3VsdDonLCByZXN1bHQpOw0KICAgICAgICAgICAgZGlzcGxheVZhbGlkYXRpb25FcnJvcnMocmVzdWx0LmVycm9ycyB8fCBbXSk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgVmFsaWRhdGlvbiBzY2hlZHVsaW5nIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0sIDEwMDApOyAvLyAxMDAwbXMgZGVsYXkgLSBtdWNoIGxvbmdlciB0byBhdm9pZCBpbnRlcmZlcmluZyB3aXRoIGZhc3QgdHlwaW5nDQp9DQoNCi8vIERpc3BsYXkgdmFsaWRhdGlvbiBlcnJvcnMgaW4gdGhlIGVkaXRvcg0KZnVuY3Rpb24gZGlzcGxheVZhbGlkYXRpb25FcnJvcnMoZXJyb3JzKSB7DQogICAgLy8gQ2xlYXIgcHJldmlvdXMgZXJyb3JzDQogICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICANCiAgICAvLyBTdG9yZSBjdXJyZW50IGVycm9ycw0KICAgIHRleHRFZGl0b3IuY3VycmVudEVycm9ycyA9IGVycm9yczsNCiAgICANCiAgICAvLyBVcGRhdGUgZXJyb3IgY291bnQNCiAgICB1cGRhdGVFcnJvckNvdW50KGVycm9ycy5sZW5ndGgpOw0KICAgIA0KICAgIC8vIEFkZCBlcnJvciBtYXJrZXJzDQogICAgZXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBhZGRFcnJvck1hcmtlcihlcnJvci5saW5lLCBlcnJvci5tZXNzYWdlLCBlcnJvci50eXBlKTsNCiAgICB9KTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhgVmFsaWRhdGlvbiBjb21wbGV0ZTogJHtlcnJvcnMubGVuZ3RofSBlcnJvcnMgZm91bmRgKTsNCn0NCg0KLy8gQWRkIGVycm9yIG1hcmtlciB0byBhIHNwZWNpZmljIGxpbmUNCmZ1bmN0aW9uIGFkZEVycm9yTWFya2VyKGxpbmVOdW1iZXIsIG1lc3NhZ2UsIHR5cGUgPSAnc3ludGF4Jykgew0KICAgIGlmICghdGV4dEVkaXRvci5saW5lTnVtYmVycyB8fCBsaW5lTnVtYmVyIDwgMSkgcmV0dXJuOw0KICAgIA0KICAgIC8vIEZpbmQgdGhlIGxpbmUgbnVtYmVyIGVsZW1lbnQNCiAgICBjb25zdCBsaW5lTnVtYmVyRWxlbWVudHMgPSB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzLmNoaWxkcmVuOw0KICAgIGNvbnN0IGxpbmVJbmRleCA9IGxpbmVOdW1iZXIgLSAxOyAvLyBDb252ZXJ0IHRvIDAtYmFzZWQgaW5kZXgNCiAgICANCiAgICBpZiAobGluZUluZGV4IDwgbGluZU51bWJlckVsZW1lbnRzLmxlbmd0aCkgew0KICAgICAgICBjb25zdCBsaW5lRWwgPSBsaW5lTnVtYmVyRWxlbWVudHNbbGluZUluZGV4XTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBlcnJvciBjbGFzcw0KICAgICAgICBsaW5lRWwuY2xhc3NMaXN0LmFkZCgnbGluZS1lcnJvcicpOw0KICAgICAgICBsaW5lRWwudGl0bGUgPSBgTGluZSAke2xpbmVOdW1iZXJ9OiAke21lc3NhZ2V9YDsNCiAgICAgICAgDQogICAgICAgIC8vIFN0b3JlIGVycm9yIGluZm8gZm9yIGNsZWFudXANCiAgICAgICAgdGV4dEVkaXRvci5lcnJvck1hcmtlcnMucHVzaChsaW5lRWwpOw0KICAgIH0NCiAgICANCiAgICAvLyBBbHNvIHRyeSB0byBhZGQgdW5kZXJsaW5lIHRvIHRoZSB0ZXh0IGlmIHVzaW5nIGhpZ2hsaWdodGVkIGVkaXRvcg0KICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIGFkZEVycm9yVW5kZXJsaW5lKGxpbmVOdW1iZXIsIG1lc3NhZ2UpOw0KICAgIH0NCn0NCg0KLy8gQWRkIGVycm9yIHVuZGVybGluZSB0byBoaWdobGlnaHRlZCBlZGl0b3IgKGJhc2ljIGltcGxlbWVudGF0aW9uKQ0KZnVuY3Rpb24gYWRkRXJyb3JVbmRlcmxpbmUobGluZU51bWJlciwgbWVzc2FnZSkgew0KICAgIC8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIHZlcnNpb24gLSB3ZSBjb3VsZCBtYWtlIGl0IG1vcmUgc29waGlzdGljYXRlZA0KICAgIC8vIEZvciBub3csIHdlJ2xsIHJlbHkgb24gdGhlIGxpbmUgbnVtYmVyIGhpZ2hsaWdodGluZw0KICAgIGNvbnNvbGUubG9nKGBFcnJvciBvbiBsaW5lICR7bGluZU51bWJlcn06ICR7bWVzc2FnZX1gKTsNCn0NCg0KLy8gQ2xlYXIgYWxsIGVycm9yIG1hcmtlcnMNCmZ1bmN0aW9uIGNsZWFyRXJyb3JNYXJrZXJzKCkgew0KICAgIC8vIENsZWFyIGxpbmUgbnVtYmVyIGVycm9yIGNsYXNzZXMNCiAgICB0ZXh0RWRpdG9yLmVycm9yTWFya2Vycy5mb3JFYWNoKGxpbmVFbCA9PiB7DQogICAgICAgIGxpbmVFbC5jbGFzc0xpc3QucmVtb3ZlKCdsaW5lLWVycm9yJyk7DQogICAgICAgIGxpbmVFbC5yZW1vdmVBdHRyaWJ1dGUoJ3RpdGxlJyk7DQogICAgfSk7DQogICAgDQogICAgdGV4dEVkaXRvci5lcnJvck1hcmtlcnMgPSBbXTsNCiAgICB0ZXh0RWRpdG9yLmN1cnJlbnRFcnJvcnMgPSBbXTsNCn0NCg0KLy8gVXBkYXRlIGVycm9yIGNvdW50IGluIHN0YXR1cyBiYXINCmZ1bmN0aW9uIHVwZGF0ZUVycm9yQ291bnQoY291bnQpIHsNCiAgICBpZiAoZXJyb3JDb3VudEVsKSB7DQogICAgICAgIGVycm9yQ291bnRFbC50ZXh0Q29udGVudCA9IGNvdW50LnRvU3RyaW5nKCk7DQogICAgICAgIGVycm9yQ291bnRFbC5zdHlsZS5jb2xvciA9IGNvdW50ID4gMCA/ICcjZmY2YjZiJyA6ICcjNTFjZjY2JzsNCiAgICB9DQp9DQoNCi8vIENyZWF0ZSBoaWdobGlnaHRlZCBlZGl0b3INCmZ1bmN0aW9uIGNyZWF0ZUhpZ2hsaWdodGVkRWRpdG9yKCkgew0KICAgIGlmICghdGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIC8vIENsZWFuIHVwIGFueSBleGlzdGluZyBoaWdobGlnaHRlZCBzZXR1cA0KICAgIGNsZWFudXBIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgIA0KICAgIGNvbnN0IGVkaXRvcldyYXBwZXIgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnBhcmVudEVsZW1lbnQ7DQogICAgY29uc3QgdGV4dGFyZWEgPSB0ZXh0RWRpdG9yLnRleHRhcmVhOw0KICAgIA0KICAgIC8vIFN0b3JlIG9yaWdpbmFsIHRleHRhcmVhIHN0eWxlcw0KICAgIGNvbnN0IG9yaWdpbmFsU3R5bGVzID0gew0KICAgICAgICBwb3NpdGlvbjogdGV4dGFyZWEuc3R5bGUucG9zaXRpb24sDQogICAgICAgIGJhY2tncm91bmQ6IHRleHRhcmVhLnN0eWxlLmJhY2tncm91bmQsDQogICAgICAgIGNvbG9yOiB0ZXh0YXJlYS5zdHlsZS5jb2xvciwNCiAgICAgICAgekluZGV4OiB0ZXh0YXJlYS5zdHlsZS56SW5kZXgsDQogICAgICAgIGNhcmV0Q29sb3I6IHRleHRhcmVhLnN0eWxlLmNhcmV0Q29sb3IsDQogICAgICAgIHNwZWxsY2hlY2s6IHRleHRhcmVhLmdldEF0dHJpYnV0ZSgnc3BlbGxjaGVjaycpLA0KICAgICAgICBhdXRvY29tcGxldGU6IHRleHRhcmVhLmdldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJyksDQogICAgICAgIGF1dG9jb3JyZWN0OiB0ZXh0YXJlYS5nZXRBdHRyaWJ1dGUoJ2F1dG9jb3JyZWN0JyksDQogICAgICAgIGF1dG9jYXBpdGFsaXplOiB0ZXh0YXJlYS5nZXRBdHRyaWJ1dGUoJ2F1dG9jYXBpdGFsaXplJykNCiAgICB9Ow0KICAgIA0KICAgIC8vIENyZWF0ZSBhIGNvbnRhaW5lciBmb3IgdGhlIG92ZXJsYXkgYXBwcm9hY2gNCiAgICBjb25zdCBoaWdobGlnaHRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBoaWdobGlnaHRDb250YWluZXIuY2xhc3NOYW1lID0gJ2hpZ2hsaWdodC1jb250YWluZXInOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7DQogICAgDQogICAgLy8gQ3JlYXRlIGhpZ2hsaWdodGVkIGJhY2tkcm9wDQogICAgY29uc3QgaGlnaGxpZ2h0ZWRCYWNrZHJvcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3AuaWQgPSAnaGlnaGxpZ2h0ZWQtYmFja2Ryb3AnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3AuY2xhc3NOYW1lID0gJ2hpZ2hsaWdodGVkLWJhY2tkcm9wJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLnRvcCA9ICcwJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmxlZnQgPSAnMCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5mb250RmFtaWx5ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLmZvbnRGYW1pbHk7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5mb250U2l6ZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5mb250U2l6ZTsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmxpbmVIZWlnaHQgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkubGluZUhlaWdodDsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLnBhZGRpbmcgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkucGFkZGluZzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLm1hcmdpbiA9ICcwJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmJvcmRlciA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5ib3JkZXI7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS53aGl0ZVNwYWNlID0gJ3ByZS13cmFwJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLndvcmRXcmFwID0gJ2JyZWFrLXdvcmQnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLnpJbmRleCA9ICcxJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLnJlc2l6ZSA9ICdub25lJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmNvbG9yID0gJyNmZmZmZmYnOyAvLyBEZWZhdWx0IHRleHQgY29sb3IgZm9yIGhpZ2hsaWdodGluZw0KICAgIA0KICAgIC8vIE1ha2Ugc3VyZSB0ZXh0YXJlYSBpcyBvbiB0b3AgYW5kIGhhcyB0cmFuc3BhcmVudCBiYWNrZ3JvdW5kIGFuZCB0ZXh0DQogICAgdGV4dGFyZWEuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnOw0KICAgIHRleHRhcmVhLnN0eWxlLnpJbmRleCA9ICcyJzsNCiAgICB0ZXh0YXJlYS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50JzsNCiAgICB0ZXh0YXJlYS5zdHlsZS5jb2xvciA9ICd0cmFuc3BhcmVudCc7DQogICAgdGV4dGFyZWEuc3R5bGUuY2FyZXRDb2xvciA9ICcjZmZmZmZmJzsNCiAgICANCiAgICAvLyBEaXNhYmxlIGJyb3dzZXIgc3BlbGwgY2hlY2tpbmcgZm9yIGNvZGUNCiAgICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ3NwZWxsY2hlY2snLCAnZmFsc2UnKTsNCiAgICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsICdvZmYnKTsNCiAgICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ2F1dG9jb3JyZWN0JywgJ29mZicpOw0KICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NhcGl0YWxpemUnLCAnb2ZmJyk7DQogICAgDQogICAgLy8gV3JhcCB0ZXh0YXJlYSBpbiBjb250YWluZXINCiAgICBlZGl0b3JXcmFwcGVyLmluc2VydEJlZm9yZShoaWdobGlnaHRDb250YWluZXIsIHRleHRhcmVhKTsNCiAgICBoaWdobGlnaHRDb250YWluZXIuYXBwZW5kQ2hpbGQoaGlnaGxpZ2h0ZWRCYWNrZHJvcCk7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLmFwcGVuZENoaWxkKHRleHRhcmVhKTsNCiAgICANCiAgICB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yID0gaGlnaGxpZ2h0ZWRCYWNrZHJvcDsNCiAgICB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lciA9IGhpZ2hsaWdodENvbnRhaW5lcjsNCiAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMgPSBvcmlnaW5hbFN0eWxlczsNCiAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSB0cnVlOw0KICAgIA0KICAgIC8vIFNldCBpbml0aWFsIGNvbnRlbnQNCiAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICANCiAgICAvLyBTZXQgdXAgc2ltcGxlIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgdGV4dGFyZWEgKG5vdCB0aGUgYmFja2Ryb3ApDQogICAgdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBoYW5kbGVTaW1wbGVJbnB1dCk7DQogICAgdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc3luY0JhY2tkcm9wU2Nyb2xsKTsNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlSGlnaGxpZ2h0S2V5RG93bik7DQogICAgdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVIaWdobGlnaHRDbGljayk7DQogICAgdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBoYW5kbGVIaWdobGlnaHRGb2N1cyk7DQogICAgDQogICAgY29uc29sZS5sb2coJ+KchSBIaWdobGlnaHRlZCBiYWNrZHJvcCBjcmVhdGVkIChvdmVybGF5IG1ldGhvZCknKTsNCn0NCg0KLy8gRm9jdXMgYXBwcm9wcmlhdGUgZWRpdG9yDQpmdW5jdGlvbiBmb2N1c0VkaXRvcigpIHsNCiAgICBpZiAodGV4dEVkaXRvci50ZXh0YXJlYSkgew0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmZvY3VzKCk7DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudA0KZnVuY3Rpb24gdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCkgew0KICAgIGlmICghdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciB8fCAhdGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KICAgIGNvbnN0IGxhbmd1YWdlID0gZ2V0RmlsZUxhbmd1YWdlKHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIA0KICAgIGlmICghbGFuZ3VhZ2UpIHsNCiAgICAgICAgLy8gTm8gbGFuZ3VhZ2UgZGV0ZWN0ZWQsIHVzZSBwbGFpbiB0ZXh0DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IudGV4dENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEFwcGx5IHN5bnRheCBoaWdobGlnaHRpbmcgdG8gYmFja2Ryb3ANCiAgICBjb25zdCBoaWdobGlnaHRlZENvbnRlbnQgPSBQcmlzbS5oaWdobGlnaHQoY29udGVudCwgUHJpc20ubGFuZ3VhZ2VzW2xhbmd1YWdlXSwgbGFuZ3VhZ2UpOw0KICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IuaW5uZXJIVE1MID0gaGlnaGxpZ2h0ZWRDb250ZW50Ow0KICAgIA0KICAgIC8vIFN5bmMgc2Nyb2xsIHBvc2l0aW9uDQogICAgc3luY0JhY2tkcm9wU2Nyb2xsKCk7DQogICAgDQogICAgY29uc29sZS5sb2coJ+KchSBCYWNrZHJvcCBoaWdobGlnaHRpbmcgdXBkYXRlZCcpOw0KfQ0KDQovLyBTaW1wbGUgaGVscGVyIGZ1bmN0aW9ucyAoa2VlcGluZyB0aGVzZSBmb3IgcG90ZW50aWFsIGZ1dHVyZSB1c2UpDQpmdW5jdGlvbiBnZXRTaW1wbGVUZXh0Q29udGVudCgpIHsNCiAgICByZXR1cm4gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCn0NCg0KLy8gSGFuZGxlIHNpbXBsZSBpbnB1dCBmb3IgYmFja2Ryb3AgYXBwcm9hY2gNCmZ1bmN0aW9uIGhhbmRsZVNpbXBsZUlucHV0KCkgew0KICAgIC8vIFVwZGF0ZSBsaW5lIG51bWJlcnMgYW5kIHN0YXR1cyBpbW1lZGlhdGVseQ0KICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgbWFya0FzTW9kaWZpZWQoKTsNCiAgICANCiAgICAvLyBJbW1lZGlhdGUgaGlnaGxpZ2h0aW5nIHVwZGF0ZSBmb3IgcmVzcG9uc2l2ZSBmZWVsDQogICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgDQogICAgLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiBmb3IgUHl0aG9uIGZpbGVzDQogICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQp9DQoNCi8vIEhhbmRsZSBrZXkgZXZlbnRzIHRoYXQgbWlnaHQgY2hhbmdlIGNvbnRlbnQNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodEtleURvd24oZSkgew0KICAgIC8vIEZvciBrZXlzIHRoYXQgbW9kaWZ5IGNvbnRlbnQsIHVwZGF0ZSBoaWdobGlnaHRpbmcgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIGV2ZW50DQogICAgaWYgKGUua2V5ID09PSAnVGFiJyB8fCBlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmtleSA9PT0gJ0JhY2tzcGFjZScgfHwgZS5rZXkgPT09ICdEZWxldGUnKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0sIDApOyAvLyBVcGRhdGUgb24gbmV4dCB0aWNrIGFmdGVyIHRoZSBrZXkgZXZlbnQgaXMgcHJvY2Vzc2VkDQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgY2xpY2sgZXZlbnRzIChjdXJzb3IgcG9zaXRpb24gY2hhbmdlcykNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodENsaWNrKCkgew0KICAgIC8vIFN5bmMgc2Nyb2xsIHBvc2l0aW9uIHdoZW4gdXNlciBjbGlja3MNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KLy8gSGFuZGxlIGZvY3VzIGV2ZW50cw0KZnVuY3Rpb24gaGFuZGxlSGlnaGxpZ2h0Rm9jdXMoKSB7DQogICAgLy8gRW5zdXJlIGhpZ2hsaWdodGluZyBpcyBpbiBzeW5jIHdoZW4gdGV4dGFyZWEgZ2V0cyBmb2N1cw0KICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIHN5bmNCYWNrZHJvcFNjcm9sbCgpOw0KfQ0KDQovLyBTeW5jIGJhY2tkcm9wIHNjcm9sbCB3aXRoIHRleHRhcmVhDQpmdW5jdGlvbiBzeW5jQmFja2Ryb3BTY3JvbGwoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zY3JvbGxUb3AgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNjcm9sbFRvcDsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zY3JvbGxMZWZ0ID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zY3JvbGxMZWZ0Ow0KICAgIH0NCn0NCg0KLy8gQ2xlYW4gdXAgaGlnaGxpZ2h0ZWQgZWRpdG9yDQpmdW5jdGlvbiBjbGVhbnVwSGlnaGxpZ2h0ZWRFZGl0b3IoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyKSB7DQogICAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGV4dGFyZWEgc3R5bGVzDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gdGV4dEVkaXRvci50ZXh0YXJlYTsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uID0gdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLnBvc2l0aW9uOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuYmFja2dyb3VuZCA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5iYWNrZ3JvdW5kOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuY29sb3IgPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuY29sb3I7DQogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS56SW5kZXggPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuekluZGV4Ow0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuY2FyZXRDb2xvciA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5jYXJldENvbG9yOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZXN0b3JlIGJyb3dzZXIgZmVhdHVyZXMgYXR0cmlidXRlcw0KICAgICAgICAgICAgaWYgKHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5zcGVsbGNoZWNrKSB7DQogICAgICAgICAgICAgICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdzcGVsbGNoZWNrJywgdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLnNwZWxsY2hlY2spOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5hdXRvY29tcGxldGUpIHsNCiAgICAgICAgICAgICAgICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsIHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5hdXRvY29tcGxldGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5hdXRvY29ycmVjdCkgew0KICAgICAgICAgICAgICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnLCB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuYXV0b2NvcnJlY3QpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5hdXRvY2FwaXRhbGl6ZSkgew0KICAgICAgICAgICAgICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NhcGl0YWxpemUnLCB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuYXV0b2NhcGl0YWxpemUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbnRhaW5lciBhbmQgcmVzdG9yZSB0ZXh0YXJlYSB0byBpdHMgb3JpZ2luYWwgcGFyZW50DQogICAgICAgIGNvbnN0IGVkaXRvcldyYXBwZXIgPSB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lci5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRFZGl0b3IudGV4dGFyZWE7DQogICAgICAgIA0KICAgICAgICAvLyBNb3ZlIHRleHRhcmVhIGJhY2sgdG8gaXRzIG9yaWdpbmFsIGxvY2F0aW9uDQogICAgICAgIGVkaXRvcldyYXBwZXIuaW5zZXJ0QmVmb3JlKHRleHRhcmVhLCB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lcik7DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgdGhlIGhpZ2hsaWdodCBjb250YWluZXINCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIucmVtb3ZlKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciByZWZlcmVuY2VzDQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyID0gbnVsbDsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciA9IG51bGw7DQogICAgICAgIHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcyA9IG51bGw7DQogICAgfQ0KfQ0KDQovLyBTaW1wbGUgaGVscGVyIGZ1bmN0aW9ucyAoa2VlcGluZyB0aGVzZSBmb3IgcG90ZW50aWFsIGZ1dHVyZSB1c2UpDQpmdW5jdGlvbiBnZXRTaW1wbGVUZXh0Q29udGVudCgpIHsNCiAgICByZXR1cm4gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCn0NCg0KLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgZm9yIHN1cHBvcnRlZCBmaWxlcw0KYXN5bmMgZnVuY3Rpb24gZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCkgew0KICAgIGlmICghdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpIHsNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGxhbmd1YWdlID0gZ2V0RmlsZUxhbmd1YWdlKHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIA0KICAgIGlmIChsYW5ndWFnZSkgew0KICAgICAgICBpZiAoIXRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHsNCiAgICAgICAgICAgIGF3YWl0IGxvYWRQcmlzbUpTKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmICghdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgY3JlYXRlSGlnaGxpZ2h0ZWRFZGl0b3IoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgY29uc29sZS5sb2coYOKchSBTeW50YXggaGlnaGxpZ2h0aW5nIGVuYWJsZWQgZm9yICR7bGFuZ3VhZ2V9IGZpbGVgKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBEaXNhYmxlIGhpZ2hsaWdodGluZyBmb3IgdW5zdXBwb3J0ZWQgZmlsZXMNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgIH0NCn0NCg0KLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQpmdW5jdGlvbiBzZXR1cEV2ZW50SGFuZGxlcnMoKSB7DQogICAgLy8gQnV0dG9uIGV2ZW50cw0KICAgIG5ld0ZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlTmV3RmlsZSk7DQogICAgbG9hZEZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbG9hZEZpbGUpOw0KICAgIHNhdmVGaWxlQnRuPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVGaWxlKTsNCiAgICBzYXZlQXNGaWxlQnRuPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVBc0ZpbGUpOw0KICAgIHdvcmRXcmFwVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVdvcmRXcmFwKTsNCiAgICBsaW5lTnVtYmVyc1RvZ2dsZT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVMaW5lTnVtYmVycyk7DQogICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgdmFsaWRhdGlvblRvZ2dsZT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVWYWxpZGF0aW9uKTsNCiAgICANCiAgICAvLyBUZXh0YXJlYSBldmVudHMNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaGFuZGxlVGV4dENoYW5nZSk7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzeW5jU2Nyb2xsKTsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVLZXlEb3duKTsNCiAgICANCg0KICAgIA0KICAgIC8vIFdpbmRvdyBldmVudHMNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgaGFuZGxlQmVmb3JlVW5sb2FkKTsNCn0NCg0KLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpIHsNCiAgICBpZiAoY3VycmVudEZpbGVuYW1lRWwpIHsNCiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSB0ZXh0RWRpdG9yLmZpbGVQYXRoID8gdGV4dEVkaXRvci5maWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpIDogJ3VudGl0bGVkLnR4dCc7DQogICAgICAgIGN1cnJlbnRGaWxlbmFtZUVsLnRleHRDb250ZW50ID0gZmlsZW5hbWU7DQogICAgfQ0KfQ0KDQovLyBJbml0aWFsaXplIGVkaXRvciBzdGF0ZQ0KZnVuY3Rpb24gaW5pdGlhbGl6ZUVkaXRvcigpIHsNCiAgICAvLyBTZXQgaW5pdGlhbCBmaWxlIHBhdGgNCiAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gJy91bnRpdGxlZC50eHQnOw0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBsaW5lIG51bWJlcnMNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBzdGF0dXMNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICANCiAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBpZiBuZWVkZWQNCiAgICBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICANCiAgICAvLyBTdGFydCBhdXRvLXNhdmUgaWYgZW5hYmxlZA0KICAgIGlmICh0ZXh0RWRpdG9yLnNldHRpbmdzLmF1dG9TYXZlSW50ZXJ2YWwgPiAwKSB7DQogICAgICAgIHN0YXJ0QXV0b1NhdmUoKTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSB0ZXh0IGNoYW5nZXMNCmZ1bmN0aW9uIGhhbmRsZVRleHRDaGFuZ2UoKSB7DQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICBtYXJrQXNNb2RpZmllZCgpOw0KICAgIA0KICAgIC8vIFNjaGVkdWxlIHZhbGlkYXRpb24gZm9yIFB5dGhvbiBmaWxlcw0KICAgIHNjaGVkdWxlVmFsaWRhdGlvbigpOw0KfQ0KDQovLyBVcGRhdGUgbGluZSBudW1iZXJzDQpmdW5jdGlvbiB1cGRhdGVMaW5lTnVtYmVycygpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IubGluZU51bWJlcnMgfHwgIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKSByZXR1cm47DQogICAgDQogICAgY29uc3QgbGluZXMgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnNwbGl0KCdcbicpOw0KICAgIGNvbnN0IGxpbmVDb3VudCA9IGxpbmVzLmxlbmd0aDsNCiAgICANCiAgICAvLyBHZW5lcmF0ZSBsaW5lIG51bWJlcnMgSFRNTA0KICAgIGxldCBsaW5lTnVtYmVyc0hUTUwgPSAnJzsNCiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBsaW5lQ291bnQ7IGkrKykgew0KICAgICAgICBsaW5lTnVtYmVyc0hUTUwgKz0gYDxzcGFuIGNsYXNzPSJsaW5lLW51bWJlciI+JHtpfTwvc3Bhbj5cbmA7DQogICAgfQ0KICAgIA0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuaW5uZXJIVE1MID0gbGluZU51bWJlcnNIVE1MOw0KfQ0KDQovLyBTeW5jIHNjcm9sbCBiZXR3ZWVuIHRleHRhcmVhIGFuZCBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHN5bmNTY3JvbGwoKSB7DQogICAgaWYgKHRleHRFZGl0b3IubGluZU51bWJlcnMgJiYgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHsNCiAgICAgICAgdGV4dEVkaXRvci5saW5lTnVtYmVycy5zY3JvbGxUb3AgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNjcm9sbFRvcDsNCiAgICB9DQogICAgDQogICAgLy8gQWxzbyBzeW5jIHRoZSBiYWNrZHJvcCBpZiBpdCBleGlzdHMNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KLy8gVXBkYXRlIHN0YXR1cyBiYXINCmZ1bmN0aW9uIHVwZGF0ZVN0YXR1cygpIHsNCiAgICAvLyBTdGF0dXMgYmFyIG5vdyBvbmx5IHNob3dzIG1vZGlmaWVkIHN0YXR1cywgd2hpY2ggaXMgaGFuZGxlZCBieSBtYXJrQXNNb2RpZmllZC9tYXJrQXNTYXZlZA0KICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMga2VwdCBmb3IgcG90ZW50aWFsIGZ1dHVyZSB1c2UNCn0NCg0KLy8gTWFyayBmaWxlIGFzIG1vZGlmaWVkDQpmdW5jdGlvbiBtYXJrQXNNb2RpZmllZCgpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICB0ZXh0RWRpdG9yLmlzTW9kaWZpZWQgPSB0cnVlOw0KICAgICAgICBpZiAobW9kaWZpZWRTdGF0dXNFbCkgew0KICAgICAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC50ZXh0Q29udGVudCA9ICdZZXMnOw0KICAgICAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC5jbGFzc0xpc3QuYWRkKCdtb2RpZmllZCcpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBNYXJrIGZpbGUgYXMgc2F2ZWQNCmZ1bmN0aW9uIG1hcmtBc1NhdmVkKCkgew0KICAgIHRleHRFZGl0b3IuaXNNb2RpZmllZCA9IGZhbHNlOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCiAgICBpZiAobW9kaWZpZWRTdGF0dXNFbCkgew0KICAgICAgICBtb2RpZmllZFN0YXR1c0VsLnRleHRDb250ZW50ID0gJ05vJzsNCiAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RpZmllZCcpOw0KICAgIH0NCn0NCg0KLy8gQ3JlYXRlIG5ldyBmaWxlDQpmdW5jdGlvbiBjcmVhdGVOZXdGaWxlKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmlzTW9kaWZpZWQpIHsNCiAgICAgICAgaWYgKGNvbmZpcm0oJ1lvdSBoYXZlIHVuc2F2ZWQgY2hhbmdlcy4gQ3JlYXRlIG5ldyBmaWxlIGFueXdheT8nKSkgew0KICAgICAgICAgICAgY2xlYXJFZGl0b3IoKTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIGNsZWFyRWRpdG9yKCk7DQogICAgfQ0KfQ0KDQovLyBDbGVhciBlZGl0b3INCmZ1bmN0aW9uIGNsZWFyRWRpdG9yKCkgew0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSAnJzsNCiAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gJy91bnRpdGxlZC50eHQnOw0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gJyc7DQogICAgbWFya0FzU2F2ZWQoKTsNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgIA0KICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBuZXcgZmlsZQ0KICAgIGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgIA0KICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDbGVhciBhbnkgZXhpc3RpbmcgZXJyb3JzDQogICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICB1cGRhdGVFcnJvckNvdW50KDApOw0KICAgIA0KICAgIC8vIEZvY3VzIHRoZSB0ZXh0YXJlYSAobm90IHRoZSBiYWNrZHJvcCkNCiAgICBmb2N1c0VkaXRvcigpOw0KfQ0KDQovLyBMb2FkIGZpbGUgZnJvbSBWRlMNCmFzeW5jIGZ1bmN0aW9uIGxvYWRGaWxlKCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ29wZW4nLA0KICAgICAgICAgICAgdGl0bGU6ICdPcGVuIFRleHQgRmlsZScsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSBzZWxlY3RlZCBmb3IgbG9hZGluZzonLCBzZWxlY3RlZFBhdGgpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgc2VsZWN0aW9uIGNhbmNlbGxlZCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMgYW5kIGxvYWQgaXQNCiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KGZpbGVQYXRoKTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgY29udGVudCBpbnRvIGVkaXRvcg0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlID0gY29udGVudDsNCiAgICAgICAgdGV4dEVkaXRvci5maWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgIA0KICAgICAgICAvLyBVcGRhdGUgVUkNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgICAgICBtYXJrQXNTYXZlZCgpOw0KICAgICAgICANCiAgICAgICAgLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgZm9yIGxvYWRlZCBmaWxlDQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgICAgICANCiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIGhpZ2hsaWdodGVkIGNvbnRlbnQgaWYgaGlnaGxpZ2h0aW5nIGlzIGVuYWJsZWQNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiBmb3IgUHl0aG9uIGZpbGVzDQogICAgICAgIHNjaGVkdWxlVmFsaWRhdGlvbigpOw0KICAgICAgICANCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZpbGUgbG9hZGVkOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGZpbGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIGxvYWQgZmlsZTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KLy8gU2F2ZSBmaWxlIHRvIFZGUw0KYXN5bmMgZnVuY3Rpb24gc2F2ZUZpbGUoKSB7DQogICAgY29uc3QgY29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGZpbGVQYXRoID0gdGV4dEVkaXRvci5maWxlUGF0aDsNCiAgICAgICAgDQogICAgICAgIC8vIElmIGl0J3MgYSBuZXcgZmlsZSAodW50aXRsZWQpIG9yIHdlIHdhbnQgdG8gc2F2ZSBhcywgc2hvdyBmaWxlIGV4cGxvcmVyDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLmZpbGVQYXRoID09PSAnL3VudGl0bGVkLnR4dCcpIHsNCiAgICAgICAgICAgIGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgICAgICB0aXRsZTogJ1NhdmUgVGV4dCBGaWxlJywNCiAgICAgICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgICAgIGZpbGVOYW1lOiAndW50aXRsZWQudHh0JywNCiAgICAgICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSBzZWxlY3RlZCBmb3Igc2F2aW5nOicsIHNlbGVjdGVkUGF0aCk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSBzZWxlY3Rpb24gY2FuY2VsbGVkJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBjb250ZW50KTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IuZmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIG1hcmtBc1NhdmVkKCk7DQogICAgICAgIA0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3Igc2F2ZWQgZmlsZQ0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICAgICAgDQogICAgICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGaWxlIHNhdmVkOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZpbGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIHNhdmUgZmlsZTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KLy8gU2F2ZSBmaWxlIGFzIChhbHdheXMgc2hvdyBmaWxlIGV4cGxvcmVyKQ0KYXN5bmMgZnVuY3Rpb24gc2F2ZUFzRmlsZSgpIHsNCiAgICBjb25zdCBjb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBUZXh0IEZpbGUgQXMnLA0KICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgIGZpbGVOYW1lOiB0ZXh0RWRpdG9yLmZpbGVQYXRoID09PSAnL3VudGl0bGVkLnR4dCcgPyAndW50aXRsZWQudHh0JyA6IHRleHRFZGl0b3IuZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKSwNCiAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgc2VsZWN0ZWQgZm9yIHNhdmluZyBhczonLCBzZWxlY3RlZFBhdGgpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgc2VsZWN0aW9uIGNhbmNlbGxlZCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGUoZmlsZVBhdGgsIGNvbnRlbnQpOw0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci5maWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgbWFya0FzU2F2ZWQoKTsNCiAgICAgICAgDQogICAgICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBzYXZlZCBmaWxlDQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgICAgICANCiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIGhpZ2hsaWdodGVkIGNvbnRlbnQgaWYgaGlnaGxpZ2h0aW5nIGlzIGVuYWJsZWQNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZpbGUgc2F2ZWQgYXM6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgZmlsZSBhczonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gc2F2ZSBmaWxlIGFzOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBUb2dnbGUgd29yZCB3cmFwDQpmdW5jdGlvbiB0b2dnbGVXb3JkV3JhcCgpIHsNCiAgICB0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCA9ICF0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZDsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmNsYXNzTGlzdC50b2dnbGUoJ3dvcmQtd3JhcCcsIHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkKTsNCiAgICANCiAgICAvLyBVcGRhdGUgaGlnaGxpZ2h0ZWQgZWRpdG9yIGlmIGl0IGV4aXN0cw0KICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3Iuc3R5bGUud29yZFdyYXAgPSB0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCA/ICdicmVhay13b3JkJyA6ICdub3JtYWwnOw0KICAgIH0NCiAgICANCiAgICBpZiAod29yZFdyYXBUb2dnbGUpIHsNCiAgICAgICAgd29yZFdyYXBUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQpOw0KICAgIH0NCiAgICANCiAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbigNCiAgICAgICAgYFdvcmQgd3JhcCAke3RleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gLA0KICAgICAgICAnaW5mbycNCiAgICApOw0KfQ0KDQovLyBUb2dnbGUgbGluZSBudW1iZXJzDQpmdW5jdGlvbiB0b2dnbGVMaW5lTnVtYmVycygpIHsNCiAgICB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCA9ICF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZDsNCiAgICB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicsICF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCk7DQogICAgDQogICAgaWYgKGxpbmVOdW1iZXJzVG9nZ2xlKSB7DQogICAgICAgIGxpbmVOdW1iZXJzVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKTsNCiAgICB9DQogICAgDQogICAgaWYgKHRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKSB7DQogICAgICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgfQ0KICAgIA0KICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKA0KICAgICAgICBgTGluZSBudW1iZXJzICR7dGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCi8vIFRvZ2dsZSBzeW50YXggaGlnaGxpZ2h0aW5nDQphc3luYyBmdW5jdGlvbiB0b2dnbGVTeW50YXhIaWdobGlnaHRpbmcoKSB7DQogICAgdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcgPSAhdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmc7DQogICAgDQogICAgLy8gU2F2ZSBzZXR0aW5nDQogICAgdHJ5IHsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLnNldFNldHRpbmcoJ1NZTlRBWF9ISUdITElHSFRJTkcnLCB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgc3ludGF4IGhpZ2hsaWdodGluZyBzZXR0aW5nOicsIGVycm9yKTsNCiAgICB9DQogICAgDQogICAgLy8gVXBkYXRlIFVJDQogICAgaWYgKHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZSkgew0KICAgICAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpOw0KICAgIH0NCiAgICANCiAgICAvLyBBcHBseSBvciBkaXNhYmxlIGhpZ2hsaWdodGluZw0KICAgIGlmICh0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZykgew0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBEaXNhYmxlIGhpZ2hsaWdodGluZw0KICAgICAgICBjbGVhbnVwSGlnaGxpZ2h0ZWRFZGl0b3IoKTsNCiAgICAgICAgdGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkID0gZmFsc2U7DQogICAgfQ0KICAgIA0KICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKA0KICAgICAgICBgU3ludGF4IGhpZ2hsaWdodGluZyAke3RleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gLA0KICAgICAgICAnaW5mbycNCiAgICApOw0KfQ0KDQovLyBUb2dnbGUgY29kZSB2YWxpZGF0aW9uDQphc3luYyBmdW5jdGlvbiB0b2dnbGVWYWxpZGF0aW9uKCkgew0KICAgIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQgPSAhdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZDsNCiAgICANCiAgICAvLyBTYXZlIHNldHRpbmcNCiAgICB0cnkgew0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZygnQ09ERV9WQUxJREFUSU9OJywgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgdmFsaWRhdGlvbiBzZXR0aW5nOicsIGVycm9yKTsNCiAgICB9DQogICAgDQogICAgLy8gVXBkYXRlIFVJDQogICAgaWYgKHZhbGlkYXRpb25Ub2dnbGUpIHsNCiAgICAgICAgdmFsaWRhdGlvblRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKTsNCiAgICB9DQogICAgDQogICAgLy8gQXBwbHkgdmFsaWRhdGlvbiBpZiBlbmFibGVkLCBvdGhlcndpc2UgY2xlYXIgZXJyb3JzDQogICAgaWYgKHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpIHsNCiAgICAgICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICAgICAgdXBkYXRlRXJyb3JDb3VudCgwKTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBDb2RlIHZhbGlkYXRpb24gJHt0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gLA0KICAgICAgICAnaW5mbycNCiAgICApOw0KfQ0KDQoNCg0KLy8gSGFuZGxlIGtleWJvYXJkIHNob3J0Y3V0cw0KZnVuY3Rpb24gaGFuZGxlS2V5RG93bihlKSB7DQogICAgLy8gQ3RybC9DbWQgKyBTOiBTYXZlDQogICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ3MnICYmICFlLnNoaWZ0S2V5KSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgc2F2ZUZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBTaGlmdCArIFM6IFNhdmUgQXMNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS5rZXkgPT09ICdTJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHNhdmVBc0ZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBOOiBOZXcgZmlsZQ0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICduJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNyZWF0ZU5ld0ZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBPOiBMb2FkIGZpbGUNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnbycpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBsb2FkRmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgVjogRm9yY2UgdmFsaWRhdGlvbg0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmtleSA9PT0gJ1YnKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgY29uc29sZS5sb2coJ/CflI0gTWFudWFsIHZhbGlkYXRpb24gdHJpZ2dlcmVkJyk7DQogICAgICAgIGlmIChpc1B5dGhvbkZpbGUodGV4dEVkaXRvci5maWxlUGF0aCkpIHsNCiAgICAgICAgICAgIHNjaGVkdWxlVmFsaWRhdGlvbigpOw0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ1ZhbGlkYXRpb24gdHJpZ2dlcmVkIG1hbnVhbGx5JywgJ2luZm8nKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdOb3QgYSBQeXRob24gZmlsZScsICd3YXJuaW5nJyk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gVGFiIGhhbmRsaW5nDQogICAgaWYgKGUua2V5ID09PSAnVGFiJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNvbnN0IHN0YXJ0ID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDsNCiAgICAgICAgY29uc3QgZW5kID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7DQogICAgICAgIGNvbnN0IHNwYWNlcyA9ICcgJy5yZXBlYXQodGV4dEVkaXRvci5zZXR0aW5ncy50YWJTaXplKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSANCiAgICAgICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUuc3Vic3RyaW5nKDAsIHN0YXJ0KSArIA0KICAgICAgICAgICAgc3BhY2VzICsgDQogICAgICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnN1YnN0cmluZyhlbmQpOw0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uRW5kID0gc3RhcnQgKyBzcGFjZXMubGVuZ3RoOw0KICAgICAgICANCiAgICAgICAgLy8gTWFudWFsbHkgdHJpZ2dlciBjb250ZW50IHVwZGF0ZSBzaW5jZSB3ZSBwcmV2ZW50ZWQgdGhlIGRlZmF1bHQNCiAgICAgICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICAgICAgbWFya0FzTW9kaWZpZWQoKTsNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCkgew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0NCiAgICAgICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQogICAgfQ0KfQ0KDQovLyBTdGFydCBhdXRvLXNhdmUNCmZ1bmN0aW9uIHN0YXJ0QXV0b1NhdmUoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCkgew0KICAgICAgICBjbGVhckludGVydmFsKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCk7DQogICAgfQ0KICAgIA0KICAgIHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCAmJiB0ZXh0RWRpdG9yLmZpbGVQYXRoICYmIHRleHRFZGl0b3IuZmlsZVBhdGggIT09ICcvdW50aXRsZWQudHh0Jykgew0KICAgICAgICAgICAgc2F2ZUZpbGUoKTsNCiAgICAgICAgfQ0KICAgIH0sIHRleHRFZGl0b3Iuc2V0dGluZ3MuYXV0b1NhdmVJbnRlcnZhbCAqIDEwMDApOw0KICAgIA0KICAgIGNvbnNvbGUubG9nKGBBdXRvLXNhdmUgZW5hYmxlZCBldmVyeSAke3RleHRFZGl0b3Iuc2V0dGluZ3MuYXV0b1NhdmVJbnRlcnZhbH0gc2Vjb25kc2ApOw0KfQ0KDQovLyBTdG9wIGF1dG8tc2F2ZQ0KZnVuY3Rpb24gc3RvcEF1dG9TYXZlKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpIHsNCiAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpOw0KICAgICAgICB0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwgPSBudWxsOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIGJlZm9yZSB1bmxvYWQNCmZ1bmN0aW9uIGhhbmRsZUJlZm9yZVVubG9hZChlKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUucmV0dXJuVmFsdWUgPSAnWW91IGhhdmUgdW5zYXZlZCBjaGFuZ2VzLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gbGVhdmU/JzsNCiAgICAgICAgcmV0dXJuIGUucmV0dXJuVmFsdWU7DQogICAgfQ0KfQ0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRUZXh0RWRpdG9yKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdFRleHRFZGl0b3IoKTsNCn0NCg0KY29uc29sZS5sb2coJ1RleHQgRWRpdG9yIHNjcmlwdCBsb2FkZWQnKTsNCmNvbnNvbGUubG9nKCc9PT0gVEVYVCBFRElUT1IgREVCVUcgSU5GTyA9PT0nKTsNCmNvbnNvbGUubG9nKCdEb2N1bWVudCByZWFkeSBzdGF0ZTonLCBkb2N1bWVudC5yZWFkeVN0YXRlKTsNCmNvbnNvbGUubG9nKCdEb2N1bWVudCBib2R5IGV4aXN0czonLCAhIWRvY3VtZW50LmJvZHkpOw0KY29uc29sZS5sb2coJ1dpbmRvdyBzeXBuZXhBUEkgdHlwZTonLCB0eXBlb2Ygd2luZG93LnN5cG5leEFQSSk7DQpjb25zb2xlLmxvZygnR2xvYmFsIHN5cG5leEFQSSB0eXBlOicsIHR5cGVvZiBzeXBuZXhBUEkpOw0KY29uc29sZS5sb2coJ0FwcCBjb250YWluZXIgZXhpc3RzOicsICEhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcC1jb250YWluZXInKSk7DQpjb25zb2xlLmxvZygnVGV4dCBlZGl0b3IgdGV4dGFyZWEgZXhpc3RzOicsICEhZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RleHQtZWRpdG9yJykpOw0KY29uc29sZS5sb2coJ0xpbmUgbnVtYmVycyBleGlzdHM6JywgISFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1udW1iZXJzJykpOw0KY29uc29sZS5sb2coJz09PSBFTkQgREVCVUcgSU5GTyA9PT0nKTsNCg0KLy8gPT09PT0gSU5URUdSQVRFRCBURVJNSU5BTCBGVU5DVElPTkFMSVRZID09PT09DQoNCi8vIFRlcm1pbmFsIHZhcmlhYmxlcw0KbGV0IHRlcm1pbmFsVG9nZ2xlLCBpbnRlZ3JhdGVkVGVybWluYWwsIHRlcm1pbmFsT3V0cHV0LCB0ZXJtaW5hbElucHV0LCB0ZXJtaW5hbFJlc2l6ZTsNCmxldCB0ZXJtaW5hbEhpc3RvcnkgPSBbXTsNCmxldCB0ZXJtaW5hbEhpc3RvcnlJbmRleCA9IC0xOw0KbGV0IHRlcm1pbmFsU29ja2V0ID0gbnVsbDsNCg0KLy8gSW5pdGlhbGl6ZSB0ZXJtaW5hbCBmdW5jdGlvbmFsaXR5DQpmdW5jdGlvbiBpbml0SW50ZWdyYXRlZFRlcm1pbmFsKCkgew0KICAgIGNvbnNvbGUubG9nKCdJbml0aWFsaXppbmcgaW50ZWdyYXRlZCB0ZXJtaW5hbC4uLicpOw0KICAgIA0KICAgIC8vIEdldCB0ZXJtaW5hbCBET00gZWxlbWVudHMNCiAgICB0ZXJtaW5hbFRvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXJtaW5hbC10b2dnbGUnKTsNCiAgICBpbnRlZ3JhdGVkVGVybWluYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW50ZWdyYXRlZC10ZXJtaW5hbCcpOw0KICAgIHRlcm1pbmFsT3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlcm1pbmFsT3V0cHV0Jyk7DQogICAgdGVybWluYWxJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXJtaW5hbElucHV0Jyk7DQogICAgdGVybWluYWxSZXNpemUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVybWluYWwtcmVzaXplJyk7DQogICAgDQogICAgaWYgKCF0ZXJtaW5hbFRvZ2dsZSB8fCAhaW50ZWdyYXRlZFRlcm1pbmFsIHx8ICF0ZXJtaW5hbE91dHB1dCB8fCAhdGVybWluYWxJbnB1dCkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdUZXJtaW5hbCBlbGVtZW50cyBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBTZXQgdXAgdGVybWluYWwgZXZlbnQgaGFuZGxlcnMNCiAgICBzZXR1cFRlcm1pbmFsRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIENvbm5lY3QgdG8gV2ViU29ja2V0IGZvciByZWFsLXRpbWUgb3V0cHV0DQogICAgY29ubmVjdFRlcm1pbmFsV2ViU29ja2V0KCk7DQogICAgDQogICAgY29uc29sZS5sb2coJ0ludGVncmF0ZWQgdGVybWluYWwgaW5pdGlhbGl6ZWQnKTsNCn0NCg0KLy8gU2V0IHVwIHRlcm1pbmFsIGV2ZW50IGhhbmRsZXJzDQpmdW5jdGlvbiBzZXR1cFRlcm1pbmFsRXZlbnRIYW5kbGVycygpIHsNCiAgICAvLyBUZXJtaW5hbCB0b2dnbGUgYnV0dG9uDQogICAgdGVybWluYWxUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVUZXJtaW5hbCk7DQogICAgDQogICAgLy8gVGVybWluYWwgaW5wdXQgaGFuZGxpbmcNCiAgICB0ZXJtaW5hbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVUZXJtaW5hbEtleURvd24pOw0KICAgIA0KICAgIC8vIFRlcm1pbmFsIHJlc2l6ZSBmdW5jdGlvbmFsaXR5DQogICAgaWYgKHRlcm1pbmFsUmVzaXplKSB7DQogICAgICAgIHRlcm1pbmFsUmVzaXplLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN0YXJ0VGVybWluYWxSZXNpemUpOw0KICAgIH0NCiAgICANCiAgICAvLyBNYWtlIHRlcm1pbmFsIG91dHB1dCBmb2N1c2FibGUgZm9yIGNvcHkvcGFzdGUNCiAgICB0ZXJtaW5hbE91dHB1dC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTsNCiAgICB0ZXJtaW5hbE91dHB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlVGVybWluYWxPdXRwdXRLZXlEb3duKTsNCn0NCg0KLy8gVG9nZ2xlIHRlcm1pbmFsIHZpc2liaWxpdHkNCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVRlcm1pbmFsKCkgew0KICAgIGNvbnN0IGlzVmlzaWJsZSA9ICFpbnRlZ3JhdGVkVGVybWluYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKTsNCiAgICANCiAgICBpZiAoaXNWaXNpYmxlKSB7DQogICAgICAgIGludGVncmF0ZWRUZXJtaW5hbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsNCiAgICAgICAgdGVybWluYWxUb2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5zZXRTZXR0aW5nKCdURVJNSU5BTF9FTkFCTEVEJywgZmFsc2UpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignVGVybWluYWwgaGlkZGVuJywgJ2luZm8nKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBpbnRlZ3JhdGVkVGVybWluYWwuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7DQogICAgICAgIHRlcm1pbmFsVG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZygnVEVSTUlOQUxfRU5BQkxFRCcsIHRydWUpOw0KICAgICAgICB0ZXJtaW5hbElucHV0LmZvY3VzKCk7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdUZXJtaW5hbCBzaG93bicsICdpbmZvJyk7DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgdGVybWluYWwgaW5wdXQga2V5IGV2ZW50cw0KYXN5bmMgZnVuY3Rpb24gaGFuZGxlVGVybWluYWxLZXlEb3duKGUpIHsNCiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBhd2FpdCBleGVjdXRlVGVybWluYWxDb21tYW5kKCk7DQogICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93VXAnKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgbmF2aWdhdGVUZXJtaW5hbEhpc3RvcnkoLTEpOw0KICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdBcnJvd0Rvd24nKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgbmF2aWdhdGVUZXJtaW5hbEhpc3RvcnkoMSk7DQogICAgfQ0KfQ0KDQovLyBFeGVjdXRlIHRlcm1pbmFsIGNvbW1hbmQNCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVUZXJtaW5hbENvbW1hbmQoKSB7DQogICAgY29uc3QgY29tbWFuZCA9IHRlcm1pbmFsSW5wdXQudmFsdWUudHJpbSgpOw0KICAgIGlmICghY29tbWFuZCkgcmV0dXJuOw0KICAgIA0KICAgIC8vIEFkZCBjb21tYW5kIHRvIG91dHB1dA0KICAgIGFwcGVuZFRlcm1pbmFsT3V0cHV0KGAkICR7Y29tbWFuZH1gLCAndGVybWluYWwtc3VjY2VzcycpOw0KICAgIA0KICAgIC8vIEFkZCB0byBoaXN0b3J5DQogICAgYWRkVG9UZXJtaW5hbEhpc3RvcnkoY29tbWFuZCk7DQogICAgDQogICAgLy8gQ2xlYXIgaW5wdXQNCiAgICB0ZXJtaW5hbElucHV0LnZhbHVlID0gJyc7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgLy8gRXhlY3V0ZSBjb21tYW5kIHZpYSBTeXBuZXhBUEkNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc3lwbmV4QVBJLmV4ZWN1dGVUZXJtaW5hbENvbW1hbmQoY29tbWFuZCk7DQogICAgICAgIA0KICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIGlmIChyZXN1bHQub3V0cHV0KSB7DQogICAgICAgICAgICAgICAgYXBwZW5kVGVybWluYWxPdXRwdXQocmVzdWx0Lm91dHB1dCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGFwcGVuZFRlcm1pbmFsT3V0cHV0KCdDb21tYW5kIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseSAobm8gb3V0cHV0KScsICd0ZXJtaW5hbC1pbmZvJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBhcHBlbmRUZXJtaW5hbE91dHB1dChgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsICd0ZXJtaW5hbC1lcnJvcicpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgYXBwZW5kVGVybWluYWxPdXRwdXQoYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ3Rlcm1pbmFsLWVycm9yJyk7DQogICAgfQ0KICAgIA0KICAgIC8vIEFkZCBlbXB0eSBsaW5lDQogICAgYXBwZW5kVGVybWluYWxPdXRwdXQoJycpOw0KICAgIA0KICAgIC8vIEZvY3VzIGlucHV0IGZvciBuZXh0IGNvbW1hbmQNCiAgICB0ZXJtaW5hbElucHV0LmZvY3VzKCk7DQp9DQoNCi8vIEFwcGVuZCBvdXRwdXQgdG8gdGVybWluYWwNCmZ1bmN0aW9uIGFwcGVuZFRlcm1pbmFsT3V0cHV0KHRleHQsIGNsYXNzTmFtZSA9ICcnKSB7DQogICAgY29uc3QgbGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGxpbmUuY2xhc3NOYW1lID0gYHRlcm1pbmFsLWxpbmUgJHtjbGFzc05hbWV9YDsNCiAgICBsaW5lLnRleHRDb250ZW50ID0gdGV4dDsNCiAgICB0ZXJtaW5hbE91dHB1dC5hcHBlbmRDaGlsZChsaW5lKTsNCiAgICANCiAgICAvLyBTY3JvbGwgdG8gYm90dG9tDQogICAgdGVybWluYWxPdXRwdXQuc2Nyb2xsVG9wID0gdGVybWluYWxPdXRwdXQuc2Nyb2xsSGVpZ2h0Ow0KfQ0KDQovLyBBZGQgY29tbWFuZCB0byBoaXN0b3J5DQpmdW5jdGlvbiBhZGRUb1Rlcm1pbmFsSGlzdG9yeShjb21tYW5kKSB7DQogICAgLy8gRG9uJ3QgYWRkIGVtcHR5IGNvbW1hbmRzIG9yIGR1cGxpY2F0ZXMNCiAgICBpZiAoIWNvbW1hbmQudHJpbSgpIHx8ICh0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoID4gMCAmJiB0ZXJtaW5hbEhpc3RvcnlbdGVybWluYWxIaXN0b3J5Lmxlbmd0aCAtIDFdID09PSBjb21tYW5kKSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIHRlcm1pbmFsSGlzdG9yeS5wdXNoKGNvbW1hbmQpOw0KICAgIHRlcm1pbmFsSGlzdG9yeUluZGV4ID0gdGVybWluYWxIaXN0b3J5Lmxlbmd0aDsNCiAgICANCiAgICAvLyBLZWVwIGhpc3Rvcnkgc2l6ZSByZWFzb25hYmxlDQogICAgaWYgKHRlcm1pbmFsSGlzdG9yeS5sZW5ndGggPiA1MCkgew0KICAgICAgICB0ZXJtaW5hbEhpc3Rvcnkuc2hpZnQoKTsNCiAgICAgICAgdGVybWluYWxIaXN0b3J5SW5kZXgtLTsNCiAgICB9DQp9DQoNCi8vIE5hdmlnYXRlIHRlcm1pbmFsIGhpc3RvcnkNCmZ1bmN0aW9uIG5hdmlnYXRlVGVybWluYWxIaXN0b3J5KGRpcmVjdGlvbikgew0KICAgIGlmICh0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoID09PSAwKSByZXR1cm47DQogICAgDQogICAgaWYgKGRpcmVjdGlvbiA9PT0gLTEpIHsNCiAgICAgICAgLy8gR28gdXAgaW4gaGlzdG9yeQ0KICAgICAgICBpZiAodGVybWluYWxIaXN0b3J5SW5kZXggPiAwKSB7DQogICAgICAgICAgICB0ZXJtaW5hbEhpc3RvcnlJbmRleC0tOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gR28gZG93biBpbiBoaXN0b3J5DQogICAgICAgIGlmICh0ZXJtaW5hbEhpc3RvcnlJbmRleCA8IHRlcm1pbmFsSGlzdG9yeS5sZW5ndGggLSAxKSB7DQogICAgICAgICAgICB0ZXJtaW5hbEhpc3RvcnlJbmRleCsrOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGVybWluYWxIaXN0b3J5SW5kZXggPSB0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGlmICh0ZXJtaW5hbEhpc3RvcnlJbmRleCA+PSAwICYmIHRlcm1pbmFsSGlzdG9yeUluZGV4IDwgdGVybWluYWxIaXN0b3J5Lmxlbmd0aCkgew0KICAgICAgICB0ZXJtaW5hbElucHV0LnZhbHVlID0gdGVybWluYWxIaXN0b3J5W3Rlcm1pbmFsSGlzdG9yeUluZGV4XTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB0ZXJtaW5hbElucHV0LnZhbHVlID0gJyc7DQogICAgfQ0KICAgIA0KICAgIC8vIE1vdmUgY3Vyc29yIHRvIGVuZA0KICAgIHRlcm1pbmFsSW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UodGVybWluYWxJbnB1dC52YWx1ZS5sZW5ndGgsIHRlcm1pbmFsSW5wdXQudmFsdWUubGVuZ3RoKTsNCn0NCg0KLy8gSGFuZGxlIHRlcm1pbmFsIG91dHB1dCBrZXlib2FyZCBzaG9ydGN1dHMNCmZ1bmN0aW9uIGhhbmRsZVRlcm1pbmFsT3V0cHV0S2V5RG93bihlKSB7DQogICAgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHsNCiAgICAgICAgaWYgKGUua2V5ID09PSAnYycpIHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsNCiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24udG9TdHJpbmcoKSkgew0KICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHNlbGVjdGlvbi50b1N0cmluZygpKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gQ29weSBhbGwgdGVybWluYWwgb3V0cHV0IGlmIG5vdGhpbmcgaXMgc2VsZWN0ZWQNCiAgICAgICAgICAgICAgICBjb25zdCBhbGxUZXh0ID0gdGVybWluYWxPdXRwdXQuaW5uZXJUZXh0IHx8IHRlcm1pbmFsT3V0cHV0LnRleHRDb250ZW50Ow0KICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGFsbFRleHQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnYScpIHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsNCiAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyh0ZXJtaW5hbE91dHB1dCk7DQogICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7DQogICAgICAgICAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBDb25uZWN0IHRvIFdlYlNvY2tldCBmb3IgcmVhbC10aW1lIHRlcm1pbmFsIG91dHB1dA0KYXN5bmMgZnVuY3Rpb24gY29ubmVjdFRlcm1pbmFsV2ViU29ja2V0KCkgew0KICAgIHRyeSB7DQogICAgICAgIC8vIENvbm5lY3QgdG8gV2ViU29ja2V0DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5jb25uZWN0U29ja2V0KCk7DQogICAgICAgIA0KICAgICAgICAvLyBKb2luIHRlcm1pbmFsIHJvb20NCiAgICAgICAgc3lwbmV4QVBJLmpvaW5Sb29tKCd0ZXJtaW5hbCcpOw0KICAgICAgICANCiAgICAgICAgLy8gTGlzdGVuIGZvciB0ZXJtaW5hbCBvdXRwdXQNCiAgICAgICAgc3lwbmV4QVBJLm9uKCd0ZXJtaW5hbF9vdXRwdXQnLCAoZGF0YSkgPT4gew0KICAgICAgICAgICAgaGFuZGxlVGVybWluYWxXZWJTb2NrZXRPdXRwdXQoZGF0YSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgY29uc29sZS5sb2coJ1Rlcm1pbmFsIFdlYlNvY2tldCBjb25uZWN0ZWQnKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCB0ZXJtaW5hbCBXZWJTb2NrZXQ6JywgZXJyb3IpOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIFdlYlNvY2tldCB0ZXJtaW5hbCBvdXRwdXQNCmZ1bmN0aW9uIGhhbmRsZVRlcm1pbmFsV2ViU29ja2V0T3V0cHV0KGRhdGEpIHsNCiAgICBjb25zdCB7IG91dHB1dCwgdHlwZSB9ID0gZGF0YTsNCiAgICANCiAgICAvLyBEZXRlcm1pbmUgb3V0cHV0IGNsYXNzIGJhc2VkIG9uIHR5cGUNCiAgICBsZXQgY2xhc3NOYW1lID0gJyc7DQogICAgaWYgKHR5cGUgPT09ICdzdGRlcnInKSB7DQogICAgICAgIGNsYXNzTmFtZSA9ICd0ZXJtaW5hbC1lcnJvcic7DQogICAgfSBlbHNlIGlmICh0eXBlID09PSAnY29tcGxldGlvbicpIHsNCiAgICAgICAgY2xhc3NOYW1lID0gJ3Rlcm1pbmFsLWluZm8nOw0KICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2Vycm9yJykgew0KICAgICAgICBjbGFzc05hbWUgPSAndGVybWluYWwtZXJyb3InOw0KICAgIH0NCiAgICANCiAgICAvLyBBcHBlbmQgdGhlIG91dHB1dA0KICAgIGFwcGVuZFRlcm1pbmFsT3V0cHV0KG91dHB1dCwgY2xhc3NOYW1lKTsNCn0NCg0KLy8gVGVybWluYWwgcmVzaXplIGZ1bmN0aW9uYWxpdHkNCmZ1bmN0aW9uIHN0YXJ0VGVybWluYWxSZXNpemUoZSkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICANCiAgICBjb25zdCBzdGFydFkgPSBlLmNsaWVudFk7DQogICAgY29uc3Qgc3RhcnRIZWlnaHQgPSBpbnRlZ3JhdGVkVGVybWluYWwub2Zmc2V0SGVpZ2h0Ow0KICAgIA0KICAgIGZ1bmN0aW9uIG9uTW91c2VNb3ZlKGUpIHsNCiAgICAgICAgY29uc3QgZGVsdGFZID0gZS5jbGllbnRZIC0gc3RhcnRZOw0KICAgICAgICBjb25zdCBuZXdIZWlnaHQgPSBNYXRoLm1heCgyMDAsIE1hdGgubWluKDYwMCwgc3RhcnRIZWlnaHQgKyBkZWx0YVkpKTsNCiAgICAgICAgaW50ZWdyYXRlZFRlcm1pbmFsLnN0eWxlLmhlaWdodCA9IG5ld0hlaWdodCArICdweCc7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIG9uTW91c2VVcCgpIHsNCiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpOw0KICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTsNCiAgICB9DQogICAgDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApOw0KfQ0KDQovLyBJbml0aWFsaXplIHRlcm1pbmFsIHdoZW4gdGV4dCBlZGl0b3IgaXMgcmVhZHkNCmZ1bmN0aW9uIGluaXRUZXh0RWRpdG9yV2l0aFRlcm1pbmFsKCkgew0KICAgIGluaXRUZXh0RWRpdG9yKCk7DQogICAgaW5pdEludGVncmF0ZWRUZXJtaW5hbCgpOw0KfQ0KDQovLyBSZXBsYWNlIHRoZSBvcmlnaW5hbCBpbml0VGV4dEVkaXRvciBjYWxsDQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRUZXh0RWRpdG9yV2l0aFRlcm1pbmFsKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdFRleHRFZGl0b3JXaXRoVGVybWluYWwoKTsNCn0gPC9zY3JpcHQ+"
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-07-20T04:42:34.257876",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": "user_apps_dev\\text_editor"
  }
}