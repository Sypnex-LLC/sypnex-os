{
  "app_metadata": {
    "id": "text_editor",
    "name": "Text Editor",
    "description": "A simple text editor for creating and editing text files in the virtual file system",
    "icon": "fas fa-edit",
    "keywords": [
      "text",
      "editor",
      "file",
      "edit",
      "write"
    ],
    "author": "Sypnex OS",
    "version": "1.0.0",
    "type": "user_app",
    "scripts": [
      "main.js"
    ],
    "settings": [
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save content every N seconds (0 = disabled)"
      },
      {
        "key": "FONT_SIZE",
        "name": "Font Size",
        "type": "number",
        "value": 14,
        "description": "Text editor font size in pixels"
      },
      {
        "key": "TAB_SIZE",
        "name": "Tab Size",
        "type": "number",
        "value": 4,
        "description": "Number of spaces for tab indentation"
      },
      {
        "key": "TERMINAL_ENABLED",
        "name": "Integrated Terminal",
        "type": "boolean",
        "value": false,
        "description": "Show integrated terminal by default"
      }
    ]
  },
  "files": {
    "text_editor.app": "ew0KICAgICJpZCI6ICJ0ZXh0X2VkaXRvciIsDQogICAgIm5hbWUiOiAiVGV4dCBFZGl0b3IiLA0KICAgICJkZXNjcmlwdGlvbiI6ICJBIHNpbXBsZSB0ZXh0IGVkaXRvciBmb3IgY3JlYXRpbmcgYW5kIGVkaXRpbmcgdGV4dCBmaWxlcyBpbiB0aGUgdmlydHVhbCBmaWxlIHN5c3RlbSIsDQogICAgImljb24iOiAiZmFzIGZhLWVkaXQiLA0KICAgICJrZXl3b3JkcyI6IFsidGV4dCIsICJlZGl0b3IiLCAiZmlsZSIsICJlZGl0IiwgIndyaXRlIl0sDQogICAgImF1dGhvciI6ICJTeXBuZXggT1MiLA0KICAgICJ2ZXJzaW9uIjogIjEuMC4wIiwNCiAgICAidHlwZSI6ICJ1c2VyX2FwcCIsDQogICAgInNjcmlwdHMiOiBbDQogICAgICAgICJtYWluLmpzIg0KICAgIF0sDQogICAgInNldHRpbmdzIjogWw0KICAgICAgICB7DQogICAgICAgICAgICAia2V5IjogIkFVVE9fU0FWRV9JTlRFUlZBTCIsDQogICAgICAgICAgICAibmFtZSI6ICJBdXRvIFNhdmUgSW50ZXJ2YWwgKHMpIiwNCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgICAidmFsdWUiOiAzMCwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBdXRvIHNhdmUgY29udGVudCBldmVyeSBOIHNlY29uZHMgKDAgPSBkaXNhYmxlZCkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJrZXkiOiAiRk9OVF9TSVpFIiwNCiAgICAgICAgICAgICJuYW1lIjogIkZvbnQgU2l6ZSIsDQogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICAgInZhbHVlIjogMTQsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVGV4dCBlZGl0b3IgZm9udCBzaXplIGluIHBpeGVscyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgImtleSI6ICJUQUJfU0laRSIsDQogICAgICAgICAgICAibmFtZSI6ICJUYWIgU2l6ZSIsDQogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICAgInZhbHVlIjogNCwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2Ygc3BhY2VzIGZvciB0YWIgaW5kZW50YXRpb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJrZXkiOiAiVEVSTUlOQUxfRU5BQkxFRCIsDQogICAgICAgICAgICAibmFtZSI6ICJJbnRlZ3JhdGVkIFRlcm1pbmFsIiwNCiAgICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iLA0KICAgICAgICAgICAgInZhbHVlIjogZmFsc2UsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiU2hvdyBpbnRlZ3JhdGVkIHRlcm1pbmFsIGJ5IGRlZmF1bHQiDQogICAgICAgIH0NCiAgICBdDQp9IA==",
    "text_editor.html": "PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciI+DQogICAgPGRpdiBjbGFzcz0iYXBwLWhlYWRlciI+DQogICAgICAgIDxoMj48aSBjbGFzcz0iZmFzIGZhLWVkaXQiPjwvaT4gVGV4dCBFZGl0b3IgLSA8c3BhbiBpZD0iY3VycmVudC1maWxlbmFtZSI+dW50aXRsZWQudHh0PC9zcGFuPjwvaDI+DQogICAgICAgIDxwPkNyZWF0ZSBhbmQgZWRpdCB0ZXh0IGZpbGVzIGluIHRoZSB2aXJ0dWFsIGZpbGUgc3lzdGVtPC9wPg0KICAgIDwvZGl2Pg0KDQogICAgPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtdG9vbGJhciI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJuZXctZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPiBOZXcNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJsb2FkLWZpbGUiIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNhdmUtZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2F2ZS1hcy1maWxlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZSBBcw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICANCg0KICAgICAgICAgICAgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ3b3JkLXdyYXAtdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRleHQtd2lkdGgiPjwvaT4gV29yZCBXcmFwDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ibGluZS1udW1iZXJzLXRvZ2dsZSIgY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1saXN0LW9sIj48L2k+IExpbmUgTnVtYmVycw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InN5bnRheC1oaWdobGlnaHRpbmctdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNvZGUiPjwvaT4gU3ludGF4IEhpZ2hsaWdodGluZw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InRlcm1pbmFsLXRvZ2dsZSIgY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS10ZXJtaW5hbCI+PC9pPiBUZXJtaW5hbA0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIDwvZGl2Pg0KDQogICAgICAgIDxkaXYgY2xhc3M9ImVkaXRvci1jb250YWluZXIiPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZWRpdG9yLXdyYXBwZXIiPg0KICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImxpbmUtbnVtYmVycyIgY2xhc3M9ImxpbmUtbnVtYmVycyI+PC9kaXY+DQogICAgICAgICAgICAgICAgPHRleHRhcmVhIGlkPSJ0ZXh0LWVkaXRvciIgY2xhc3M9ImFwcC10ZXh0YXJlYSIgcGxhY2Vob2xkZXI9IlN0YXJ0IHR5cGluZyB5b3VyIHRleHQgaGVyZS4uLiI+PC90ZXh0YXJlYT4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8IS0tIEludGVncmF0ZWQgVGVybWluYWwgLS0+DQogICAgICAgIDxkaXYgaWQ9ImludGVncmF0ZWQtdGVybWluYWwiIGNsYXNzPSJpbnRlZ3JhdGVkLXRlcm1pbmFsIGhpZGRlbiI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXJtaW5hbC1oZWFkZXIiPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0ZXJtaW5hbC10aXRsZSI+SW50ZWdyYXRlZCBUZXJtaW5hbDwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ0ZXJtaW5hbC1yZXNpemUiIGNsYXNzPSJ0ZXJtaW5hbC1yZXNpemUtYnRuIj4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1ncmlwLWxpbmVzIj48L2k+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsLW91dHB1dCIgaWQ9InRlcm1pbmFsT3V0cHV0Ij4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXJtaW5hbC1saW5lIHRlcm1pbmFsLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICBJbnRlZ3JhdGVkIFRlcm1pbmFsIC0gVHlwZSBjb21tYW5kcyB0byBleGVjdXRlDQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGVybWluYWwtbGluZSI+PC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsLWlucHV0LWNvbnRhaW5lciI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGVybWluYWwtaW5wdXQtbGluZSI+DQogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0ZXJtaW5hbC1wcm9tcHQiPiQ8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0idGVybWluYWwtaW5wdXQiIGlkPSJ0ZXJtaW5hbElucHV0IiBwbGFjZWhvbGRlcj0iRW50ZXIgY29tbWFuZC4uLiIgYXV0b2NvbXBsZXRlPSJvZmYiPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIDwvZGl2Pg0KDQogICAgICAgIDxkaXYgY2xhc3M9ImVkaXRvci1zdGF0dXMiPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdHVzLWl0ZW0iPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzdGF0dXMtbGFiZWwiPk1vZGlmaWVkOjwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdHVzLXZhbHVlIiBpZD0ibW9kaWZpZWQtc3RhdHVzIj5Obzwvc3Bhbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCjwvZGl2PiANCjxzdHlsZT4vKiA9PT09PSBTdHlsZTogc3R5bGUuY3NzID09PT09ICovDQovKiBUZXh0IEVkaXRvciBBcHAgU3R5bGVzICovDQoNCi8qIEFwcCBDb250YWluZXIgKi8NCi5hcHAtY29udGFpbmVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIG1pbi1oZWlnaHQ6IDA7DQp9DQoNCi5hcHAtY29udGVudCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGZsZXg6IDE7DQogICAgbWluLWhlaWdodDogMDsNCn0NCg0KLyogRWRpdG9yIENvbnRhaW5lciAqLw0KLmVkaXRvci1jb250YWluZXIgew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBtYXJnaW46IDE1cHggMDsNCiAgICBtaW4taGVpZ2h0OiAyMDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQp9DQoNCi5lZGl0b3Itd3JhcHBlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4OiAxOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBoZWlnaHQ6IDEwMCU7DQp9DQoNCi8qIExpbmUgTnVtYmVycyAqLw0KLmxpbmUtbnVtYmVycyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgcGFkZGluZzogMTBweCA4cHg7DQogICAgZm9udC1mYW1pbHk6ICdTRiBNb25vJywgTW9uYWNvLCAnQ2FzY2FkaWEgQ29kZScsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IHJpZ2h0Ow0KICAgIG1pbi13aWR0aDogNTBweDsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBoaWRkZW47DQogICAgbGluZS1oZWlnaHQ6IDEuNjsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLmxpbmUtbnVtYmVycy5oaWRkZW4gew0KICAgIGRpc3BsYXk6IG5vbmU7DQp9DQoNCi5saW5lLW51bWJlciB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgcGFkZGluZzogMCA0cHg7DQp9DQoNCi8qIFRleHQgRWRpdG9yICovDQojdGV4dC1lZGl0b3Igew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtZmFtaWx5OiAnU0YgTW9ubycsIE1vbmFjbywgJ0Nhc2NhZGlhIENvZGUnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjY7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIHJlc2l6ZTogbm9uZTsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KfQ0KDQojdGV4dC1lZGl0b3Iud29yZC13cmFwIHsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQojdGV4dC1lZGl0b3I6OnBsYWNlaG9sZGVyIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQp9DQoNCi8qIFN5bnRheCBIaWdobGlnaHRpbmcgRWRpdG9yICovDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KICAgIHBhZGRpbmc6IDEwcHggMTVweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvcjpmb2N1cyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQp9DQoNCi8qIFByaXNtLmpzIFRoZW1lIE92ZXJyaWRlcyBmb3IgYmV0dGVyIGludGVncmF0aW9uICovDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jb21tZW50LA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHJvbG9nLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZG9jdHlwZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNkYXRhIHsNCiAgICBjb2xvcjogIzZhNzM3ZDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHVuY3R1YXRpb24gew0KICAgIGNvbG9yOiAjZTFlNGU4Ow0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5wcm9wZXJ0eSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnRhZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmJvb2xlYW4sDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5udW1iZXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jb25zdGFudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnN5bWJvbCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmRlbGV0ZWQgew0KICAgIGNvbG9yOiAjNzliOGZmOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5zZWxlY3RvciwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0dHItbmFtZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnN0cmluZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNoYXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5idWlsdGluLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaW5zZXJ0ZWQgew0KICAgIGNvbG9yOiAjODVlODlkOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5vcGVyYXRvciwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmVudGl0eSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnVybCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLmxhbmd1YWdlLWNzcyAudG9rZW4uc3RyaW5nLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAuc3R5bGUgLnRva2VuLnN0cmluZyB7DQogICAgY29sb3I6ICNmOTc1ODM7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0cnVsZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0dHItdmFsdWUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5rZXl3b3JkIHsNCiAgICBjb2xvcjogI2Y5NzU4MzsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZnVuY3Rpb24sDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jbGFzcy1uYW1lIHsNCiAgICBjb2xvcjogI2IzOTJmMDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucmVnZXgsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pbXBvcnRhbnQsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi52YXJpYWJsZSB7DQogICAgY29sb3I6ICNmZmFiNzA7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmltcG9ydGFudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmJvbGQgew0KICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pdGFsaWMgew0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZW50aXR5IHsNCiAgICBjdXJzb3I6IGhlbHA7DQp9DQoNCi8qIEVkaXRvciBTdGF0dXMgQmFyICovDQouZWRpdG9yLXN0YXR1cyB7DQogICAgZGlzcGxheTogbm9uZTsgLyogSGlkZGVuIGZvciBub3cgdG8gc2F2ZSBzY3JlZW4gcmVhbCBlc3RhdGUgKi8NCiAgICBnYXA6IDIwcHg7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLnN0YXR1cy1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogNXB4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5zdGF0dXMtbGFiZWwgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQp9DQoNCi5zdGF0dXMtdmFsdWUgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi8qIEZpbGUgUGF0aCBEaXNwbGF5ICovDQouZmlsZS1wYXRoLWRpc3BsYXkgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgbWluLXdpZHRoOiAyMDBweDsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQp9DQoNCi8qIEludGVncmF0ZWQgVGVybWluYWwgU3R5bGVzICovDQouaW50ZWdyYXRlZC10ZXJtaW5hbCB7DQogICAgYmFja2dyb3VuZDogIzFlMWUxZTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweCA2cHggMCAwOyAvKiBSb3VuZGVkIHRvcCBjb3JuZXJzIG9ubHkgKi8NCiAgICBtYXJnaW46IDEwcHggMCAwIDA7IC8qIE5vIGJvdHRvbSBtYXJnaW4gdG8gc2l0IGZsdXNoICovDQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG1pbi1oZWlnaHQ6IDIwMHB4Ow0KICAgIG1heC1oZWlnaHQ6IDQwMHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5pbnRlZ3JhdGVkLXRlcm1pbmFsLmhpZGRlbiB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLnRlcm1pbmFsLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBiYWNrZ3JvdW5kOiAjMmQyZDJkOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjNDQ0Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogI2ZmZmZmZjsNCn0NCg0KLnRlcm1pbmFsLXRpdGxlIHsNCiAgICBmb250LXdlaWdodDogNTAwOw0KfQ0KDQoudGVybWluYWwtcmVzaXplLWJ0biB7DQogICAgYmFja2dyb3VuZDogbm9uZTsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6ICM4ODg7DQogICAgY3Vyc29yOiBucy1yZXNpemU7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCn0NCg0KLnRlcm1pbmFsLXJlc2l6ZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICM0NDQ7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi50ZXJtaW5hbC1vdXRwdXQgew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZC1jb2xvcjogIzFlMWUxZTsNCiAgICBjb2xvcjogI2ZmZmZmZjsNCiAgICBmb250LWZhbWlseTogJ0NvdXJpZXIgTmV3JywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWluLWhlaWdodDogMTAwcHg7DQogICAgbWF4LWhlaWdodDogMjAwcHg7DQp9DQoNCi50ZXJtaW5hbC1saW5lIHsNCiAgICBtYXJnaW46IDFweCAwOw0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgdXNlci1zZWxlY3Q6IHRleHQ7DQogICAgLXdlYmtpdC11c2VyLXNlbGVjdDogdGV4dDsNCiAgICAtbW96LXVzZXItc2VsZWN0OiB0ZXh0Ow0KICAgIC1tcy11c2VyLXNlbGVjdDogdGV4dDsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQoudGVybWluYWwtZXJyb3Igew0KICAgIGNvbG9yOiAjZmY2YjZiOw0KfQ0KDQoudGVybWluYWwtc3VjY2VzcyB7DQogICAgY29sb3I6ICM1MWNmNjY7DQp9DQoNCi50ZXJtaW5hbC1pbmZvIHsNCiAgICBjb2xvcjogIzc0YzBmYzsNCn0NCg0KLnRlcm1pbmFsLWlucHV0LWNvbnRhaW5lciB7DQogICAgYmFja2dyb3VuZDogIzFlMWUxZTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgIzQ0NDsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCn0NCg0KLnRlcm1pbmFsLWlucHV0LWxpbmUgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6ICNmZmZmZmY7DQogICAgZm9udC1mYW1pbHk6ICdDb3VyaWVyIE5ldycsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLnRlcm1pbmFsLXByb21wdCB7DQogICAgY29sb3I6ICMwMGZmMDA7DQogICAgbWFyZ2luLXJpZ2h0OiA4cHg7DQogICAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQoNCi50ZXJtaW5hbC1pbnB1dCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgZmxleDogMTsNCn0NCg0KLnRlcm1pbmFsLWlucHV0OjpwbGFjZWhvbGRlciB7DQogICAgY29sb3I6ICM2NjY7DQp9DQoNCi8qIFRlcm1pbmFsIHNlbGVjdGlvbiBzdHlsaW5nICovDQoudGVybWluYWwtb3V0cHV0OjpzZWxlY3Rpb24gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDY2Y2M7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi50ZXJtaW5hbC1vdXRwdXQ6Oi1tb3otc2VsZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA2NmNjOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KfQ0KDQoudGVybWluYWwtbGluZTo6c2VsZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA2NmNjOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KfQ0KDQoudGVybWluYWwtbGluZTo6LW1vei1zZWxlY3Rpb24gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDY2Y2M7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLXRvb2xiYXIgew0KICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgfQ0KICAgIA0KICAgIC5hcHAtYnRuLWdyb3VwIHsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgfQ0KICAgIA0KICAgIC5lZGl0b3Itc3RhdHVzIHsNCiAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgfQ0KICAgIA0KICAgIC5saW5lLW51bWJlcnMgew0KICAgICAgICBtaW4td2lkdGg6IDQwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICB9DQogICAgDQogICAgI3RleHQtZWRpdG9yLA0KICAgIC5oaWdobGlnaHRlZC1lZGl0b3Igew0KICAgICAgICBmb250LXNpemU6IDEzcHg7DQogICAgfQ0KICAgIA0KICAgIC5pbnRlZ3JhdGVkLXRlcm1pbmFsIHsNCiAgICAgICAgbWluLWhlaWdodDogMTUwcHg7DQogICAgICAgIG1heC1oZWlnaHQ6IDMwMHB4Ow0KICAgIH0NCiAgICANCiAgICAudGVybWluYWwtb3V0cHV0IHsNCiAgICAgICAgZm9udC1zaXplOiAxMXB4Ow0KICAgICAgICBtaW4taGVpZ2h0OiA4MHB4Ow0KICAgICAgICBtYXgtaGVpZ2h0OiAxNTBweDsNCiAgICB9DQogICAgDQogICAgLnRlcm1pbmFsLWlucHV0IHsNCiAgICAgICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIH0NCn0NCg0KLyogRm9jdXMgU3RhdGVzICovDQojdGV4dC1lZGl0b3I6Zm9jdXMgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KfQ0KDQovKiBTY3JvbGxiYXIgU3R5bGluZyAqLw0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhciwNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXIgew0KICAgIHdpZHRoOiA4cHg7DQogICAgaGVpZ2h0OiA4cHg7DQp9DQoNCiN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2ssDQoubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhci10cmFjaywNCi5oaWdobGlnaHRlZC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQp9DQoNCiN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIsDQoubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiwNCi5oaWdobGlnaHRlZC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCg0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciwNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQp9DQoNCi8qIEFwcCBUb29sYmFyICovDQouYXBwLXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgZmxleC1zaHJpbms6IDA7DQp9DQoNCi5hcHAtYnRuLWdyb3VwIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogMTBweDsNCn0NCg0KLyogQW5pbWF0aW9uIGZvciBzdGF0dXMgY2hhbmdlcyAqLw0KLnN0YXR1cy12YWx1ZSB7DQogICAgdHJhbnNpdGlvbjogY29sb3IgMC4ycyBlYXNlOw0KfQ0KDQovKiBNb2RpZmllZCBzdGF0dXMgaW5kaWNhdG9yICovDQouc3RhdHVzLXZhbHVlLm1vZGlmaWVkIHsNCiAgICBjb2xvcjogI2ZmOTgwMDsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlOw0KfQ0KDQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAwJSB7IG9wYWNpdHk6IDE7IH0NCiAgICA1MCUgeyBvcGFjaXR5OiAwLjc7IH0NCiAgICAxMDAlIHsgb3BhY2l0eTogMTsgfQ0KfSA8L3N0eWxlPg0KPHNjcmlwdD4vLyA9PT09PSBTY3JpcHQ6IG1haW4uanMgPT09PT0NCg0KDQovLyBUZXh0IEVkaXRvciBBcHANCmNvbnNvbGUubG9nKCdUZXh0IEVkaXRvciBhcHAgbG9hZGluZy4uLicpOw0KY29uc29sZS5sb2coJ0RvY3VtZW50IHJlYWR5IHN0YXRlOicsIGRvY3VtZW50LnJlYWR5U3RhdGUpOw0KY29uc29sZS5sb2coJ0RvY3VtZW50IGJvZHk6JywgZG9jdW1lbnQuYm9keSk7DQpjb25zb2xlLmxvZygnV2luZG93IHN5cG5leEFQSTonLCB0eXBlb2Ygd2luZG93LnN5cG5leEFQSSk7DQoNCi8vIEdsb2JhbCB2YXJpYWJsZXMNCmxldCB0ZXh0RWRpdG9yID0gew0KICAgIHRleHRhcmVhOiBudWxsLA0KICAgIGxpbmVOdW1iZXJzOiBudWxsLA0KICAgIGZpbGVQYXRoOiBudWxsLA0KICAgIG9yaWdpbmFsQ29udGVudDogJycsDQogICAgaXNNb2RpZmllZDogZmFsc2UsDQogICAgYXV0b1NhdmVJbnRlcnZhbDogbnVsbCwNCiAgICB3b3JkV3JhcEVuYWJsZWQ6IGZhbHNlLA0KICAgIGxpbmVOdW1iZXJzRW5hYmxlZDogdHJ1ZSwNCiAgICBzZXR0aW5nczoge30sDQogICAgLy8gU3ludGF4IGhpZ2hsaWdodGluZw0KICAgIHByaXNtTG9hZGVkOiBmYWxzZSwNCiAgICBzeW50YXhIaWdobGlnaHRpbmdFbmFibGVkOiBmYWxzZSwNCiAgICBoaWdobGlnaHRlZEVkaXRvcjogbnVsbCwNCiAgICBkZWJvdW5jZVRpbWVyOiBudWxsLA0KICAgIC8vIEN1cnNvciBwb3NpdGlvbiB0cmFja2luZw0KICAgIGN1cnNvclBvc2l0aW9uOiAwDQp9Ow0KDQovLyBET00gZWxlbWVudHMNCmxldCBuZXdGaWxlQnRuLCBsb2FkRmlsZUJ0biwgc2F2ZUZpbGVCdG4sIHNhdmVBc0ZpbGVCdG47DQpsZXQgY3VycmVudEZpbGVuYW1lRWwsIHdvcmRXcmFwVG9nZ2xlLCBsaW5lTnVtYmVyc1RvZ2dsZSwgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlOw0KbGV0IG1vZGlmaWVkU3RhdHVzRWw7DQoNCi8vIEluaXRpYWxpemUgd2hlbiBET00gaXMgcmVhZHkNCmZ1bmN0aW9uIGluaXRUZXh0RWRpdG9yKCkgew0KICAgIGNvbnNvbGUubG9nKCdUZXh0IEVkaXRvciBpbml0aWFsaXppbmcuLi4nKTsNCiAgICANCiAgICAvLyBDaGVjayBpZiBTeXBuZXhBUEkgaXMgYXZhaWxhYmxlDQogICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgPT09ICd1bmRlZmluZWQnIHx8ICFzeXBuZXhBUEkpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdTeXBuZXhBUEkgbm90IGF2YWlsYWJsZSAtIHJ1bm5pbmcgaW4gc3RhbmRhbG9uZSBtb2RlJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBjb25zb2xlLmxvZygnU3lwbmV4QVBJIGF2YWlsYWJsZTonLCBzeXBuZXhBUEkpOw0KICAgIGNvbnNvbGUubG9nKCdBcHAgSUQ6Jywgc3lwbmV4QVBJLmdldEFwcElkKCkpOw0KICAgIA0KICAgIC8vIFRlc3QgaWYgYXBwIGNvbnRhaW5lciBleGlzdHMNCiAgICBjb25zdCBhcHBDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwLWNvbnRhaW5lcicpOw0KICAgIGNvbnNvbGUubG9nKCdBcHAgY29udGFpbmVyIGZvdW5kOicsICEhYXBwQ29udGFpbmVyKTsNCiAgICBpZiAoYXBwQ29udGFpbmVyKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdBcHAgY29udGFpbmVyIGNvbnRlbnQ6JywgYXBwQ29udGFpbmVyLmlubmVySFRNTC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nKTsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IERPTSBlbGVtZW50cw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGV4dC1lZGl0b3InKTsNCiAgICB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmUtbnVtYmVycycpOw0KICAgIA0KICAgIG5ld0ZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3LWZpbGUnKTsNCiAgICBsb2FkRmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkLWZpbGUnKTsNCiAgICBzYXZlRmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlLWZpbGUnKTsNCiAgICBzYXZlQXNGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmUtYXMtZmlsZScpOw0KICAgIGN1cnJlbnRGaWxlbmFtZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbnQtZmlsZW5hbWUnKTsNCiAgICB3b3JkV3JhcFRvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3b3JkLXdyYXAtdG9nZ2xlJyk7DQogICAgbGluZU51bWJlcnNUb2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1udW1iZXJzLXRvZ2dsZScpOw0KICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzeW50YXgtaGlnaGxpZ2h0aW5nLXRvZ2dsZScpOw0KICAgIA0KICAgIG1vZGlmaWVkU3RhdHVzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kaWZpZWQtc3RhdHVzJyk7DQogICAgDQogICAgLy8gQ3JpdGljYWwgZWxlbWVudCBjaGVja3MNCiAgICBpZiAoIXRleHRFZGl0b3IudGV4dGFyZWEpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVGV4dCBlZGl0b3IgdGV4dGFyZWEgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgaWYgKCF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xpbmUgbnVtYmVycyBlbGVtZW50IG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnNvbGUubG9nKCdET00gZWxlbWVudHMgZm91bmQ6Jywgew0KICAgICAgICB0ZXh0YXJlYTogISF0ZXh0RWRpdG9yLnRleHRhcmVhLA0KICAgICAgICBsaW5lTnVtYmVyczogISF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzLA0KICAgICAgICBuZXdGaWxlQnRuOiAhIW5ld0ZpbGVCdG4sDQogICAgICAgIGxvYWRGaWxlQnRuOiAhIWxvYWRGaWxlQnRuLA0KICAgICAgICBzYXZlRmlsZUJ0bjogISFzYXZlRmlsZUJ0biwNCiAgICAgICAgc2F2ZUFzRmlsZUJ0bjogISFzYXZlQXNGaWxlQnRuLA0KICAgICAgICBjdXJyZW50RmlsZW5hbWVFbDogISFjdXJyZW50RmlsZW5hbWVFbCwNCiAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlOiAhIXN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZSwNCiAgICAgICAgbW9kaWZpZWRTdGF0dXNFbDogISFtb2RpZmllZFN0YXR1c0VsDQogICAgfSk7DQogICAgDQogICAgLy8gTG9hZCBzZXR0aW5ncw0KICAgIGxvYWRTZXR0aW5ncygpOw0KICAgIA0KICAgIC8vIExvYWQgdGVybWluYWwgc3RhdGUNCiAgICBsb2FkVGVybWluYWxTdGF0ZSgpOw0KICAgIA0KICAgIC8vIFNldCB1cCBldmVudCBoYW5kbGVycw0KICAgIHNldHVwRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgZWRpdG9yIHN0YXRlDQogICAgaW5pdGlhbGl6ZUVkaXRvcigpOw0KICAgIA0KICAgIC8vIFNldCBpbml0aWFsIGJ1dHRvbiBzdGF0ZXMNCiAgICBpZiAoc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlKSB7DQogICAgICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRleHQgRWRpdG9yIGxvYWRlZCBzdWNjZXNzZnVsbHkgKG5vIG5vdGlmaWNhdGlvbiBuZWVkZWQpDQogICAgDQogICAgY29uc29sZS5sb2coJ1RleHQgRWRpdG9yIGluaXRpYWxpemF0aW9uIGNvbXBsZXRlJyk7DQp9DQoNCi8vIExvYWQgYXBwIHNldHRpbmdzDQphc3luYyBmdW5jdGlvbiBsb2FkU2V0dGluZ3MoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgdGV4dEVkaXRvci5zZXR0aW5ncyA9IHsNCiAgICAgICAgICAgIGF1dG9TYXZlSW50ZXJ2YWw6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdBVVRPX1NBVkVfSU5URVJWQUwnLCAzMCksDQogICAgICAgICAgICBmb250U2l6ZTogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ0ZPTlRfU0laRScsIDE0KSwNCiAgICAgICAgICAgIHRhYlNpemU6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdUQUJfU0laRScsIDQpLA0KICAgICAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnU1lOVEFYX0hJR0hMSUdIVElORycsIHRydWUpDQogICAgICAgIH07DQogICAgICAgIA0KICAgICAgICAvLyBBcHBseSBzZXR0aW5ncw0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnN0eWxlLmZvbnRTaXplID0gdGV4dEVkaXRvci5zZXR0aW5ncy5mb250U2l6ZSArICdweCc7DQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc3R5bGUudGFiU2l6ZSA9IHRleHRFZGl0b3Iuc2V0dGluZ3MudGFiU2l6ZTsNCiAgICAgICAgDQogICAgICAgIGNvbnNvbGUubG9nKCdTZXR0aW5ncyBsb2FkZWQ6JywgdGV4dEVkaXRvci5zZXR0aW5ncyk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgc2V0dGluZ3M6JywgZXJyb3IpOw0KICAgICAgICAvLyBVc2UgZGVmYXVsdHMNCiAgICAgICAgdGV4dEVkaXRvci5zZXR0aW5ncyA9IHsNCiAgICAgICAgICAgIGF1dG9TYXZlSW50ZXJ2YWw6IDMwLA0KICAgICAgICAgICAgZm9udFNpemU6IDE0LA0KICAgICAgICAgICAgdGFiU2l6ZTogNCwNCiAgICAgICAgICAgIHN5bnRheEhpZ2hsaWdodGluZzogdHJ1ZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gTG9hZCB0ZXJtaW5hbCBzdGF0ZQ0KYXN5bmMgZnVuY3Rpb24gbG9hZFRlcm1pbmFsU3RhdGUoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdGVybWluYWxFbmFibGVkID0gYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ1RFUk1JTkFMX0VOQUJMRUQnLCBmYWxzZSk7DQogICAgICAgIGlmICh0ZXJtaW5hbEVuYWJsZWQgJiYgaW50ZWdyYXRlZFRlcm1pbmFsKSB7DQogICAgICAgICAgICBpbnRlZ3JhdGVkVGVybWluYWwuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7DQogICAgICAgICAgICBpZiAodGVybWluYWxUb2dnbGUpIHsNCiAgICAgICAgICAgICAgICB0ZXJtaW5hbFRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHRlcm1pbmFsIHN0YXRlOicsIGVycm9yKTsNCiAgICB9DQp9DQoNCi8vIENoZWNrIGlmIGZpbGUgaXMgc3VwcG9ydGVkIGZvciBzeW50YXggaGlnaGxpZ2h0aW5nDQpmdW5jdGlvbiBnZXRGaWxlTGFuZ3VhZ2UoZmlsZVBhdGgpIHsNCiAgICBpZiAoIWZpbGVQYXRoKSByZXR1cm4gbnVsbDsNCiAgICANCiAgICBjb25zdCBleHRlbnNpb24gPSBmaWxlUGF0aC50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZyhmaWxlUGF0aC5sYXN0SW5kZXhPZignLicpKTsNCiAgICANCiAgICBjb25zdCBsYW5ndWFnZU1hcCA9IHsNCiAgICAgICAgJy5weSc6ICdweXRob24nLA0KICAgICAgICAnLnB5dyc6ICdweXRob24nLCANCiAgICAgICAgJy5weXgnOiAncHl0aG9uJywNCiAgICAgICAgJy5weWknOiAncHl0aG9uJywNCiAgICAgICAgJy5weWQnOiAncHl0aG9uJywNCiAgICAgICAgJy5qcyc6ICdqYXZhc2NyaXB0JywNCiAgICAgICAgJy5qc29uJzogJ2pzb24nLA0KICAgICAgICAnLmh0bWwnOiAnaHRtbCcsDQogICAgICAgICcuaHRtJzogJ2h0bWwnLA0KICAgICAgICAnLmNzcyc6ICdjc3MnDQogICAgfTsNCiAgICANCiAgICByZXR1cm4gbGFuZ3VhZ2VNYXBbZXh0ZW5zaW9uXSB8fCBudWxsOw0KfQ0KDQovLyBDaGVjayBpZiBmaWxlIGlzIFB5dGhvbiAoZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpDQpmdW5jdGlvbiBpc1B5dGhvbkZpbGUoZmlsZVBhdGgpIHsNCiAgICByZXR1cm4gZ2V0RmlsZUxhbmd1YWdlKGZpbGVQYXRoKSA9PT0gJ3B5dGhvbic7DQp9DQoNCi8vIExvYWQgUHJpc20uanMgZm9yIHN5bnRheCBoaWdobGlnaHRpbmcNCmFzeW5jIGZ1bmN0aW9uIGxvYWRQcmlzbUpTKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLnByaXNtTG9hZGVkKSByZXR1cm47DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgUHJpc20uanMgZm9yIHN5bnRheCBoaWdobGlnaHRpbmcuLi4nKTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgUHJpc20uanMgbGlicmFyeQ0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9wcmlzbS5taW4uanMnLCB7DQogICAgICAgICAgICBsb2NhbE5hbWU6ICdQcmlzbScNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBMb2FkIGxhbmd1YWdlIGNvbXBvbmVudHMNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1weXRob24ubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tamF2YXNjcmlwdC5taW4uanMnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1qc29uLm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLW1hcmt1cC5taW4uanMnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1jc3MubWluLmpzJyk7DQogICAgICAgIA0KICAgICAgICAvLyBMb2FkIFByaXNtIENTUw0KICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpOw0KICAgICAgICBsaW5rLnJlbCA9ICdzdHlsZXNoZWV0JzsNCiAgICAgICAgbGluay5ocmVmID0gJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC90aGVtZXMvcHJpc20tdG9tb3Jyb3cubWluLmNzcyc7DQogICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobGluayk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnByaXNtTG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgY29uc29sZS5sb2coJ+KchSBQcmlzbS5qcyB3aXRoIGFsbCBsYW5ndWFnZSBncmFtbWFycyBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIFByaXNtLmpzOicsIGVycm9yKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBsb2FkIHN5bnRheCBoaWdobGlnaHRpbmcnLCAnZXJyb3InKTsNCiAgICB9DQp9DQoNCi8vIENyZWF0ZSBoaWdobGlnaHRlZCBlZGl0b3INCmZ1bmN0aW9uIGNyZWF0ZUhpZ2hsaWdodGVkRWRpdG9yKCkgew0KICAgIGlmICghdGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGVkaXRvcldyYXBwZXIgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnBhcmVudEVsZW1lbnQ7DQogICAgY29uc3QgdGV4dGFyZWEgPSB0ZXh0RWRpdG9yLnRleHRhcmVhOw0KICAgIA0KICAgIC8vIENyZWF0ZSBoaWdobGlnaHRlZCBlZGl0b3IgZGl2DQogICAgY29uc3QgaGlnaGxpZ2h0ZWRFZGl0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBoaWdobGlnaHRlZEVkaXRvci5pZCA9ICdoaWdobGlnaHRlZC1lZGl0b3InOw0KICAgIGhpZ2hsaWdodGVkRWRpdG9yLmNsYXNzTmFtZSA9ICdoaWdobGlnaHRlZC1lZGl0b3InOw0KICAgIGhpZ2hsaWdodGVkRWRpdG9yLmNvbnRlbnRFZGl0YWJsZSA9IHRydWU7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3Iuc3BlbGxjaGVjayA9IGZhbHNlOw0KICAgIA0KICAgIC8vIENvcHkgdGV4dGFyZWEgc3R5bGVzDQogICAgaGlnaGxpZ2h0ZWRFZGl0b3Iuc3R5bGUuY3NzVGV4dCA9IHRleHRhcmVhLnN0eWxlLmNzc1RleHQ7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3Iuc3R5bGUuZm9udEZhbWlseSA9ICdtb25vc3BhY2UnOw0KICAgIGhpZ2hsaWdodGVkRWRpdG9yLnN0eWxlLndoaXRlU3BhY2UgPSAncHJlLXdyYXAnOw0KICAgIGhpZ2hsaWdodGVkRWRpdG9yLnN0eWxlLndvcmRXcmFwID0gdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPyAnYnJlYWstd29yZCcgOiAnbm9ybWFsJzsNCiAgICBoaWdobGlnaHRlZEVkaXRvci5zdHlsZS5vdmVyZmxvdyA9ICdhdXRvJzsNCiAgICBoaWdobGlnaHRlZEVkaXRvci5zdHlsZS5yZXNpemUgPSAnbm9uZSc7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3Iuc3R5bGUuYm9yZGVyID0gJ25vbmUnOw0KICAgIGhpZ2hsaWdodGVkRWRpdG9yLnN0eWxlLm91dGxpbmUgPSAnbm9uZSc7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3Iuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3Iuc3R5bGUuY29sb3IgPSAnaW5oZXJpdCc7DQogICAgDQogICAgLy8gSGlkZSBvcmlnaW5hbCB0ZXh0YXJlYQ0KICAgIHRleHRhcmVhLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgDQogICAgLy8gSW5zZXJ0IGhpZ2hsaWdodGVkIGVkaXRvcg0KICAgIGVkaXRvcldyYXBwZXIuaW5zZXJ0QmVmb3JlKGhpZ2hsaWdodGVkRWRpdG9yLCB0ZXh0YXJlYSk7DQogICAgDQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciA9IGhpZ2hsaWdodGVkRWRpdG9yOw0KICAgIA0KICAgIC8vIFNldCBpbml0aWFsIGNvbnRlbnQNCiAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICANCiAgICAvLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMgZm9yIGhpZ2hsaWdodGVkIGVkaXRvcg0KICAgIGhpZ2hsaWdodGVkRWRpdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaGFuZGxlSGlnaGxpZ2h0ZWRJbnB1dCk7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc3luY1Njcm9sbCk7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUhpZ2hsaWdodGVkS2V5RG93bik7DQogICAgaGlnaGxpZ2h0ZWRFZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcigncGFzdGUnLCBoYW5kbGVIaWdobGlnaHRlZFBhc3RlKTsNCiAgICBoaWdobGlnaHRlZEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHVwZGF0ZUN1cnNvclBvc2l0aW9uKTsNCiAgICBoaWdobGlnaHRlZEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHVwZGF0ZUN1cnNvclBvc2l0aW9uKTsNCiAgICBoaWdobGlnaHRlZEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHVwZGF0ZUN1cnNvclBvc2l0aW9uKTsNCiAgICANCiAgICBjb25zb2xlLmxvZygn4pyFIEhpZ2hsaWdodGVkIGVkaXRvciBjcmVhdGVkJyk7DQp9DQoNCi8vIFRyYWNrIGN1cnNvciBwb3NpdGlvbg0KZnVuY3Rpb24gdXBkYXRlQ3Vyc29yUG9zaXRpb24oKSB7DQogICAgY29uc3Qgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOw0KICAgIGlmIChzZWxlY3Rpb24ucmFuZ2VDb3VudCA+IDApIHsNCiAgICAgICAgY29uc3QgcmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTsNCiAgICAgICAgdGV4dEVkaXRvci5jdXJzb3JQb3NpdGlvbiA9IGdldFRleHRPZmZzZXQocmFuZ2Uuc3RhcnRDb250YWluZXIsIHJhbmdlLnN0YXJ0T2Zmc2V0KTsNCiAgICAgICAgLy8gU3luYyB0byB0ZXh0YXJlYQ0KICAgICAgICBzeW5jQ3Vyc29yVG9UZXh0YXJlYSgpOw0KICAgIH0NCn0NCg0KLy8gU3luYyBjdXJzb3IgcG9zaXRpb24gZnJvbSB0ZXh0YXJlYSB0byBoaWdobGlnaHRlZCBlZGl0b3INCmZ1bmN0aW9uIHN5bmNDdXJzb3JGcm9tVGV4dGFyZWEoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSByZXR1cm47DQogICAgDQogICAgY29uc3QgdGV4dGFyZWEgPSB0ZXh0RWRpdG9yLnRleHRhcmVhOw0KICAgIGNvbnN0IGN1cnNvclBvcyA9IHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0Ow0KICAgIHRleHRFZGl0b3IuY3Vyc29yUG9zaXRpb24gPSBjdXJzb3JQb3M7DQogICAgDQogICAgLy8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb24gaW4gaGlnaGxpZ2h0ZWQgZWRpdG9yDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIHJlc3RvcmVDdXJzb3JQb3NpdGlvbigpOw0KICAgIH0sIDApOw0KfQ0KDQovLyBTeW5jIGN1cnNvciBwb3NpdGlvbiBmcm9tIGhpZ2hsaWdodGVkIGVkaXRvciB0byB0ZXh0YXJlYQ0KZnVuY3Rpb24gc3luY0N1cnNvclRvVGV4dGFyZWEoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSByZXR1cm47DQogICAgDQogICAgY29uc3QgdGV4dGFyZWEgPSB0ZXh0RWRpdG9yLnRleHRhcmVhOw0KICAgIHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKHRleHRFZGl0b3IuY3Vyc29yUG9zaXRpb24sIHRleHRFZGl0b3IuY3Vyc29yUG9zaXRpb24pOw0KfQ0KDQovLyBVcGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudA0KZnVuY3Rpb24gdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCkgew0KICAgIGlmICghdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciB8fCAhdGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KICAgIGNvbnN0IGxhbmd1YWdlID0gZ2V0RmlsZUxhbmd1YWdlKHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIA0KICAgIGlmICghbGFuZ3VhZ2UpIHsNCiAgICAgICAgLy8gTm8gbGFuZ3VhZ2UgZGV0ZWN0ZWQsIHVzZSBwbGFpbiB0ZXh0DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IudGV4dENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGhpZ2hsaWdodGVkQ29udGVudCA9IFByaXNtLmhpZ2hsaWdodChjb250ZW50LCBQcmlzbS5sYW5ndWFnZXNbbGFuZ3VhZ2VdLCBsYW5ndWFnZSk7DQogICAgDQogICAgLy8gU3RvcmUgY3VycmVudCBjdXJzb3IgcG9zaXRpb24NCiAgICB1cGRhdGVDdXJzb3JQb3NpdGlvbigpOw0KICAgIA0KICAgIC8vIFN0b3JlIHRoZSBjdXJzb3IgcG9zaXRpb24gYmVmb3JlIERPTSBtYW5pcHVsYXRpb24NCiAgICBjb25zdCBzYXZlZEN1cnNvclBvcyA9IHRleHRFZGl0b3IuY3Vyc29yUG9zaXRpb247DQogICAgDQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5pbm5lckhUTUwgPSBoaWdobGlnaHRlZENvbnRlbnQ7DQogICAgDQogICAgLy8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb24gaW1tZWRpYXRlbHkNCiAgICB0ZXh0RWRpdG9yLmN1cnNvclBvc2l0aW9uID0gc2F2ZWRDdXJzb3JQb3M7DQogICAgcmVzdG9yZUN1cnNvclBvc2l0aW9uKCk7DQp9DQoNCi8vIFJlc3RvcmUgY3Vyc29yIHBvc2l0aW9uDQpmdW5jdGlvbiByZXN0b3JlQ3Vyc29yUG9zaXRpb24oKSB7DQogICAgaWYgKHRleHRFZGl0b3IuY3Vyc29yUG9zaXRpb24gPD0gMCkgew0KICAgICAgICAvLyBGYWxsYmFjayB0byB0ZXh0YXJlYSBjdXJzb3IgcG9zaXRpb24NCiAgICAgICAgc3luY0N1cnNvckZyb21UZXh0YXJlYSgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsNCiAgICBjb25zdCB0ZXh0Tm9kZSA9IGZpbmRUZXh0Tm9kZUF0T2Zmc2V0KHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IsIHRleHRFZGl0b3IuY3Vyc29yUG9zaXRpb24pOw0KICAgIA0KICAgIGlmICh0ZXh0Tm9kZSkgew0KICAgICAgICBjb25zdCBub2RlT2Zmc2V0ID0gTWF0aC5taW4odGV4dE5vZGUuX25vZGVPZmZzZXQgfHwgMCwgdGV4dE5vZGUudGV4dENvbnRlbnQubGVuZ3RoKTsNCiAgICAgICAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOw0KICAgICAgICByYW5nZS5zZXRTdGFydCh0ZXh0Tm9kZSwgbm9kZU9mZnNldCk7DQogICAgICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gSWYgd2UgY2FuJ3QgZmluZCB0aGUgdGV4dCBub2RlLCBmYWxsYmFjayB0byB0ZXh0YXJlYSBwb3NpdGlvbg0KICAgICAgICBzeW5jQ3Vyc29yRnJvbVRleHRhcmVhKCk7DQogICAgfQ0KfQ0KDQovLyBHZXQgdGV4dCBvZmZzZXQgZm9yIGN1cnNvciBwcmVzZXJ2YXRpb24gLSBpbXByb3ZlZCB2ZXJzaW9uDQpmdW5jdGlvbiBnZXRUZXh0T2Zmc2V0KG5vZGUsIG9mZnNldCkgew0KICAgIGxldCB0b3RhbE9mZnNldCA9IDA7DQogICAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcigNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciwNCiAgICAgICAgTm9kZUZpbHRlci5TSE9XX1RFWFQsDQogICAgICAgIG51bGwsDQogICAgICAgIGZhbHNlDQogICAgKTsNCiAgICANCiAgICBsZXQgY3VycmVudE5vZGU7DQogICAgd2hpbGUgKGN1cnJlbnROb2RlID0gd2Fsa2VyLm5leHROb2RlKCkpIHsNCiAgICAgICAgaWYgKGN1cnJlbnROb2RlID09PSBub2RlKSB7DQogICAgICAgICAgICByZXR1cm4gdG90YWxPZmZzZXQgKyBvZmZzZXQ7DQogICAgICAgIH0NCiAgICAgICAgdG90YWxPZmZzZXQgKz0gY3VycmVudE5vZGUudGV4dENvbnRlbnQubGVuZ3RoOw0KICAgIH0NCiAgICByZXR1cm4gdG90YWxPZmZzZXQ7DQp9DQoNCi8vIEZpbmQgdGV4dCBub2RlIGF0IG9mZnNldCBmb3IgY3Vyc29yIHJlc3RvcmF0aW9uIC0gaW1wcm92ZWQgdmVyc2lvbg0KZnVuY3Rpb24gZmluZFRleHROb2RlQXRPZmZzZXQoZWxlbWVudCwgb2Zmc2V0KSB7DQogICAgbGV0IGN1cnJlbnRPZmZzZXQgPSAwOw0KICAgIGNvbnN0IHdhbGtlciA9IGRvY3VtZW50LmNyZWF0ZVRyZWVXYWxrZXIoDQogICAgICAgIGVsZW1lbnQsDQogICAgICAgIE5vZGVGaWx0ZXIuU0hPV19URVhULA0KICAgICAgICBudWxsLA0KICAgICAgICBmYWxzZQ0KICAgICk7DQogICAgDQogICAgbGV0IG5vZGU7DQogICAgd2hpbGUgKG5vZGUgPSB3YWxrZXIubmV4dE5vZGUoKSkgew0KICAgICAgICBjb25zdCBub2RlTGVuZ3RoID0gbm9kZS50ZXh0Q29udGVudC5sZW5ndGg7DQogICAgICAgIGlmIChjdXJyZW50T2Zmc2V0ICsgbm9kZUxlbmd0aCA+PSBvZmZzZXQpIHsNCiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBvZmZzZXQgd2l0aGluIHRoaXMgbm9kZSBmb3IgbGF0ZXIgdXNlDQogICAgICAgICAgICBub2RlLl9ub2RlT2Zmc2V0ID0gb2Zmc2V0IC0gY3VycmVudE9mZnNldDsNCiAgICAgICAgICAgIHJldHVybiBub2RlOw0KICAgICAgICB9DQogICAgICAgIGN1cnJlbnRPZmZzZXQgKz0gbm9kZUxlbmd0aDsNCiAgICB9DQogICAgDQogICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYSBub2RlLCByZXR1cm4gdGhlIGxhc3QgdGV4dCBub2RlDQogICAgY29uc3QgYWxsVGV4dE5vZGVzID0gW107DQogICAgY29uc3Qgd2Fsa2VyMiA9IGRvY3VtZW50LmNyZWF0ZVRyZWVXYWxrZXIoDQogICAgICAgIGVsZW1lbnQsDQogICAgICAgIE5vZGVGaWx0ZXIuU0hPV19URVhULA0KICAgICAgICBudWxsLA0KICAgICAgICBmYWxzZQ0KICAgICk7DQogICAgd2hpbGUgKG5vZGUgPSB3YWxrZXIyLm5leHROb2RlKCkpIHsNCiAgICAgICAgYWxsVGV4dE5vZGVzLnB1c2gobm9kZSk7DQogICAgfQ0KICAgIGNvbnN0IGxhc3ROb2RlID0gYWxsVGV4dE5vZGVzW2FsbFRleHROb2Rlcy5sZW5ndGggLSAxXTsNCiAgICBpZiAobGFzdE5vZGUpIHsNCiAgICAgICAgbGFzdE5vZGUuX25vZGVPZmZzZXQgPSBsYXN0Tm9kZS50ZXh0Q29udGVudC5sZW5ndGg7DQogICAgfQ0KICAgIHJldHVybiBsYXN0Tm9kZSB8fCBudWxsOw0KfQ0KDQovLyBIYW5kbGUgaW5wdXQgaW4gaGlnaGxpZ2h0ZWQgZWRpdG9yDQpmdW5jdGlvbiBoYW5kbGVIaWdobGlnaHRlZElucHV0KCkgew0KICAgIC8vIFVwZGF0ZSB0ZXh0YXJlYSB2YWx1ZQ0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yLnRleHRDb250ZW50Ow0KICAgIA0KICAgIC8vIFVwZGF0ZSBjdXJzb3IgcG9zaXRpb24gaW1tZWRpYXRlbHkNCiAgICB1cGRhdGVDdXJzb3JQb3NpdGlvbigpOw0KICAgIA0KICAgIC8vIERlYm91bmNlZCBoaWdobGlnaHRpbmcgd2l0aCBzaG9ydGVyIGRlbGF5IGZvciBiZXR0ZXIgcmVzcG9uc2l2ZW5lc3MNCiAgICBpZiAodGV4dEVkaXRvci5kZWJvdW5jZVRpbWVyKSB7DQogICAgICAgIGNsZWFyVGltZW91dCh0ZXh0RWRpdG9yLmRlYm91bmNlVGltZXIpOw0KICAgIH0NCiAgICANCiAgICB0ZXh0RWRpdG9yLmRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgfSwgNTApOyAvLyBSZWR1Y2VkIGZyb20gMTAwbXMgdG8gNTBtcw0KICAgIA0KICAgIC8vIFVwZGF0ZSBsaW5lIG51bWJlcnMgYW5kIHN0YXR1cw0KICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgbWFya0FzTW9kaWZpZWQoKTsNCn0NCg0KLy8gSGFuZGxlIGtleWRvd24gaW4gaGlnaGxpZ2h0ZWQgZWRpdG9yDQpmdW5jdGlvbiBoYW5kbGVIaWdobGlnaHRlZEtleURvd24oZSkgew0KICAgIC8vIFRhYiBoYW5kbGluZw0KICAgIGlmIChlLmtleSA9PT0gJ1RhYicpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7DQogICAgICAgIGNvbnN0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7DQogICAgICAgIGNvbnN0IHNwYWNlcyA9ICcgJy5yZXBlYXQodGV4dEVkaXRvci5zZXR0aW5ncy50YWJTaXplKTsNCiAgICAgICAgDQogICAgICAgIC8vIEluc2VydCBzcGFjZXMgYXQgY3Vyc29yIHBvc2l0aW9uDQogICAgICAgIGNvbnN0IHRleHROb2RlID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgIGNvbnN0IG9mZnNldCA9IHJhbmdlLnN0YXJ0T2Zmc2V0Ow0KICAgICAgICB0ZXh0Tm9kZS50ZXh0Q29udGVudCA9IHRleHROb2RlLnRleHRDb250ZW50LnN1YnN0cmluZygwLCBvZmZzZXQpICsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFjZXMgKyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHROb2RlLnRleHRDb250ZW50LnN1YnN0cmluZyhvZmZzZXQpOw0KICAgICAgICANCiAgICAgICAgLy8gTW92ZSBjdXJzb3IgYWZ0ZXIgaW5zZXJ0ZWQgc3BhY2VzDQogICAgICAgIHJhbmdlLnNldFN0YXJ0KHRleHROb2RlLCBvZmZzZXQgKyBzcGFjZXMubGVuZ3RoKTsNCiAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgc2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTsNCiAgICAgICAgDQogICAgICAgIC8vIFRyaWdnZXIgaW5wdXQgZXZlbnQNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnKSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gRW50ZXIga2V5IGhhbmRsaW5nDQogICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOw0KICAgICAgICBjb25zdCByYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KDApOw0KICAgICAgICANCiAgICAgICAgLy8gSW5zZXJ0IG5ld2xpbmUgYXQgY3Vyc29yIHBvc2l0aW9uDQogICAgICAgIGNvbnN0IHRleHROb2RlID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgIGNvbnN0IG9mZnNldCA9IHJhbmdlLnN0YXJ0T2Zmc2V0Ow0KICAgICAgICANCiAgICAgICAgLy8gSGFuZGxlIGNhc2Ugd2hlcmUgY3Vyc29yIGlzIGF0IHRoZSBlbmQgb2YgYSB0ZXh0IG5vZGUNCiAgICAgICAgaWYgKG9mZnNldCA9PT0gdGV4dE5vZGUudGV4dENvbnRlbnQubGVuZ3RoKSB7DQogICAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgdGV4dCBub2RlIGFmdGVyIHRoZSBjdXJyZW50IG9uZQ0KICAgICAgICAgICAgY29uc3QgbmV3VGV4dE5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnXG4nKTsNCiAgICAgICAgICAgIHRleHROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld1RleHROb2RlLCB0ZXh0Tm9kZS5uZXh0U2libGluZyk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE1vdmUgY3Vyc29yIHRvIHRoZSBuZXcgdGV4dCBub2RlDQogICAgICAgICAgICByYW5nZS5zZXRTdGFydChuZXdUZXh0Tm9kZSwgMSk7DQogICAgICAgICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEluc2VydCBuZXdsaW5lIGluIHRoZSBtaWRkbGUgb2YgdGV4dA0KICAgICAgICAgICAgdGV4dE5vZGUudGV4dENvbnRlbnQgPSB0ZXh0Tm9kZS50ZXh0Q29udGVudC5zdWJzdHJpbmcoMCwgb2Zmc2V0KSArIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcbicgKyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZS50ZXh0Q29udGVudC5zdWJzdHJpbmcob2Zmc2V0KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTW92ZSBjdXJzb3IgYWZ0ZXIgbmV3bGluZQ0KICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQodGV4dE5vZGUsIG9mZnNldCArIDEpOw0KICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgc2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTsNCiAgICAgICAgDQogICAgICAgIC8vIFRyaWdnZXIgaW5wdXQgZXZlbnQNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnKSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gSGFuZGxlIG90aGVyIGtleWJvYXJkIHNob3J0Y3V0cw0KICAgIGhhbmRsZUtleURvd24oZSk7DQp9DQoNCi8vIEhhbmRsZSBwYXN0ZSBpbiBoaWdobGlnaHRlZCBlZGl0b3INCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodGVkUGFzdGUoZSkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICANCiAgICBjb25zdCB0ZXh0ID0gZS5jbGlwYm9hcmREYXRhLmdldERhdGEoJ3RleHQvcGxhaW4nKTsNCiAgICBjb25zdCBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7DQogICAgY29uc3QgcmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTsNCiAgICANCiAgICAvLyBJbnNlcnQgdGV4dCBhdCBjdXJzb3IgcG9zaXRpb24NCiAgICBjb25zdCB0ZXh0Tm9kZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyOw0KICAgIGNvbnN0IG9mZnNldCA9IHJhbmdlLnN0YXJ0T2Zmc2V0Ow0KICAgIHRleHROb2RlLnRleHRDb250ZW50ID0gdGV4dE5vZGUudGV4dENvbnRlbnQuc3Vic3RyaW5nKDAsIG9mZnNldCkgKyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCArIA0KICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZS50ZXh0Q29udGVudC5zdWJzdHJpbmcob2Zmc2V0KTsNCiAgICANCiAgICAvLyBNb3ZlIGN1cnNvciBhZnRlciBpbnNlcnRlZCB0ZXh0DQogICAgcmFuZ2Uuc2V0U3RhcnQodGV4dE5vZGUsIG9mZnNldCArIHRleHQubGVuZ3RoKTsNCiAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTsNCiAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgc2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTsNCiAgICANCiAgICAvLyBUcmlnZ2VyIGlucHV0IGV2ZW50DQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnKSk7DQp9DQoNCi8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBzdXBwb3J0ZWQgZmlsZXMNCmFzeW5jIGZ1bmN0aW9uIGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpIHsNCiAgICBpZiAoIXRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKSByZXR1cm47DQogICAgDQogICAgY29uc3QgbGFuZ3VhZ2UgPSBnZXRGaWxlTGFuZ3VhZ2UodGV4dEVkaXRvci5maWxlUGF0aCk7DQogICAgDQogICAgaWYgKGxhbmd1YWdlKSB7DQogICAgICAgIGlmICghdGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgew0KICAgICAgICAgICAgYXdhaXQgbG9hZFByaXNtSlMoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKCF0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICBjcmVhdGVIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSB0cnVlOw0KICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFN5bnRheCBoaWdobGlnaHRpbmcgZW5hYmxlZCBmb3IgJHtsYW5ndWFnZX0gZmlsZWApOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIERpc2FibGUgaGlnaGxpZ2h0aW5nIGZvciB1bnN1cHBvcnRlZCBmaWxlcw0KICAgICAgICBpZiAodGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5yZW1vdmUoKTsNCiAgICAgICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IgPSBudWxsOw0KICAgICAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgIH0NCiAgICAgICAgdGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkID0gZmFsc2U7DQogICAgfQ0KfQ0KDQovLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCmZ1bmN0aW9uIHNldHVwRXZlbnRIYW5kbGVycygpIHsNCiAgICAvLyBCdXR0b24gZXZlbnRzDQogICAgbmV3RmlsZUJ0bj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjcmVhdGVOZXdGaWxlKTsNCiAgICBsb2FkRmlsZUJ0bj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsb2FkRmlsZSk7DQogICAgc2F2ZUZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUZpbGUpOw0KICAgIHNhdmVBc0ZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUFzRmlsZSk7DQogICAgd29yZFdyYXBUb2dnbGU/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlV29yZFdyYXApOw0KICAgIGxpbmVOdW1iZXJzVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUxpbmVOdW1iZXJzKTsNCiAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGU/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlU3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICANCiAgICAvLyBUZXh0YXJlYSBldmVudHMNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaGFuZGxlVGV4dENoYW5nZSk7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzeW5jU2Nyb2xsKTsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVLZXlEb3duKTsNCiAgICANCg0KICAgIA0KICAgIC8vIFdpbmRvdyBldmVudHMNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgaGFuZGxlQmVmb3JlVW5sb2FkKTsNCn0NCg0KLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpIHsNCiAgICBpZiAoY3VycmVudEZpbGVuYW1lRWwpIHsNCiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSB0ZXh0RWRpdG9yLmZpbGVQYXRoID8gdGV4dEVkaXRvci5maWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpIDogJ3VudGl0bGVkLnR4dCc7DQogICAgICAgIGN1cnJlbnRGaWxlbmFtZUVsLnRleHRDb250ZW50ID0gZmlsZW5hbWU7DQogICAgfQ0KfQ0KDQovLyBJbml0aWFsaXplIGVkaXRvciBzdGF0ZQ0KZnVuY3Rpb24gaW5pdGlhbGl6ZUVkaXRvcigpIHsNCiAgICAvLyBTZXQgaW5pdGlhbCBmaWxlIHBhdGgNCiAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gJy91bnRpdGxlZC50eHQnOw0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBsaW5lIG51bWJlcnMNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBzdGF0dXMNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICANCiAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBpZiBuZWVkZWQNCiAgICBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICANCiAgICAvLyBTdGFydCBhdXRvLXNhdmUgaWYgZW5hYmxlZA0KICAgIGlmICh0ZXh0RWRpdG9yLnNldHRpbmdzLmF1dG9TYXZlSW50ZXJ2YWwgPiAwKSB7DQogICAgICAgIHN0YXJ0QXV0b1NhdmUoKTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSB0ZXh0IGNoYW5nZXMNCmZ1bmN0aW9uIGhhbmRsZVRleHRDaGFuZ2UoKSB7DQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICBtYXJrQXNNb2RpZmllZCgpOw0KfQ0KDQovLyBVcGRhdGUgbGluZSBudW1iZXJzDQpmdW5jdGlvbiB1cGRhdGVMaW5lTnVtYmVycygpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IubGluZU51bWJlcnMgfHwgIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKSByZXR1cm47DQogICAgDQogICAgY29uc3QgbGluZXMgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnNwbGl0KCdcbicpOw0KICAgIGNvbnN0IGxpbmVDb3VudCA9IGxpbmVzLmxlbmd0aDsNCiAgICANCiAgICAvLyBHZW5lcmF0ZSBsaW5lIG51bWJlcnMgSFRNTA0KICAgIGxldCBsaW5lTnVtYmVyc0hUTUwgPSAnJzsNCiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBsaW5lQ291bnQ7IGkrKykgew0KICAgICAgICBsaW5lTnVtYmVyc0hUTUwgKz0gYDxzcGFuIGNsYXNzPSJsaW5lLW51bWJlciI+JHtpfTwvc3Bhbj5cbmA7DQogICAgfQ0KICAgIA0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuaW5uZXJIVE1MID0gbGluZU51bWJlcnNIVE1MOw0KfQ0KDQovLyBTeW5jIHNjcm9sbCBiZXR3ZWVuIHRleHRhcmVhIGFuZCBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHN5bmNTY3JvbGwoKSB7DQogICAgaWYgKHRleHRFZGl0b3IubGluZU51bWJlcnMgJiYgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHsNCiAgICAgICAgdGV4dEVkaXRvci5saW5lTnVtYmVycy5zY3JvbGxUb3AgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNjcm9sbFRvcDsNCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBzdGF0dXMgYmFyDQpmdW5jdGlvbiB1cGRhdGVTdGF0dXMoKSB7DQogICAgLy8gU3RhdHVzIGJhciBub3cgb25seSBzaG93cyBtb2RpZmllZCBzdGF0dXMsIHdoaWNoIGlzIGhhbmRsZWQgYnkgbWFya0FzTW9kaWZpZWQvbWFya0FzU2F2ZWQNCiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGtlcHQgZm9yIHBvdGVudGlhbCBmdXR1cmUgdXNlDQp9DQoNCi8vIE1hcmsgZmlsZSBhcyBtb2RpZmllZA0KZnVuY3Rpb24gbWFya0FzTW9kaWZpZWQoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmlzTW9kaWZpZWQpIHsNCiAgICAgICAgdGV4dEVkaXRvci5pc01vZGlmaWVkID0gdHJ1ZTsNCiAgICAgICAgaWYgKG1vZGlmaWVkU3RhdHVzRWwpIHsNCiAgICAgICAgICAgIG1vZGlmaWVkU3RhdHVzRWwudGV4dENvbnRlbnQgPSAnWWVzJzsNCiAgICAgICAgICAgIG1vZGlmaWVkU3RhdHVzRWwuY2xhc3NMaXN0LmFkZCgnbW9kaWZpZWQnKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gTWFyayBmaWxlIGFzIHNhdmVkDQpmdW5jdGlvbiBtYXJrQXNTYXZlZCgpIHsNCiAgICB0ZXh0RWRpdG9yLmlzTW9kaWZpZWQgPSBmYWxzZTsNCiAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgaWYgKG1vZGlmaWVkU3RhdHVzRWwpIHsNCiAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC50ZXh0Q29udGVudCA9ICdObyc7DQogICAgICAgIG1vZGlmaWVkU3RhdHVzRWwuY2xhc3NMaXN0LnJlbW92ZSgnbW9kaWZpZWQnKTsNCiAgICB9DQp9DQoNCi8vIENyZWF0ZSBuZXcgZmlsZQ0KZnVuY3Rpb24gY3JlYXRlTmV3RmlsZSgpIHsNCiAgICBpZiAodGV4dEVkaXRvci5pc01vZGlmaWVkKSB7DQogICAgICAgIGlmIChjb25maXJtKCdZb3UgaGF2ZSB1bnNhdmVkIGNoYW5nZXMuIENyZWF0ZSBuZXcgZmlsZSBhbnl3YXk/JykpIHsNCiAgICAgICAgICAgIGNsZWFyRWRpdG9yKCk7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBjbGVhckVkaXRvcigpOw0KICAgIH0NCn0NCg0KLy8gQ2xlYXIgZWRpdG9yDQpmdW5jdGlvbiBjbGVhckVkaXRvcigpIHsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlID0gJyc7DQogICAgdGV4dEVkaXRvci5maWxlUGF0aCA9ICcvdW50aXRsZWQudHh0JzsNCiAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9ICcnOw0KICAgIG1hcmtBc1NhdmVkKCk7DQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICANCiAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3IgbmV3IGZpbGUNCiAgICBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICANCiAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICB9DQogICAgDQogICAgLy8gRm9jdXMgYXBwcm9wcmlhdGUgZWRpdG9yDQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5mb2N1cygpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuZm9jdXMoKTsNCiAgICB9DQp9DQoNCi8vIExvYWQgZmlsZSBmcm9tIFZGUw0KYXN5bmMgZnVuY3Rpb24gbG9hZEZpbGUoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnb3BlbicsDQogICAgICAgICAgICB0aXRsZTogJ09wZW4gVGV4dCBGaWxlJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGaWxlIHNlbGVjdGVkIGZvciBsb2FkaW5nOicsIHNlbGVjdGVkUGF0aCk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSBzZWxlY3Rpb24gY2FuY2VsbGVkJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBpZiBmaWxlIGV4aXN0cyBhbmQgbG9hZCBpdA0KICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBjb250ZW50IGludG8gZWRpdG9yDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSBjb250ZW50Ow0KICAgICAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgDQogICAgICAgIC8vIFVwZGF0ZSBVSQ0KICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICAgICAgdXBkYXRlU3RhdHVzKCk7DQogICAgICAgIG1hcmtBc1NhdmVkKCk7DQogICAgICAgIA0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3IgbG9hZGVkIGZpbGUNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQogICAgICAgIA0KICAgICAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkICYmIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmlsZSBsb2FkZWQ6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgZmlsZTonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gbG9hZCBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBTYXZlIGZpbGUgdG8gVkZTDQphc3luYyBmdW5jdGlvbiBzYXZlRmlsZSgpIHsNCiAgICBjb25zdCBjb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCiAgICANCiAgICB0cnkgew0KICAgICAgICBsZXQgZmlsZVBhdGggPSB0ZXh0RWRpdG9yLmZpbGVQYXRoOw0KICAgICAgICANCiAgICAgICAgLy8gSWYgaXQncyBhIG5ldyBmaWxlICh1bnRpdGxlZCkgb3Igd2Ugd2FudCB0byBzYXZlIGFzLCBzaG93IGZpbGUgZXhwbG9yZXINCiAgICAgICAgaWYgKHRleHRFZGl0b3IuZmlsZVBhdGggPT09ICcvdW50aXRsZWQudHh0Jykgew0KICAgICAgICAgICAgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBUZXh0IEZpbGUnLA0KICAgICAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICAgICAgZmlsZU5hbWU6ICd1bnRpdGxlZC50eHQnLA0KICAgICAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGaWxlIHNlbGVjdGVkIGZvciBzYXZpbmc6Jywgc2VsZWN0ZWRQYXRoKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGaWxlIHNlbGVjdGlvbiBjYW5jZWxsZWQnKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGUoZmlsZVBhdGgsIGNvbnRlbnQpOw0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci5maWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgbWFya0FzU2F2ZWQoKTsNCiAgICAgICAgDQogICAgICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBzYXZlZCBmaWxlDQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgICAgICANCiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIGhpZ2hsaWdodGVkIGNvbnRlbnQgaWYgaGlnaGxpZ2h0aW5nIGlzIGVuYWJsZWQNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZpbGUgc2F2ZWQ6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgZmlsZTonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gc2F2ZSBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBTYXZlIGZpbGUgYXMgKGFsd2F5cyBzaG93IGZpbGUgZXhwbG9yZXIpDQphc3luYyBmdW5jdGlvbiBzYXZlQXNGaWxlKCkgew0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgdGl0bGU6ICdTYXZlIFRleHQgRmlsZSBBcycsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgZmlsZU5hbWU6IHRleHRFZGl0b3IuZmlsZVBhdGggPT09ICcvdW50aXRsZWQudHh0JyA/ICd1bnRpdGxlZC50eHQnIDogdGV4dEVkaXRvci5maWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSBzZWxlY3RlZCBmb3Igc2F2aW5nIGFzOicsIHNlbGVjdGVkUGF0aCk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSBzZWxlY3Rpb24gY2FuY2VsbGVkJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgY29udGVudCk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICBtYXJrQXNTYXZlZCgpOw0KICAgICAgICANCiAgICAgICAgLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgZm9yIHNhdmVkIGZpbGUNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQogICAgICAgIA0KICAgICAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkICYmIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmlsZSBzYXZlZCBhczogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmaWxlIGFzOicsIGVycm9yKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZhaWxlZCB0byBzYXZlIGZpbGUgYXM6ICR7ZXJyb3IubWVzc2FnZX1gLCAnZXJyb3InKTsNCiAgICB9DQp9DQoNCi8vIFRvZ2dsZSB3b3JkIHdyYXANCmZ1bmN0aW9uIHRvZ2dsZVdvcmRXcmFwKCkgew0KICAgIHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkID0gIXRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkOw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuY2xhc3NMaXN0LnRvZ2dsZSgnd29yZC13cmFwJywgdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBoaWdobGlnaHRlZCBlZGl0b3IgaWYgaXQgZXhpc3RzDQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zdHlsZS53b3JkV3JhcCA9IHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkID8gJ2JyZWFrLXdvcmQnIDogJ25vcm1hbCc7DQogICAgfQ0KICAgIA0KICAgIGlmICh3b3JkV3JhcFRvZ2dsZSkgew0KICAgICAgICB3b3JkV3JhcFRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCk7DQogICAgfQ0KICAgIA0KICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKA0KICAgICAgICBgV29yZCB3cmFwICR7dGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCi8vIFRvZ2dsZSBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHRvZ2dsZUxpbmVOdW1iZXJzKCkgew0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkID0gIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkOw0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKTsNCiAgICANCiAgICBpZiAobGluZU51bWJlcnNUb2dnbGUpIHsNCiAgICAgICAgbGluZU51bWJlcnNUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpOw0KICAgIH0NCiAgICANCiAgICBpZiAodGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHsNCiAgICAgICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBMaW5lIG51bWJlcnMgJHt0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCwNCiAgICAgICAgJ2luZm8nDQogICAgKTsNCn0NCg0KLy8gVG9nZ2xlIHN5bnRheCBoaWdobGlnaHRpbmcNCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVN5bnRheEhpZ2hsaWdodGluZygpIHsNCiAgICB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyA9ICF0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZzsNCiAgICANCiAgICAvLyBTYXZlIHNldHRpbmcNCiAgICB0cnkgew0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZygnU1lOVEFYX0hJR0hMSUdIVElORycsIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBzeW50YXggaGlnaGxpZ2h0aW5nIHNldHRpbmc6JywgZXJyb3IpOw0KICAgIH0NCiAgICANCiAgICAvLyBVcGRhdGUgVUkNCiAgICBpZiAoc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlKSB7DQogICAgICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgfQ0KICAgIA0KICAgIC8vIEFwcGx5IGhpZ2hsaWdodGluZyBpZiBlbmFibGVkDQogICAgaWYgKHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKSB7DQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIERpc2FibGUgaGlnaGxpZ2h0aW5nDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yLnJlbW92ZSgpOw0KICAgICAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciA9IG51bGw7DQogICAgICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgfQ0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBTeW50YXggaGlnaGxpZ2h0aW5nICR7dGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCg0KDQovLyBIYW5kbGUga2V5Ym9hcmQgc2hvcnRjdXRzDQpmdW5jdGlvbiBoYW5kbGVLZXlEb3duKGUpIHsNCiAgICAvLyBDdHJsL0NtZCArIFM6IFNhdmUNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAncycgJiYgIWUuc2hpZnRLZXkpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBzYXZlRmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgUzogU2F2ZSBBcw0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmtleSA9PT0gJ1MnKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgc2F2ZUFzRmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIE46IE5ldyBmaWxlDQogICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ24nKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgY3JlYXRlTmV3RmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIE86IExvYWQgZmlsZQ0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICdvJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGxvYWRGaWxlKCk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRhYiBoYW5kbGluZw0KICAgIGlmIChlLmtleSA9PT0gJ1RhYicpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBjb25zdCBzdGFydCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7DQogICAgICAgIGNvbnN0IGVuZCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uRW5kOw0KICAgICAgICBjb25zdCBzcGFjZXMgPSAnICcucmVwZWF0KHRleHRFZGl0b3Iuc2V0dGluZ3MudGFiU2l6ZSk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlID0gDQogICAgICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnN1YnN0cmluZygwLCBzdGFydCkgKyANCiAgICAgICAgICAgIHNwYWNlcyArIA0KICAgICAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZS5zdWJzdHJpbmcoZW5kKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvbkVuZCA9IHN0YXJ0ICsgc3BhY2VzLmxlbmd0aDsNCiAgICB9DQp9DQoNCi8vIFN0YXJ0IGF1dG8tc2F2ZQ0KZnVuY3Rpb24gc3RhcnRBdXRvU2F2ZSgpIHsNCiAgICBpZiAodGV4dEVkaXRvci5hdXRvU2F2ZUludGVydmFsKSB7DQogICAgICAgIGNsZWFySW50ZXJ2YWwodGV4dEVkaXRvci5hdXRvU2F2ZUludGVydmFsKTsNCiAgICB9DQogICAgDQogICAgdGV4dEVkaXRvci5hdXRvU2F2ZUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICBpZiAodGV4dEVkaXRvci5pc01vZGlmaWVkICYmIHRleHRFZGl0b3IuZmlsZVBhdGggJiYgdGV4dEVkaXRvci5maWxlUGF0aCAhPT0gJy91bnRpdGxlZC50eHQnKSB7DQogICAgICAgICAgICBzYXZlRmlsZSgpOw0KICAgICAgICB9DQogICAgfSwgdGV4dEVkaXRvci5zZXR0aW5ncy5hdXRvU2F2ZUludGVydmFsICogMTAwMCk7DQogICAgDQogICAgY29uc29sZS5sb2coYEF1dG8tc2F2ZSBlbmFibGVkIGV2ZXJ5ICR7dGV4dEVkaXRvci5zZXR0aW5ncy5hdXRvU2F2ZUludGVydmFsfSBzZWNvbmRzYCk7DQp9DQoNCi8vIFN0b3AgYXV0by1zYXZlDQpmdW5jdGlvbiBzdG9wQXV0b1NhdmUoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCkgew0KICAgICAgICBjbGVhckludGVydmFsKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCk7DQogICAgICAgIHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCA9IG51bGw7DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgYmVmb3JlIHVubG9hZA0KZnVuY3Rpb24gaGFuZGxlQmVmb3JlVW5sb2FkKGUpIHsNCiAgICBpZiAodGV4dEVkaXRvci5pc01vZGlmaWVkKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9ICdZb3UgaGF2ZSB1bnNhdmVkIGNoYW5nZXMuIEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBsZWF2ZT8nOw0KICAgICAgICByZXR1cm4gZS5yZXR1cm5WYWx1ZTsNCiAgICB9DQp9DQoNCi8vIEluaXRpYWxpemUgd2hlbiBET00gaXMgcmVhZHkNCmlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnbG9hZGluZycpIHsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdFRleHRFZGl0b3IpOw0KfSBlbHNlIHsNCiAgICAvLyBET00gaXMgYWxyZWFkeSBsb2FkZWQNCiAgICBpbml0VGV4dEVkaXRvcigpOw0KfQ0KDQpjb25zb2xlLmxvZygnVGV4dCBFZGl0b3Igc2NyaXB0IGxvYWRlZCcpOw0KY29uc29sZS5sb2coJz09PSBURVhUIEVESVRPUiBERUJVRyBJTkZPID09PScpOw0KY29uc29sZS5sb2coJ0RvY3VtZW50IHJlYWR5IHN0YXRlOicsIGRvY3VtZW50LnJlYWR5U3RhdGUpOw0KY29uc29sZS5sb2coJ0RvY3VtZW50IGJvZHkgZXhpc3RzOicsICEhZG9jdW1lbnQuYm9keSk7DQpjb25zb2xlLmxvZygnV2luZG93IHN5cG5leEFQSSB0eXBlOicsIHR5cGVvZiB3aW5kb3cuc3lwbmV4QVBJKTsNCmNvbnNvbGUubG9nKCdHbG9iYWwgc3lwbmV4QVBJIHR5cGU6JywgdHlwZW9mIHN5cG5leEFQSSk7DQpjb25zb2xlLmxvZygnQXBwIGNvbnRhaW5lciBleGlzdHM6JywgISFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwLWNvbnRhaW5lcicpKTsNCmNvbnNvbGUubG9nKCdUZXh0IGVkaXRvciB0ZXh0YXJlYSBleGlzdHM6JywgISFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGV4dC1lZGl0b3InKSk7DQpjb25zb2xlLmxvZygnTGluZSBudW1iZXJzIGV4aXN0czonLCAhIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLW51bWJlcnMnKSk7DQpjb25zb2xlLmxvZygnPT09IEVORCBERUJVRyBJTkZPID09PScpOw0KDQovLyA9PT09PSBJTlRFR1JBVEVEIFRFUk1JTkFMIEZVTkNUSU9OQUxJVFkgPT09PT0NCg0KLy8gVGVybWluYWwgdmFyaWFibGVzDQpsZXQgdGVybWluYWxUb2dnbGUsIGludGVncmF0ZWRUZXJtaW5hbCwgdGVybWluYWxPdXRwdXQsIHRlcm1pbmFsSW5wdXQsIHRlcm1pbmFsUmVzaXplOw0KbGV0IHRlcm1pbmFsSGlzdG9yeSA9IFtdOw0KbGV0IHRlcm1pbmFsSGlzdG9yeUluZGV4ID0gLTE7DQpsZXQgdGVybWluYWxTb2NrZXQgPSBudWxsOw0KDQovLyBJbml0aWFsaXplIHRlcm1pbmFsIGZ1bmN0aW9uYWxpdHkNCmZ1bmN0aW9uIGluaXRJbnRlZ3JhdGVkVGVybWluYWwoKSB7DQogICAgY29uc29sZS5sb2coJ0luaXRpYWxpemluZyBpbnRlZ3JhdGVkIHRlcm1pbmFsLi4uJyk7DQogICAgDQogICAgLy8gR2V0IHRlcm1pbmFsIERPTSBlbGVtZW50cw0KICAgIHRlcm1pbmFsVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlcm1pbmFsLXRvZ2dsZScpOw0KICAgIGludGVncmF0ZWRUZXJtaW5hbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRlZ3JhdGVkLXRlcm1pbmFsJyk7DQogICAgdGVybWluYWxPdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVybWluYWxPdXRwdXQnKTsNCiAgICB0ZXJtaW5hbElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlcm1pbmFsSW5wdXQnKTsNCiAgICB0ZXJtaW5hbFJlc2l6ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXJtaW5hbC1yZXNpemUnKTsNCiAgICANCiAgICBpZiAoIXRlcm1pbmFsVG9nZ2xlIHx8ICFpbnRlZ3JhdGVkVGVybWluYWwgfHwgIXRlcm1pbmFsT3V0cHV0IHx8ICF0ZXJtaW5hbElucHV0KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rlcm1pbmFsIGVsZW1lbnRzIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFNldCB1cCB0ZXJtaW5hbCBldmVudCBoYW5kbGVycw0KICAgIHNldHVwVGVybWluYWxFdmVudEhhbmRsZXJzKCk7DQogICAgDQogICAgLy8gQ29ubmVjdCB0byBXZWJTb2NrZXQgZm9yIHJlYWwtdGltZSBvdXRwdXQNCiAgICBjb25uZWN0VGVybWluYWxXZWJTb2NrZXQoKTsNCiAgICANCiAgICBjb25zb2xlLmxvZygnSW50ZWdyYXRlZCB0ZXJtaW5hbCBpbml0aWFsaXplZCcpOw0KfQ0KDQovLyBTZXQgdXAgdGVybWluYWwgZXZlbnQgaGFuZGxlcnMNCmZ1bmN0aW9uIHNldHVwVGVybWluYWxFdmVudEhhbmRsZXJzKCkgew0KICAgIC8vIFRlcm1pbmFsIHRvZ2dsZSBidXR0b24NCiAgICB0ZXJtaW5hbFRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVRlcm1pbmFsKTsNCiAgICANCiAgICAvLyBUZXJtaW5hbCBpbnB1dCBoYW5kbGluZw0KICAgIHRlcm1pbmFsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZVRlcm1pbmFsS2V5RG93bik7DQogICAgDQogICAgLy8gVGVybWluYWwgcmVzaXplIGZ1bmN0aW9uYWxpdHkNCiAgICBpZiAodGVybWluYWxSZXNpemUpIHsNCiAgICAgICAgdGVybWluYWxSZXNpemUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc3RhcnRUZXJtaW5hbFJlc2l6ZSk7DQogICAgfQ0KICAgIA0KICAgIC8vIE1ha2UgdGVybWluYWwgb3V0cHV0IGZvY3VzYWJsZSBmb3IgY29weS9wYXN0ZQ0KICAgIHRlcm1pbmFsT3V0cHV0LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpOw0KICAgIHRlcm1pbmFsT3V0cHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVUZXJtaW5hbE91dHB1dEtleURvd24pOw0KfQ0KDQovLyBUb2dnbGUgdGVybWluYWwgdmlzaWJpbGl0eQ0KYXN5bmMgZnVuY3Rpb24gdG9nZ2xlVGVybWluYWwoKSB7DQogICAgY29uc3QgaXNWaXNpYmxlID0gIWludGVncmF0ZWRUZXJtaW5hbC5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGRlbicpOw0KICAgIA0KICAgIGlmIChpc1Zpc2libGUpIHsNCiAgICAgICAgaW50ZWdyYXRlZFRlcm1pbmFsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOw0KICAgICAgICB0ZXJtaW5hbFRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLnNldFNldHRpbmcoJ1RFUk1JTkFMX0VOQUJMRUQnLCBmYWxzZSk7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdUZXJtaW5hbCBoaWRkZW4nLCAnaW5mbycpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGludGVncmF0ZWRUZXJtaW5hbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsNCiAgICAgICAgdGVybWluYWxUb2dnbGUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5zZXRTZXR0aW5nKCdURVJNSU5BTF9FTkFCTEVEJywgdHJ1ZSk7DQogICAgICAgIHRlcm1pbmFsSW5wdXQuZm9jdXMoKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ1Rlcm1pbmFsIHNob3duJywgJ2luZm8nKTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSB0ZXJtaW5hbCBpbnB1dCBrZXkgZXZlbnRzDQphc3luYyBmdW5jdGlvbiBoYW5kbGVUZXJtaW5hbEtleURvd24oZSkgew0KICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGF3YWl0IGV4ZWN1dGVUZXJtaW5hbENvbW1hbmQoKTsNCiAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnQXJyb3dVcCcpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBuYXZpZ2F0ZVRlcm1pbmFsSGlzdG9yeSgtMSk7DQogICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBuYXZpZ2F0ZVRlcm1pbmFsSGlzdG9yeSgxKTsNCiAgICB9DQp9DQoNCi8vIEV4ZWN1dGUgdGVybWluYWwgY29tbWFuZA0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRlcm1pbmFsQ29tbWFuZCgpIHsNCiAgICBjb25zdCBjb21tYW5kID0gdGVybWluYWxJbnB1dC52YWx1ZS50cmltKCk7DQogICAgaWYgKCFjb21tYW5kKSByZXR1cm47DQogICAgDQogICAgLy8gQWRkIGNvbW1hbmQgdG8gb3V0cHV0DQogICAgYXBwZW5kVGVybWluYWxPdXRwdXQoYCQgJHtjb21tYW5kfWAsICd0ZXJtaW5hbC1zdWNjZXNzJyk7DQogICAgDQogICAgLy8gQWRkIHRvIGhpc3RvcnkNCiAgICBhZGRUb1Rlcm1pbmFsSGlzdG9yeShjb21tYW5kKTsNCiAgICANCiAgICAvLyBDbGVhciBpbnB1dA0KICAgIHRlcm1pbmFsSW5wdXQudmFsdWUgPSAnJzsNCiAgICANCiAgICB0cnkgew0KICAgICAgICAvLyBFeGVjdXRlIGNvbW1hbmQgdmlhIFN5cG5leEFQSQ0KICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzeXBuZXhBUEkuZXhlY3V0ZVRlcm1pbmFsQ29tbWFuZChjb21tYW5kKTsNCiAgICAgICAgDQogICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykgew0KICAgICAgICAgICAgaWYgKHJlc3VsdC5vdXRwdXQpIHsNCiAgICAgICAgICAgICAgICBhcHBlbmRUZXJtaW5hbE91dHB1dChyZXN1bHQub3V0cHV0KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgYXBwZW5kVGVybWluYWxPdXRwdXQoJ0NvbW1hbmQgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5IChubyBvdXRwdXQpJywgJ3Rlcm1pbmFsLWluZm8nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGFwcGVuZFRlcm1pbmFsT3V0cHV0KGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCwgJ3Rlcm1pbmFsLWVycm9yJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBhcHBlbmRUZXJtaW5hbE91dHB1dChgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gLCAndGVybWluYWwtZXJyb3InKTsNCiAgICB9DQogICAgDQogICAgLy8gQWRkIGVtcHR5IGxpbmUNCiAgICBhcHBlbmRUZXJtaW5hbE91dHB1dCgnJyk7DQogICAgDQogICAgLy8gRm9jdXMgaW5wdXQgZm9yIG5leHQgY29tbWFuZA0KICAgIHRlcm1pbmFsSW5wdXQuZm9jdXMoKTsNCn0NCg0KLy8gQXBwZW5kIG91dHB1dCB0byB0ZXJtaW5hbA0KZnVuY3Rpb24gYXBwZW5kVGVybWluYWxPdXRwdXQodGV4dCwgY2xhc3NOYW1lID0gJycpIHsNCiAgICBjb25zdCBsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgbGluZS5jbGFzc05hbWUgPSBgdGVybWluYWwtbGluZSAke2NsYXNzTmFtZX1gOw0KICAgIGxpbmUudGV4dENvbnRlbnQgPSB0ZXh0Ow0KICAgIHRlcm1pbmFsT3V0cHV0LmFwcGVuZENoaWxkKGxpbmUpOw0KICAgIA0KICAgIC8vIFNjcm9sbCB0byBib3R0b20NCiAgICB0ZXJtaW5hbE91dHB1dC5zY3JvbGxUb3AgPSB0ZXJtaW5hbE91dHB1dC5zY3JvbGxIZWlnaHQ7DQp9DQoNCi8vIEFkZCBjb21tYW5kIHRvIGhpc3RvcnkNCmZ1bmN0aW9uIGFkZFRvVGVybWluYWxIaXN0b3J5KGNvbW1hbmQpIHsNCiAgICAvLyBEb24ndCBhZGQgZW1wdHkgY29tbWFuZHMgb3IgZHVwbGljYXRlcw0KICAgIGlmICghY29tbWFuZC50cmltKCkgfHwgKHRlcm1pbmFsSGlzdG9yeS5sZW5ndGggPiAwICYmIHRlcm1pbmFsSGlzdG9yeVt0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoIC0gMV0gPT09IGNvbW1hbmQpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgdGVybWluYWxIaXN0b3J5LnB1c2goY29tbWFuZCk7DQogICAgdGVybWluYWxIaXN0b3J5SW5kZXggPSB0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoOw0KICAgIA0KICAgIC8vIEtlZXAgaGlzdG9yeSBzaXplIHJlYXNvbmFibGUNCiAgICBpZiAodGVybWluYWxIaXN0b3J5Lmxlbmd0aCA+IDUwKSB7DQogICAgICAgIHRlcm1pbmFsSGlzdG9yeS5zaGlmdCgpOw0KICAgICAgICB0ZXJtaW5hbEhpc3RvcnlJbmRleC0tOw0KICAgIH0NCn0NCg0KLy8gTmF2aWdhdGUgdGVybWluYWwgaGlzdG9yeQ0KZnVuY3Rpb24gbmF2aWdhdGVUZXJtaW5hbEhpc3RvcnkoZGlyZWN0aW9uKSB7DQogICAgaWYgKHRlcm1pbmFsSGlzdG9yeS5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICANCiAgICBpZiAoZGlyZWN0aW9uID09PSAtMSkgew0KICAgICAgICAvLyBHbyB1cCBpbiBoaXN0b3J5DQogICAgICAgIGlmICh0ZXJtaW5hbEhpc3RvcnlJbmRleCA+IDApIHsNCiAgICAgICAgICAgIHRlcm1pbmFsSGlzdG9yeUluZGV4LS07DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBHbyBkb3duIGluIGhpc3RvcnkNCiAgICAgICAgaWYgKHRlcm1pbmFsSGlzdG9yeUluZGV4IDwgdGVybWluYWxIaXN0b3J5Lmxlbmd0aCAtIDEpIHsNCiAgICAgICAgICAgIHRlcm1pbmFsSGlzdG9yeUluZGV4Kys7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0ZXJtaW5hbEhpc3RvcnlJbmRleCA9IHRlcm1pbmFsSGlzdG9yeS5sZW5ndGg7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgaWYgKHRlcm1pbmFsSGlzdG9yeUluZGV4ID49IDAgJiYgdGVybWluYWxIaXN0b3J5SW5kZXggPCB0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoKSB7DQogICAgICAgIHRlcm1pbmFsSW5wdXQudmFsdWUgPSB0ZXJtaW5hbEhpc3RvcnlbdGVybWluYWxIaXN0b3J5SW5kZXhdOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHRlcm1pbmFsSW5wdXQudmFsdWUgPSAnJzsNCiAgICB9DQogICAgDQogICAgLy8gTW92ZSBjdXJzb3IgdG8gZW5kDQogICAgdGVybWluYWxJbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSh0ZXJtaW5hbElucHV0LnZhbHVlLmxlbmd0aCwgdGVybWluYWxJbnB1dC52YWx1ZS5sZW5ndGgpOw0KfQ0KDQovLyBIYW5kbGUgdGVybWluYWwgb3V0cHV0IGtleWJvYXJkIHNob3J0Y3V0cw0KZnVuY3Rpb24gaGFuZGxlVGVybWluYWxPdXRwdXRLZXlEb3duKGUpIHsNCiAgICBpZiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgew0KICAgICAgICBpZiAoZS5rZXkgPT09ICdjJykgew0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOw0KICAgICAgICAgICAgaWYgKHNlbGVjdGlvbi50b1N0cmluZygpKSB7DQogICAgICAgICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoc2VsZWN0aW9uLnRvU3RyaW5nKCkpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBDb3B5IGFsbCB0ZXJtaW5hbCBvdXRwdXQgaWYgbm90aGluZyBpcyBzZWxlY3RlZA0KICAgICAgICAgICAgICAgIGNvbnN0IGFsbFRleHQgPSB0ZXJtaW5hbE91dHB1dC5pbm5lclRleHQgfHwgdGVybWluYWxPdXRwdXQudGV4dENvbnRlbnQ7DQogICAgICAgICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoYWxsVGV4dCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdhJykgew0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOw0KICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKHRlcm1pbmFsT3V0cHV0KTsNCiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsNCiAgICAgICAgICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIENvbm5lY3QgdG8gV2ViU29ja2V0IGZvciByZWFsLXRpbWUgdGVybWluYWwgb3V0cHV0DQphc3luYyBmdW5jdGlvbiBjb25uZWN0VGVybWluYWxXZWJTb2NrZXQoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgLy8gQ29ubmVjdCB0byBXZWJTb2NrZXQNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmNvbm5lY3RTb2NrZXQoKTsNCiAgICAgICAgDQogICAgICAgIC8vIEpvaW4gdGVybWluYWwgcm9vbQ0KICAgICAgICBzeXBuZXhBUEkuam9pblJvb20oJ3Rlcm1pbmFsJyk7DQogICAgICAgIA0KICAgICAgICAvLyBMaXN0ZW4gZm9yIHRlcm1pbmFsIG91dHB1dA0KICAgICAgICBzeXBuZXhBUEkub24oJ3Rlcm1pbmFsX291dHB1dCcsIChkYXRhKSA9PiB7DQogICAgICAgICAgICBoYW5kbGVUZXJtaW5hbFdlYlNvY2tldE91dHB1dChkYXRhKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICBjb25zb2xlLmxvZygnVGVybWluYWwgV2ViU29ja2V0IGNvbm5lY3RlZCcpOw0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjb25uZWN0IHRlcm1pbmFsIFdlYlNvY2tldDonLCBlcnJvcik7DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgV2ViU29ja2V0IHRlcm1pbmFsIG91dHB1dA0KZnVuY3Rpb24gaGFuZGxlVGVybWluYWxXZWJTb2NrZXRPdXRwdXQoZGF0YSkgew0KICAgIGNvbnN0IHsgb3V0cHV0LCB0eXBlIH0gPSBkYXRhOw0KICAgIA0KICAgIC8vIERldGVybWluZSBvdXRwdXQgY2xhc3MgYmFzZWQgb24gdHlwZQ0KICAgIGxldCBjbGFzc05hbWUgPSAnJzsNCiAgICBpZiAodHlwZSA9PT0gJ3N0ZGVycicpIHsNCiAgICAgICAgY2xhc3NOYW1lID0gJ3Rlcm1pbmFsLWVycm9yJzsNCiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdjb21wbGV0aW9uJykgew0KICAgICAgICBjbGFzc05hbWUgPSAndGVybWluYWwtaW5mbyc7DQogICAgfSBlbHNlIGlmICh0eXBlID09PSAnZXJyb3InKSB7DQogICAgICAgIGNsYXNzTmFtZSA9ICd0ZXJtaW5hbC1lcnJvcic7DQogICAgfQ0KICAgIA0KICAgIC8vIEFwcGVuZCB0aGUgb3V0cHV0DQogICAgYXBwZW5kVGVybWluYWxPdXRwdXQob3V0cHV0LCBjbGFzc05hbWUpOw0KfQ0KDQovLyBUZXJtaW5hbCByZXNpemUgZnVuY3Rpb25hbGl0eQ0KZnVuY3Rpb24gc3RhcnRUZXJtaW5hbFJlc2l6ZShlKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIA0KICAgIGNvbnN0IHN0YXJ0WSA9IGUuY2xpZW50WTsNCiAgICBjb25zdCBzdGFydEhlaWdodCA9IGludGVncmF0ZWRUZXJtaW5hbC5vZmZzZXRIZWlnaHQ7DQogICAgDQogICAgZnVuY3Rpb24gb25Nb3VzZU1vdmUoZSkgew0KICAgICAgICBjb25zdCBkZWx0YVkgPSBlLmNsaWVudFkgLSBzdGFydFk7DQogICAgICAgIGNvbnN0IG5ld0hlaWdodCA9IE1hdGgubWF4KDIwMCwgTWF0aC5taW4oNjAwLCBzdGFydEhlaWdodCArIGRlbHRhWSkpOw0KICAgICAgICBpbnRlZ3JhdGVkVGVybWluYWwuc3R5bGUuaGVpZ2h0ID0gbmV3SGVpZ2h0ICsgJ3B4JzsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gb25Nb3VzZVVwKCkgew0KICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSk7DQogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApOw0KICAgIH0NCiAgICANCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCk7DQp9DQoNCi8vIEluaXRpYWxpemUgdGVybWluYWwgd2hlbiB0ZXh0IGVkaXRvciBpcyByZWFkeQ0KZnVuY3Rpb24gaW5pdFRleHRFZGl0b3JXaXRoVGVybWluYWwoKSB7DQogICAgaW5pdFRleHRFZGl0b3IoKTsNCiAgICBpbml0SW50ZWdyYXRlZFRlcm1pbmFsKCk7DQp9DQoNCi8vIFJlcGxhY2UgdGhlIG9yaWdpbmFsIGluaXRUZXh0RWRpdG9yIGNhbGwNCmlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnbG9hZGluZycpIHsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdFRleHRFZGl0b3JXaXRoVGVybWluYWwpOw0KfSBlbHNlIHsNCiAgICAvLyBET00gaXMgYWxyZWFkeSBsb2FkZWQNCiAgICBpbml0VGV4dEVkaXRvcldpdGhUZXJtaW5hbCgpOw0KfSA8L3NjcmlwdD4="
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-07-19T20:52:12.972043",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": "user_apps_dev\\text_editor"
  }
}